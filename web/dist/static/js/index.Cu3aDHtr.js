import{r as c,D as ie,a0 as me,d as u,J as L,o as g,c as S,I as b,U as ce,h as a,e,f as t,k as fe,P as Q,a7 as H,l as w,p as h,$ as T,m as P,z as R,n as _e,C as ge,v as be,E as he}from"./index.CHnR_MAu.js";import{H as ve,l as K,g as Ve,u as ye,a as je,d as we}from"./project.BpVuymad.js";import{_ as Ne}from"./run_dialog.B-H1ReCy.js";import"./run_detail.CgntWMNI.js";import"./env.jLYomLFD.js";const Ue={class:"app-container"},ke={class:"dialog-footer"},xe=ge({name:"project"}),Re=Object.assign(xe,{setup(Ce){const{proxy:i}=be(),{sys_normal_disable:x}=i.useDict("sys_normal_disable"),$=c([]),f=c(!1),N=c(!0),U=c(!0),C=c(""),O=c(!0),z=c(!0),k=c(!1),y=c([]),J=ie({form:{},queryParams:{projectName:void 0,status:void 0},rules:{projectName:[{required:!0,message:"项目名称不能为空",trigger:"blur"}],orderNum:[{required:!0,message:"显示排序不能为空",trigger:"blur"}]}}),{queryParams:v,form:n,rules:M}=me(J);function V(){N.value=!0,K(v.value).then(r=>{$.value=r.data,N.value=!1})}function G(r){y.value=r.map(o=>o.projectId)}function W(){f.value=!1,D()}function D(){n.value={projectId:void 0,projectName:void 0,orderNum:0,simpleDesc:void 0,status:"0"},i.resetForm("projectRef")}function I(){V()}function X(){i.resetForm("queryRef"),I()}function Y(r){D(),K().then(o=>{projectOptions.value=i.handleTree(o.data,"projectId")}),f.value=!0,C.value="添加项目"}function Z(r){D(),Ve(r.projectId).then(o=>{n.value=o.data,f.value=!0,C.value="修改项目"})}function ee(){i.$refs.projectRef.validate(r=>{r&&(n.value.projectId!=null?ye(n.value).then(o=>{i.$modal.msgSuccess("修改成功"),f.value=!1,V()}):je(n.value).then(o=>{i.$modal.msgSuccess("新增成功"),f.value=!1,V()}))})}function le(r){i.$modal.confirm('是否确认删除名称为"'+r.projectName+'"的数据项?').then(function(){return we(r.projectId)}).then(()=>{V(),i.$modal.msgSuccess("删除成功")}).catch(()=>{})}function q(r){if(r&&"projectId"in r&&r.projectId&&(y.value=[r.projectId]),!y.value||y.value.length===0){he.alert("请选择要运行的项目","提示！",{type:"warning"});return}k.value=!0}return V(),(r,o)=>{const _=u("el-input"),s=u("el-form-item"),te=u("el-option"),ae=u("el-select"),m=u("el-button"),E=u("el-form"),d=u("el-col"),oe=u("right-toolbar"),A=u("el-row"),p=u("el-table-column"),ne=u("dict-tag"),re=u("el-table"),ue=u("el-input-number"),se=u("el-radio"),de=u("el-radio-group"),pe=u("el-dialog"),j=L("hasPermi"),B=L("loading");return g(),S("div",Ue,[b(e(E,{model:a(v),ref:"queryRef",inline:!0},{default:t(()=>[e(s,{label:"项目名称",prop:"projectName"},{default:t(()=>[e(_,{modelValue:a(v).projectName,"onUpdate:modelValue":o[0]||(o[0]=l=>a(v).projectName=l),placeholder:"请输入项目名称",clearable:"",style:{width:"200px"},onKeyup:fe(I,["enter"])},null,8,["modelValue"])]),_:1}),e(s,{label:"状态",prop:"status"},{default:t(()=>[e(ae,{modelValue:a(v).status,"onUpdate:modelValue":o[1]||(o[1]=l=>a(v).status=l),placeholder:"项目状态",clearable:"",style:{width:"200px"}},{default:t(()=>[(g(!0),S(Q,null,H(a(x),l=>(g(),w(te,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(s,null,{default:t(()=>[e(m,{type:"primary",icon:"Search",onClick:I},{default:t(()=>[h("搜索")]),_:1}),e(m,{icon:"Refresh",onClick:X},{default:t(()=>[h("重置")]),_:1})]),_:1})]),_:1},8,["model"]),[[ce,a(U)]]),e(A,{gutter:10,class:"mb8"},{default:t(()=>[e(d,{span:1.5},{default:t(()=>[b((g(),w(m,{type:"primary",plain:"",icon:"Plus",onClick:Y},{default:t(()=>[h("新增 ")]),_:1})),[[j,["hrm:project:add"]]])]),_:1}),e(d,{span:1.5},{default:t(()=>[b((g(),w(m,{type:"warning",icon:"CaretRight",onClick:q,title:"运行"},{default:t(()=>[h(" 执行 ")]),_:1})),[[j,["hrm:case:run"]]])]),_:1}),e(oe,{showSearch:a(U),"onUpdate:showSearch":o[2]||(o[2]=l=>T(U)?U.value=l:null),onQueryTable:V},null,8,["showSearch"])]),_:1}),a(z)?b((g(),w(re,{key:0,border:"",data:a($),"row-key":"projectId","default-expand-all":a(O),onSelectionChange:G},{default:t(()=>[e(p,{type:"selection",width:"55",align:"center"}),e(p,{prop:"projectId",label:"ID",width:"150"}),e(p,{prop:"projectName",align:"center",label:"项目名称",width:"200"}),e(p,{prop:"responsibleName",align:"center",label:"负责人",width:"120"}),e(p,{prop:"testUser",label:"测试负责人",align:"center",width:"120"}),e(p,{prop:"devUser",label:"开发负责人",align:"center",width:"120"}),e(p,{prop:"orderNum",label:"排序",align:"center",width:"100"}),e(p,{prop:"status",label:"状态",align:"center",width:"100"},{default:t(l=>[e(ne,{options:a(x),value:l.row.status},null,8,["options","value"])]),_:1}),e(p,{label:"创建时间",align:"center",prop:"createTime","class-name":"small-padding fixed-width"},{default:t(l=>[P("span",null,R(r.parseTime(l.row.createTime)),1)]),_:1}),e(p,{label:"更新时间",align:"center",prop:"updateTime","class-name":"small-padding fixed-width"},{default:t(l=>[P("span",null,R(r.parseTime(l.row.updateTime)),1)]),_:1}),e(p,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:t(l=>[b(e(m,{link:"",type:"primary",icon:"Edit",onClick:F=>Z(l.row),title:"修改"},null,8,["onClick"]),[[j,["hrm:project:edit"]]]),b(e(m,{link:"",type:"warning",icon:"CaretRight",onClick:F=>q(l.row),title:"运行"},null,8,["onClick"]),[[B,a(N)],[j,["hrm:case:run"]]]),b(e(m,{link:"",type:"primary",icon:"Delete",onClick:F=>le(l.row),title:"修改"},null,8,["onClick"]),[[j,["hrm:project:remove"]]])]),_:1})]),_:1},8,["data","default-expand-all"])),[[B,a(N)]]):_e("",!0),e(pe,{title:a(C),modelValue:a(f),"onUpdate:modelValue":o[12]||(o[12]=l=>T(f)?f.value=l:null),width:"800px","append-to-body":""},{footer:t(()=>[P("div",ke,[e(m,{type:"primary",onClick:ee},{default:t(()=>[h("确 定")]),_:1}),e(m,{onClick:W},{default:t(()=>[h("取 消")]),_:1})])]),default:t(()=>[e(E,{ref:"projectRef",model:a(n),rules:a(M),"label-width":"90px"},{default:t(()=>[e(A,null,{default:t(()=>[e(d,{span:12},{default:t(()=>[e(s,{label:"项目名称",prop:"projectName"},{default:t(()=>[e(_,{modelValue:a(n).projectName,"onUpdate:modelValue":o[3]||(o[3]=l=>a(n).projectName=l),placeholder:"请输入项目名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{span:12},{default:t(()=>[e(s,{label:"显示排序",prop:"orderNum"},{default:t(()=>[e(ue,{modelValue:a(n).orderNum,"onUpdate:modelValue":o[4]||(o[4]=l=>a(n).orderNum=l),"controls-position":"right",min:0},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{span:12},{default:t(()=>[e(s,{label:"项目负责人",prop:"responsibleName"},{default:t(()=>[e(_,{modelValue:a(n).responsibleName,"onUpdate:modelValue":o[5]||(o[5]=l=>a(n).responsibleName=l),placeholder:"请输入负责人",maxlength:"20"},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{span:12},{default:t(()=>[e(s,{label:"测试负责人",prop:"testUser"},{default:t(()=>[e(_,{modelValue:a(n).testUser,"onUpdate:modelValue":o[6]||(o[6]=l=>a(n).testUser=l),placeholder:"请输入测试负责人",maxlength:"25"},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{span:12},{default:t(()=>[e(s,{label:"开发负责人",prop:"devUser"},{default:t(()=>[e(_,{modelValue:a(n).devUser,"onUpdate:modelValue":o[7]||(o[7]=l=>a(n).devUser=l),placeholder:"请输入开发负责人",maxlength:"20"},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{span:12},{default:t(()=>[e(s,{label:"发布应用",prop:"publishApp"},{default:t(()=>[e(_,{modelValue:a(n).publishApp,"onUpdate:modelValue":o[8]||(o[8]=l=>a(n).publishApp=l),placeholder:"请输入发布应用",maxlength:"20"},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{span:12},{default:t(()=>[e(s,{label:"简要描述",prop:"simpleDesc"},{default:t(()=>[e(_,{type:"textarea",rows:4,modelValue:a(n).simpleDesc,"onUpdate:modelValue":o[9]||(o[9]=l=>a(n).simpleDesc=l),placeholder:"简要描述",maxlength:"100"},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{span:12},{default:t(()=>[e(s,{label:"其他信息",prop:"otherDesc"},{default:t(()=>[e(_,{type:"textarea",rows:4,modelValue:a(n).otherDesc,"onUpdate:modelValue":o[10]||(o[10]=l=>a(n).otherDesc=l),placeholder:"其他信息",maxlength:"100"},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{span:12},{default:t(()=>[e(s,{label:"项目状态"},{default:t(()=>[e(de,{modelValue:a(n).status,"onUpdate:modelValue":o[11]||(o[11]=l=>a(n).status=l)},{default:t(()=>[(g(!0),S(Q,null,H(a(x),l=>(g(),w(se,{key:l.value,label:l.value},{default:t(()=>[h(R(l.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"]),e(Ne,{"dialog-visible":a(k),"onUpdate:dialogVisible":o[13]||(o[13]=l=>T(k)?k.value=l:null),"run-type":a(ve).project,"run-ids":a(y)},null,8,["dialog-visible","run-type","run-ids"])])}}});export{Re as default};
