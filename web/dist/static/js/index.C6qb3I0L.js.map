{"version":3,"file":"index.C6qb3I0L.js","sources":["../../../src/views/hrm/report/index.vue"],"sourcesContent":["<template>\r\n  <div class=\"app-container\">\r\n    <el-form :model=\"queryParams\" ref=\"queryRef\" :inline=\"true\" v-show=\"showSearch\">\r\n      <el-form-item label=\"报告名称\" prop=\"reportName\">\r\n        <el-input\r\n            v-model=\"queryParams.reportName\"\r\n            placeholder=\"请输入报告名称\"\r\n            clearable\r\n            style=\"width: 200px\"\r\n            @keyup.enter=\"handleQuery\"\r\n        />\r\n      </el-form-item>\r\n      <el-form-item label=\"状态\" prop=\"status\">\r\n        <el-select v-model=\"queryParams.status\" placeholder=\"报告状态\" clearable style=\"width: 100px\">\r\n          <el-option\r\n              v-for=\"dict in hrm_run_status\"\r\n              :key=\"dict.value\"\r\n              :label=\"dict.label\"\r\n              :value=\"dict.value\"\r\n          />\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item><el-checkbox v-model=\"onlySelf\" @change=\"getList\">仅自己的数据</el-checkbox></el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" icon=\"Search\" @click=\"handleQuery\">搜索</el-button>\r\n        <el-button type=\"default\" icon=\"Refresh\" @click=\"resetQuery\">重置</el-button>\r\n        <el-button type=\"danger\" icon=\"Delete\" @click=\"handleDelete\" v-hasPermi=\"['hrm:report:delete']\">删除</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n\r\n    <el-table v-loading=\"loading\"\r\n              :data=\"reportList\"\r\n              @selection-change=\"handleSelectionChange\"\r\n              border\r\n              table-layout=\"fixed\"\r\n              max-height=\"calc(100vh - 240px)\"\r\n    >\r\n      <el-table-column type=\"selection\" width=\"55\" align=\"center\"/>\r\n      <el-table-column label=\"ID\" align=\"center\" prop=\"reportId\" width=\"150\"/>\r\n      <el-table-column label=\"报告名\" align=\"left\" prop=\"reportName\" min-width=\"200\"/>\r\n      <el-table-column label=\"success\" align=\"center\" prop=\"success\" width=\"80\"/>\r\n      <el-table-column label=\"total\" align=\"center\" prop=\"total\" width=\"70\"/>\r\n      <el-table-column label=\"status\" align=\"center\" prop=\"status\" width=\"80\">\r\n\r\n        <template #default=\"scope\">\r\n          <dict-tag :options=\"hrm_run_status\" :value=\"scope.row.status\"/>\r\n        </template>\r\n      </el-table-column  >\r\n      <el-table-column label=\"创建人\" align=\"center\" prop=\"createBy\" width=\"70\"/>\r\n      <el-table-column label=\"执行开始时间\" align=\"center\" prop=\"createTime\" class-name=\"small-padding fixed-width\" width=\"150\">\r\n        <template #default=\"scope\">\r\n          <span>{{ parseTime(scope.row.startAt) }}</span>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"执行时长(S)\" align=\"center\" prop=\"createTime\" class-name=\"small-padding fixed-width\" width=\"100\">\r\n        <template #default=\"scope\">\r\n          <span>{{ scope.row.testDuration }}</span>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"操作\" width=\"80\" align=\"center\" class-name=\"small-padding fixed-width\" fixed=\"right\">\r\n        <template #default=\"scope\">\r\n          <el-button link type=\"primary\" icon=\"View\" @click=\"handleView(scope.row)\" v-hasPermi=\"['hrm:report:detail']\"\r\n                     title=\"查看\">\r\n          </el-button>\r\n          <el-button link type=\"danger\" icon=\"Delete\" @click=\"handleDelete(scope.row)\"\r\n                     v-hasPermi=\"['hrm:report:delete']\" title=\"删除\">\r\n          </el-button>\r\n        </template>\r\n      </el-table-column  >\r\n    </el-table>\r\n\r\n    <pagination\r\n        v-show=\"total > 0\"\r\n        :total=\"total\"\r\n        v-model:page=\"queryParams.pageNum\"\r\n        v-model:limit=\"queryParams.pageSize\"\r\n        @pagination=\"getList\"\r\n    />\r\n\r\n    <el-dialog fullscreen\r\n               v-model=\"showReportDetail\"\r\n               :title=\"'报告详情【'+currentReport.reportId+'>>'+currentReport.reportName+'】'\"\r\n               append-to-body destroy-on-close>\r\n      <el-container style=\"height: 100%\">\r\n        <!--          <el-header height=\"20px\" border=\"2px\" style=\"border-bottom-color: #97a8be;text-align: right\">-->\r\n        <!--          </el-header>-->\r\n        <el-main style=\"max-height: calc(100vh - 95px);\">\r\n          <RunDetail :report-id=\"currentReportId\" :view-type=\"runDetailViewTypeEnum.report\"></RunDetail>\r\n        </el-main>\r\n      </el-container>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script setup name=\"RunDetail\">\r\nimport * as ReportApi from \"@/api/hrm/report.js\";\r\nimport {runDetailViewTypeEnum} from \"@/components/hrm/enum.js\";\r\nimport DictTag from \"@/components/DictTag/index.vue\";\r\nimport RunDetail from \"@/components/hrm/common/run/run-detail.vue\";\r\n\r\n\r\nconst {proxy} = getCurrentInstance();\r\nconst {sys_normal_disable} = proxy.useDict(\"sys_normal_disable\");\r\nconst {hrm_run_status} = proxy.useDict(\"hrm_run_status\");\r\nconst {sys_request_method} = proxy.useDict(\"sys_request_method\");\r\nconst {hrm_data_type} = proxy.useDict(\"hrm_data_type\");\r\nconst {qtr_case_status} = proxy.useDict(\"qtr_case_status\");\r\n\r\n\r\nprovide(\"hrm_data_type\", hrm_data_type);\r\nprovide(\"qtr_case_status\", qtr_case_status);\r\n\r\nconst reportList = ref([]);\r\nconst projectOptions = ref([]);\r\nconst open = ref(false);\r\nconst loading = ref(true);\r\nconst showSearch = ref(true);\r\nconst ids = ref([]);\r\nconst single = ref(true);\r\nconst multiple = ref(true);\r\nconst total = ref(0);\r\nconst showReportDetail = ref(false);\r\nconst currentReportId = ref(null);\r\nconst currentReport = ref({});\r\nconst onlySelf = ref(true);\r\n\r\nconst data = reactive({\r\n  // form: {},\r\n  queryParams: {\r\n    pageNum: 1,\r\n    pageSize: 10,\r\n    reportId: undefined,\r\n    reportName: undefined,\r\n    projectId: undefined,\r\n    moduleId: undefined,\r\n    status: undefined,\r\n    onlySelf: onlySelf,\r\n  }\r\n});\r\n\r\nconst {queryParams} = toRefs(data);\r\n\r\n/** 查询用例列表 */\r\nfunction getList() {\r\n  loading.value = true;\r\n  ReportApi.list(queryParams.value).then(response => {\r\n    reportList.value = response.rows;\r\n    total.value = response.total;\r\n    loading.value = false;\r\n  });\r\n}\r\n\r\n\r\n/** 搜索按钮操作 */\r\nfunction handleQuery() {\r\n  queryParams.value.pageNum = 1;\r\n  getList();\r\n}\r\n\r\n/** 重置按钮操作 */\r\nfunction resetQuery() {\r\n  proxy.resetForm(\"queryRef\");\r\n  handleQuery();\r\n}\r\n\r\n/** 多选框选中数据 */\r\nfunction handleSelectionChange(selection) {\r\n  ids.value = selection.map(item => item.reportId);\r\n  single.value = selection.length != 1;\r\n  multiple.value = !selection.length;\r\n}\r\n\r\n\r\n/** 删除按钮操作 */\r\nfunction handleDelete(row) {\r\n  let detailIds = [];\r\n  if (row.reportId) {\r\n    detailIds = [row.reportId];\r\n  } else {\r\n    detailIds = ids.value\r\n  }\r\n  proxy.$modal.confirm('是否确认删除ID为\"' + detailIds + '\"的数据项？').then(function () {\r\n    return ReportApi.del({reportIds: detailIds});\r\n  }).then(() => {\r\n    getList();\r\n    proxy.$modal.msgSuccess(\"删除成功\");\r\n  }).catch(() => {\r\n  });\r\n}\r\n\r\nfunction handleView(row) {\r\n  let detailIds = row.reportId;\r\n  currentReport.value = {}\r\n  currentReport.value = row;\r\n  currentReportId.value = detailIds;\r\n  showReportDetail.value = true;\r\n  // ReportApi.detail(detailIds).then(response => {\r\n  //   alert(JSON.stringify(response, null, 4));\r\n  // });\r\n}\r\n\r\n\r\ngetList();\r\n</script>\r\n"],"names":["proxy","getCurrentInstance","hrm_run_status","hrm_data_type","qtr_case_status","provide","reportList","ref","loading","showSearch","ids","single","multiple","total","showReportDetail","currentReportId","currentReport","onlySelf","data","reactive","queryParams","toRefs","getList","ReportApi.list","response","handleQuery","resetQuery","handleSelectionChange","selection","item","handleDelete","row","detailIds","ReportApi.del","handleView"],"mappings":"60BAqGA,KAAM,CAAC,MAAAA,CAAK,EAAIC,KACaD,EAAM,QAAQ,oBAAoB,EAC/D,KAAM,CAAC,eAAAE,CAAc,EAAIF,EAAM,QAAQ,gBAAgB,EAC1BA,EAAM,QAAQ,oBAAoB,EAC/D,KAAM,CAAC,cAAAG,CAAa,EAAIH,EAAM,QAAQ,eAAe,EAC/C,CAAC,gBAAAI,CAAe,EAAIJ,EAAM,QAAQ,iBAAiB,EAGzDK,EAAQ,gBAAiBF,CAAa,EACtCE,EAAQ,kBAAmBD,CAAe,EAE1C,MAAME,EAAaC,EAAI,CAAA,CAAE,EACFA,EAAI,EAAE,EAChBA,EAAI,EAAK,EACtB,MAAMC,EAAUD,EAAI,EAAI,EAClBE,EAAaF,EAAI,EAAI,EACrBG,EAAMH,EAAI,CAAA,CAAE,EACZI,EAASJ,EAAI,EAAI,EACjBK,EAAWL,EAAI,EAAI,EACnBM,EAAQN,EAAI,CAAC,EACbO,EAAmBP,EAAI,EAAK,EAC5BQ,EAAkBR,EAAI,IAAI,EAC1BS,EAAgBT,EAAI,CAAA,CAAE,EACtBU,EAAWV,EAAI,EAAI,EAEnBW,EAAOC,GAAS,CAEpB,YAAa,CACX,QAAS,EACT,SAAU,GACV,SAAU,OACV,WAAY,OACZ,UAAW,OACX,SAAU,OACV,OAAQ,OACR,SAAUF,CACX,CACH,CAAC,EAEK,CAAC,YAAAG,CAAW,EAAIC,GAAOH,CAAI,EAGjC,SAASI,GAAU,CACjBd,EAAQ,MAAQ,GAChBe,GAAeH,EAAY,KAAK,EAAE,KAAKI,GAAY,CACjDlB,EAAW,MAAQkB,EAAS,KAC5BX,EAAM,MAAQW,EAAS,MACvBhB,EAAQ,MAAQ,EACpB,CAAG,CACH,CAIA,SAASiB,GAAc,CACrBL,EAAY,MAAM,QAAU,EAC5BE,GACF,CAGA,SAASI,GAAa,CACpB1B,EAAM,UAAU,UAAU,EAC1ByB,GACF,CAGA,SAASE,EAAsBC,EAAW,CACxClB,EAAI,MAAQkB,EAAU,IAAIC,GAAQA,EAAK,QAAQ,EAC/ClB,EAAO,MAAQiB,EAAU,QAAU,EACnChB,EAAS,MAAQ,CAACgB,EAAU,MAC9B,CAIA,SAASE,EAAaC,EAAK,CACzB,IAAIC,EAAY,CAAA,EACZD,EAAI,SACNC,EAAY,CAACD,EAAI,QAAQ,EAEzBC,EAAYtB,EAAI,MAElBV,EAAM,OAAO,QAAQ,aAAegC,EAAY,QAAQ,EAAE,KAAK,UAAY,CACzE,OAAOC,GAAc,CAAC,UAAWD,CAAS,CAAC,CAC/C,CAAG,EAAE,KAAK,IAAM,CACZV,IACAtB,EAAM,OAAO,WAAW,MAAM,CAClC,CAAG,EAAE,MAAM,IAAM,CACjB,CAAG,CACH,CAEA,SAASkC,EAAWH,EAAK,CACvB,IAAIC,EAAYD,EAAI,SACpBf,EAAc,MAAQ,CAAE,EACxBA,EAAc,MAAQe,EACtBhB,EAAgB,MAAQiB,EACxBlB,EAAiB,MAAQ,EAI3B,CAGA,OAAAQ"}