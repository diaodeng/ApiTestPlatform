import{g as le,u as te,a as oe,d as ae}from"./module.BtM26r-p.js";import{l as ne}from"./project.DdvPERQ7.js";import{R as ue,S as re}from"./enum.Cve1eJHF.js";import{_ as de}from"./run_dialog.DpBuEVxn.js";import{_ as se}from"./module-table-query.BA8awfxK.js";import{r,J as ie,N as me,C as pe,d as s,H as fe,o as i,c as U,e as t,f as o,I as _,m as g,p as c,h as a,i as ce,O as $,P,y as ve,K as q,s as _e,E as ge}from"./index.N0ypA0wQ.js";import"./run-config.CZpgWmf3.js";import"./env-selector.Ck8UcPDe.js";import"./env.CsFNKyYM.js";import"./forward.BcwXDGVj.js";import"./agent.CW2QP-1A.js";import"./data-template.pUAxcsDo.js";import"./tools.fhJnEm5t.js";import"./run_detail.BRg85oWr.js";const ye={class:"app-container"},Ve={class:"dialog-footer"},qe={__name:"index",setup(be){const{proxy:m}=_e(),{qtr_data_status:E}=m.useDict("qtr_data_status");r([]);const w=r([]),p=r(!1),h=r(!1);r(!0);const k=r([]),N=r(!0),j=r(!0);r(0);const C=r(""),I=r(!1),y=r([]),x=r(null),M=ie({form:{testUser:void 0},queryParams:{pageNum:1,pageSize:10,projectId:void 0,moduleName:void 0,status:void 0},rules:{moduleName:[{required:!0,message:"模块名称不能为空",trigger:"blur"}],projectId:[{required:!0,message:"所属项目不能为空",trigger:"blur"}],testUser:[{required:!0,message:"测试负责人不能为空",trigger:"blur"}],sort:[{required:!0,message:"模块顺序不能为空",trigger:"blur"}]}}),{queryParams:B,form:n,rules:Q}=me(M);function T(){ne({isPage:!1}).then(u=>{w.value=u.data})}function F(){p.value=!1,D()}function D(){n.value={moduleId:void 0,projectId:void 0,moduleName:void 0,sort:0,status:re.normal.value,remark:void 0},m.resetForm("postRef")}function O(u){k.value=u.map(e=>e.moduleId),y.value=k.value,N.value=u.length!=1,j.value=!u.length}function z(){D(),p.value=!0,C.value="添加模块"}function S(u){h.value=!0,D();const e=u.moduleId||k.value;le(e).then(d=>{n.value=d.data,p.value=!0,C.value="修改模块"}).finally(()=>{h.value=!1})}function A(){m.$refs.postRef.validate(u=>{u&&(n.value.moduleId!=null?te(n.value).then(e=>{m.$modal.msgSuccess("修改成功"),p.value=!1,x.value.handleQuery()}):oe(n.value).then(e=>{m.$modal.msgSuccess("新增成功"),p.value=!1,x.value.handleQuery()}))})}function R(u){const e=u.moduleId||k.value;m.$modal.confirm('是否确认删除模块编号为"'+e+'"的数据项？').then(function(){return ae(e)}).then(()=>{x.value.handleQuery(),m.$modal.msgSuccess("删除成功")}).catch(()=>{})}function H(){m.download("hrm/module/export",{...B.value},`Module_${new Date().getTime()}.xlsx`)}function J(u){if(u&&"moduleId"in u&&u.moduleId&&(y.value=[u.moduleId]),!y.value||y.value.length===0){ge.alert("请选择要运行的模块","提示！",{type:"warning"});return}I.value=!0}return pe(()=>{T()}),(u,e)=>{const d=s("el-button"),V=s("el-col"),b=s("el-input"),f=s("el-form-item"),K=s("el-option"),L=s("el-select"),G=s("el-input-number"),W=s("el-radio"),X=s("el-radio-group"),Y=s("el-form"),Z=s("el-dialog"),v=fe("hasPermi");return i(),U("div",ye,[t(se,{onSelectChange:O,ref_key:"moduleQueryViewRef",ref:x},{"table-tool":o(()=>[t(V,{span:1.5},{default:o(()=>[_((i(),g(d,{type:"primary",plain:"",icon:"Plus",onClick:z},{default:o(()=>e[10]||(e[10]=[c("新增 ")])),_:1})),[[v,["hrm:module:add"]]])]),_:1}),t(V,{span:1.5},{default:o(()=>[_((i(),g(d,{type:"success",plain:"",icon:"Edit",disabled:a(N),onClick:S},{default:o(()=>e[11]||(e[11]=[c("修改 ")])),_:1},8,["disabled"])),[[v,["hrm:module:edit"]]])]),_:1}),t(V,{span:1.5},{default:o(()=>[_((i(),g(d,{type:"danger",plain:"",icon:"Delete",disabled:a(j),onClick:R},{default:o(()=>e[12]||(e[12]=[c("删除 ")])),_:1},8,["disabled"])),[[v,["hrm:module:remove"]]])]),_:1}),t(V,{span:1.5},{default:o(()=>[_((i(),g(d,{type:"warning",plain:"",icon:"Download",onClick:H},{default:o(()=>e[13]||(e[13]=[c("导出 ")])),_:1})),[[v,["hrm:module:export"]]])]),_:1}),t(V,{span:1.5},{default:o(()=>[_((i(),g(d,{type:"warning",icon:"CaretRight",onClick:J,title:"运行"},{default:o(()=>e[14]||(e[14]=[c(" 执行 ")])),_:1})),[[v,["hrm:case:run"]]])]),_:1})]),tableOperate:o(({scope:l})=>[_(t(d,{link:"",type:"primary",icon:"Edit",onClick:ee=>S(l.row),loading:a(h)},null,8,["onClick","loading"]),[[v,["hrm:module:edit"]]]),_(t(d,{link:"",type:"primary",icon:"Delete",onClick:ee=>R(l.row)},null,8,["onClick"]),[[v,["hrm:module:remove"]]])]),_:1},512),t(Z,{title:a(C),modelValue:a(p),"onUpdate:modelValue":e[8]||(e[8]=l=>q(p)?p.value=l:null),width:"600px","append-to-body":""},{footer:o(()=>[ce("div",Ve,[t(d,{type:"primary",onClick:A},{default:o(()=>e[15]||(e[15]=[c("确 定")])),_:1}),t(d,{onClick:F},{default:o(()=>e[16]||(e[16]=[c("取 消")])),_:1})])]),default:o(()=>[t(Y,{ref:"postRef",model:a(n),rules:a(Q),"label-width":"100px"},{default:o(()=>[t(f,{label:"模块名称",prop:"moduleName"},{default:o(()=>[t(b,{modelValue:a(n).moduleName,"onUpdate:modelValue":e[0]||(e[0]=l=>a(n).moduleName=l),placeholder:"请输入模块名称"},null,8,["modelValue"])]),_:1}),t(f,{label:"所属项目",prop:"projectId"},{default:o(()=>[t(L,{modelValue:a(n).projectId,"onUpdate:modelValue":e[1]||(e[1]=l=>a(n).projectId=l),placeholder:"请选择"},{default:o(()=>[(i(!0),U($,null,P(a(w),l=>(i(),g(K,{key:l.projectId,label:l.projectName,value:l.projectId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(f,{label:"测试负责人",prop:"testUser"},{default:o(()=>[t(b,{modelValue:a(n).testUser,"onUpdate:modelValue":e[2]||(e[2]=l=>a(n).testUser=l),placeholder:"请输入测试负责人"},null,8,["modelValue"])]),_:1}),t(f,{label:"模块顺序",prop:"sort"},{default:o(()=>[t(G,{modelValue:a(n).sort,"onUpdate:modelValue":e[3]||(e[3]=l=>a(n).sort=l),"controls-position":"right",min:0},null,8,["modelValue"])]),_:1}),t(f,{label:"模块状态",prop:"status"},{default:o(()=>[t(X,{modelValue:a(n).status,"onUpdate:modelValue":e[4]||(e[4]=l=>a(n).status=l)},{default:o(()=>[(i(!0),U($,null,P(a(E),l=>(i(),g(W,{key:l.value*1,value:l.value*1},{default:o(()=>[c(ve(l.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(f,{label:"简要描述",prop:"simpleDesc"},{default:o(()=>[t(b,{type:"textarea",rows:4,modelValue:a(n).simpleDesc,"onUpdate:modelValue":e[5]||(e[5]=l=>a(n).simpleDesc=l),placeholder:"简要描述",maxlength:"100"},null,8,["modelValue"])]),_:1}),t(f,{label:"其他信息",prop:"otherDesc"},{default:o(()=>[t(b,{type:"textarea",rows:4,modelValue:a(n).otherDesc,"onUpdate:modelValue":e[6]||(e[6]=l=>a(n).otherDesc=l),placeholder:"其他信息",maxlength:"100"},null,8,["modelValue"])]),_:1}),t(f,{label:"备注",prop:"remark"},{default:o(()=>[t(b,{modelValue:a(n).remark,"onUpdate:modelValue":e[7]||(e[7]=l=>a(n).remark=l),type:"textarea",placeholder:"请输入内容"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"]),t(de,{"dialog-visible":a(I),"onUpdate:dialogVisible":e[9]||(e[9]=l=>q(I)?I.value=l:null),"run-type":a(ue).module,"run-ids":a(y)},null,8,["dialog-visible","run-type","run-ids"])])}}};export{qe as default};
//# sourceMappingURL=index.BI0Vj3w2.js.map
