import{d as le,r as c,J as ae,N as oe,C as ne,ab as re,e as u,H as se,c as q,o as h,I as k,f as t,k as R,M as P,l as a,i as n,m as ie,O as ue,P as de,j as N,n as U,aE as E,K as ce,h as B,y as D,L as pe}from"./index.DLM0P_FN.js";import{l as me}from"./project.NehpJ71d.js";const fe={class:"app-container"},be={__name:"project-table-query",props:{showPagination:{type:Boolean,default:!0},checkedIds:{type:Array,default:[]}},emits:["selectChange"],setup(x,{expose:A,emit:L}){const{proxy:C}=le(),{qtr_data_status:T}=C.useDict("qtr_data_status"),_=x,z=L;A({handleQuery:w,getSelectedIds:F});const g=c(null),f=c([]),I=c(0);c(!1);const S=c(!0),v=c(!0);c("");const K=c(!0),O=c(!0),m=c([]),V=c([]),Q=ae({form:{},queryParams:{projectName:void 0,status:void 0,pageNum:1,pageSize:10},rules:{projectName:[{required:!0,message:"项目名称不能为空",trigger:"blur"}],orderNum:[{required:!0,message:"显示排序不能为空",trigger:"blur"}]}}),{queryParams:p,form:ge,rules:he}=oe(Q);function b(){S.value=!0,me(p.value).then(o=>{f.value=o.rows,I.value=o.total,pe(()=>{g.value&&g.value.clearSelection(),_.checkedIds&&_.checkedIds.length>0&&g.value&&f.value&&f.value.forEach(e=>{_.checkedIds.find(r=>r===e.projectId)&&g.value.toggleRowSelection(e,!0)})}),S.value=!1})}function $(o){z("selectChange",o),V.value=o.map(e=>e.projectId)}function F(){return V.value}function w(){b()}function M(){C.resetForm("queryRef"),w()}function H(o,e){let r=f.value.map(i=>i.projectId),s=o.map(i=>i.projectId),j=r.filter(i=>!s.includes(i));s.forEach(i=>{m.value.some(y=>y===i)||m.value.push(i)}),m.value=m.value.filter(i=>!j.includes(i))}function J(o){let e=o.map(r=>r.projectId);if(e&&e.length>0)e.forEach(r=>{m.value.some(s=>s===r)||m.value.push(r)});else{let r=f.value.map(s=>s.projectId);m.value=m.value.filter(s=>!r.includes(s))}}return ne(()=>{m.value=re(_.checkedIds),b()}),(o,e)=>{const r=u("el-input"),s=u("el-form-item"),j=u("el-option"),i=u("el-select"),y=u("el-button"),G=u("el-form"),W=u("right-toolbar"),X=u("el-row"),d=u("el-table-column"),Y=u("dict-tag"),Z=u("el-table"),ee=u("pagination"),te=se("loading");return h(),q("div",fe,[k(t(G,{model:a(p),ref:"queryRef",inline:!0},{default:n(()=>[t(s,{label:"项目名称",prop:"projectName"},{default:n(()=>[t(r,{modelValue:a(p).projectName,"onUpdate:modelValue":e[0]||(e[0]=l=>a(p).projectName=l),placeholder:"请输入项目名称",clearable:"",style:{width:"200px"},onKeyup:ie(w,["enter"])},null,8,["modelValue"])]),_:1}),t(s,{label:"状态",prop:"status"},{default:n(()=>[t(i,{modelValue:a(p).status,"onUpdate:modelValue":e[1]||(e[1]=l=>a(p).status=l),placeholder:"项目状态",clearable:"",style:{width:"200px"}},{default:n(()=>[(h(!0),q(ue,null,de(a(T),l=>(h(),N(j,{key:l.value*1,label:l.label,value:l.value*1},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(s,null,{default:n(()=>[t(y,{type:"primary",icon:"Search",onClick:w},{default:n(()=>e[5]||(e[5]=[U("搜索")])),_:1,__:[5]}),t(y,{icon:"Refresh",onClick:M},{default:n(()=>e[6]||(e[6]=[U("重置")])),_:1,__:[6]})]),_:1})]),_:1},8,["model"]),[[P,a(v)]]),t(X,{gutter:10,class:"mb8"},{default:n(()=>[E(o.$slots,"table-tool"),t(W,{showSearch:a(v),"onUpdate:showSearch":e[2]||(e[2]=l=>ce(v)?v.value=l:null),onQueryTable:b},null,8,["showSearch"])]),_:3}),a(O)?k((h(),N(Z,{key:0,border:"",ref_key:"tableRef",ref:g,data:a(f),"row-key":"projectId","table-layout":"fixed","default-expand-all":a(K),onSelectionChange:$,onSelect:H,onSelectAll:J,"max-height":"calc(100vh - 280px)"},{default:n(()=>[t(d,{type:"selection",width:"55",align:"center"}),t(d,{prop:"projectId",label:"ID",width:"150"}),t(d,{prop:"projectName",align:"left",label:"项目名称","min-width":"200"}),t(d,{prop:"responsibleName",align:"center",label:"负责人",width:"100"}),t(d,{prop:"testUser",label:"测试负责人",align:"center",width:"100"}),t(d,{prop:"devUser",label:"开发负责人",align:"center",width:"100"}),t(d,{prop:"orderNum",label:"排序",align:"center",width:"70"}),t(d,{prop:"status",label:"状态",align:"center",width:"70"},{default:n(l=>[t(Y,{options:a(T),value:l.row.status},null,8,["options","value"])]),_:1}),t(d,{label:"创建时间",align:"center",prop:"createTime","class-name":"small-padding fixed-width",width:"150"},{default:n(l=>[B("span",null,D(o.parseTime(l.row.createTime)),1)]),_:1}),t(d,{label:"更新时间",align:"center",prop:"updateTime","class-name":"small-padding fixed-width",width:"150"},{default:n(l=>[B("span",null,D(o.parseTime(l.row.updateTime)),1)]),_:1}),o.$slots.tableOperate?(h(),N(d,{key:0,label:"操作",align:"center","class-name":"small-padding fixed-width",fixed:"right",width:"120"},{default:n(l=>[E(o.$slots,"tableOperate",{scope:l})]),_:3})):R("",!0)]),_:3},8,["data","default-expand-all"])),[[te,a(S)]]):R("",!0),k(t(ee,{total:a(I),page:a(p).pageNum,"onUpdate:page":e[3]||(e[3]=l=>a(p).pageNum=l),limit:a(p).pageSize,"onUpdate:limit":e[4]||(e[4]=l=>a(p).pageSize=l),onPagination:b},null,8,["total","page","limit"]),[[P,a(I)>0&&x.showPagination]])])}}};export{be as _};
//# sourceMappingURL=project-table-query.BTToiq7O.js.map
