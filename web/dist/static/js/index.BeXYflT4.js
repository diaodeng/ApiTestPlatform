import{F as _e,d as ve,r as i,a5 as ye,v as J,C as we,e as u,H as A,c as he,o as N,I as f,f as l,M as G,l as t,i as o,m as W,n as g,j as P,K as D,h as z,y as X,au as b,az as be,ab as Ve}from"./index.DLM0P_FN.js";import{l as Ie,d as ke,g as xe,u as Ce,a as Re,c as Ne}from"./forward.CYnhzzK1.js";import{c as S}from"./data-template.BrUbBjfC.js";import De from"./forward_detail_index.CszqJAfd.js";import"./tools.De_J0dJF.js";import"./enum.BYy-eByp.js";import"./tag-selector.DDD2vd4J.js";import"./tag-enum.DfiWmJ8r.js";const Se={class:"app-container"},Ue={class:"dialog-footer"},qe=_e({name:"Rules"}),je=Object.assign(qe,{setup(Te){const{proxy:U}=ve(),K=i([]),x=i(!0),Y=i(!0),O=i(!0),q=i(0),C=i(""),T=i([]),c=i(!1),R=i(!1),V=i(S),v=i(!1),y=i(S),d=ye({pageNum:1,pageSize:10,ruleId:void 0,ruleName:void 0,status:void 0,onlySelf:!0}),s=i(S),r=i({page:!1,edite:!1,copy:!1}),Z=J(()=>s.value.ruleId?"【"+s.value.ruleId+"】":""),ee=J(()=>(V.value.ruleId?"【"+V.value.ruleId+"】":"")+V.value.ruleName);function le(n){R.value=!0,V.value=n}function te(n){v.value=!0,y.value=structuredClone(be(Ve(n)))}function ae(){v.value=!0;let n={ruleId:y.value.ruleId,ruleName:y.value.ruleName};Ne(n).then(e=>{b.success("复制成功")}).finally(()=>{v.value=!1})}function I(){r.value.page=!0,Ie(d.value).then(n=>{K.value=n.rows,q.value=n.total}).finally(()=>{r.value.page=!1})}function k(){d.value.pageNum=1,I()}function oe(){U.resetForm("queryRef"),k()}function ne(n){T.value=n.map(e=>e.ruleId),Y.value=n.length!==1,O.value=!n.length}function ue(){C.value="添加转发规则",s.value=JSON.parse(JSON.stringify(S)),c.value=!0}function ie(n){r.value.edite=!0;const e=n.ruleId||T.value;xe(e).then(m=>{if(!m.data||Object.keys(m.data).length===0){b.warning("未查到对应数据！");return}s.value=m.data,C.value="修改转发规则",c.value=!0}).finally(()=>{r.value.edite=!1})}function j(n){const e=n.ruleId?[n.ruleId]:T.value;U.$modal.confirm('是否确认删除ID为"'+e+'"的数据项？').then(function(){return ke({ruleId:e})}).then(()=>{I(),U.$modal.msgSuccess("删除成功")}).catch(()=>{})}function de(){r.value.edite=!0,s.value.ruleId?Ce(s.value).then(n=>{b.success(n.msg),c.value=!1}).catch(n=>{b.error("操作失败："+n)}).finally(()=>{r.value.edite=!1}):Re(s.value).then(n=>{b.success(n.msg),c.value=!1}).catch(n=>{b.error("操作失败："+n)}).finally(()=>{r.value.edite=!1})}return we(()=>{I()}),(n,e)=>{var M,Q;const m=u("el-input"),w=u("el-form-item"),re=u("el-checkbox"),p=u("el-button"),H=u("el-form"),L=u("el-col"),se=u("right-toolbar"),pe=u("el-row"),_=u("el-table-column"),me=u("el-table"),fe=u("pagination"),$=u("el-main"),ce=u("el-footer"),B=u("el-container"),E=u("el-dialog"),h=A("hasPermi"),ge=A("loading");return N(),he("div",Se,[f(l(H,{model:t(d),ref:"queryRef",inline:!0},{default:o(()=>[l(w,{label:"转发规则ID",prop:"ruleId"},{default:o(()=>[l(m,{modelValue:t(d).ruleId,"onUpdate:modelValue":e[0]||(e[0]=a=>t(d).ruleId=a),placeholder:"请输入转发规则Id",clearable:"",style:{width:"200px"},onKeyup:W(k,["enter"])},null,8,["modelValue"])]),_:1}),l(w,{label:"转发规则名称",prop:"ruleName"},{default:o(()=>[l(m,{modelValue:t(d).ruleName,"onUpdate:modelValue":e[1]||(e[1]=a=>t(d).ruleName=a),placeholder:"请输入转发规则名称",clearable:"",style:{width:"200px"},onKeyup:W(k,["enter"])},null,8,["modelValue"])]),_:1}),l(w,null,{default:o(()=>[l(re,{modelValue:t(d).onlySelf,"onUpdate:modelValue":e[2]||(e[2]=a=>t(d).onlySelf=a),onChange:k},{default:o(()=>e[13]||(e[13]=[g("仅自己的数据")])),_:1,__:[13]},8,["modelValue"])]),_:1}),l(w,null,{default:o(()=>[l(p,{type:"primary",icon:"Search",onClick:k,loading:t(r).page,disabled:t(r).page},{default:o(()=>e[14]||(e[14]=[g(" 搜索 ")])),_:1,__:[14]},8,["loading","disabled"]),l(p,{type:"default",icon:"Refresh",onClick:oe},{default:o(()=>e[15]||(e[15]=[g("重置")])),_:1,__:[15]})]),_:1})]),_:1},8,["model"]),[[G,t(x)]]),l(pe,{gutter:10,class:"mb8"},{default:o(()=>[l(L,{span:1.5},{default:o(()=>[f((N(),P(p,{type:"primary",plain:"",icon:"Plus",onClick:ue},{default:o(()=>e[16]||(e[16]=[g("新增 ")])),_:1,__:[16]})),[[h,["qtr:forwardRules:add"]]])]),_:1}),l(L,{span:1.5},{default:o(()=>[f((N(),P(p,{type:"danger",plain:"",icon:"Delete",disabled:t(O),onClick:j},{default:o(()=>e[17]||(e[17]=[g("删除 ")])),_:1,__:[17]},8,["disabled"])),[[h,["qtr:forwardRules:remove"]]])]),_:1}),l(se,{showSearch:t(x),"onUpdate:showSearch":e[3]||(e[3]=a=>D(x)?x.value=a:null),onQueryTable:I},null,8,["showSearch"])]),_:1}),f((N(),P(me,{data:t(K),onSelectionChange:ne,border:"","table-layout":"fixed","max-height":"calc(100vh - 280px)"},{default:o(()=>[l(_,{type:"selection",width:"55",align:"center"}),l(_,{label:"转发规则ID",prop:"ruleId",width:"150px"}),l(_,{label:"转发规则名称",prop:"ruleName",width:"auto","min-width":"200px"}),l(_,{label:"创建人",align:"center",prop:"createBy",width:"80px"}),l(_,{label:"创建时间",align:"center",prop:"createTime","class-name":"small-padding fixed-width",width:"150px"},{default:o(a=>[z("span",null,X(n.parseTime(a.row.createTime)),1)]),_:1}),l(_,{label:"更新时间",align:"center",prop:"createTime","class-name":"small-padding fixed-width",width:"150px"},{default:o(a=>[z("span",null,X(n.parseTime(a.row.updateTime)),1)]),_:1}),l(_,{label:"操作",width:"170",align:"center","class-name":"small-padding fixed-width",fixed:"right"},{default:o(a=>[f(l(p,{link:"",type:"warning",icon:"Histogram",loading:t(r).edite,onClick:F=>le(a.row),title:"详情"},null,8,["loading","onClick"]),[[h,["qtr:forwardRules:edit"]]]),f(l(p,{link:"",type:"warning",icon:"Edit",loading:t(r).edite,onClick:F=>ie(a.row),title:"编辑"},null,8,["loading","onClick"]),[[h,["qtr:forwardRules:edit"]]]),f(l(p,{link:"",type:"warning",icon:"CopyDocument",loading:t(r).copy,onClick:F=>te(a.row),title:"复制"},null,8,["loading","onClick"]),[[h,["qtr:forwardRules:copy"]]]),f(l(p,{link:"",type:"danger",icon:"Delete",onClick:F=>j(a.row),title:"删除"},null,8,["onClick"]),[[h,["qtr:forwardRules:remove"]]])]),_:1})]),_:1},8,["data"])),[[ge,t(r).page]]),f(l(fe,{total:t(q),page:t(d).pageNum,"onUpdate:page":e[4]||(e[4]=a=>t(d).pageNum=a),limit:t(d).pageSize,"onUpdate:limit":e[5]||(e[5]=a=>t(d).pageSize=a),onPagination:I},null,8,["total","page","limit"]),[[G,t(q)>0]]),l(E,{title:t(C)+" >> "+t(Z)+((M=t(s))==null?void 0:M.ruleName),modelValue:t(c),"onUpdate:modelValue":e[9]||(e[9]=a=>D(c)?c.value=a:null),"append-to-body":"","destroy-on-close":""},{default:o(()=>[l(B,{style:{height:"100%"}},{default:o(()=>[l($,{style:{"max-height":"calc(100vh - 95px)"}},{default:o(()=>[l(H,null,{default:o(()=>[l(w,{label:"规则名称："},{default:o(()=>[l(m,{modelValue:t(s).ruleName,"onUpdate:modelValue":e[6]||(e[6]=a=>t(s).ruleName=a)},null,8,["modelValue"])]),_:1}),l(w,{label:"简要描述："},{default:o(()=>[l(m,{modelValue:t(s).simpleDesc,"onUpdate:modelValue":e[7]||(e[7]=a=>t(s).simpleDesc=a)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(ce,null,{default:o(()=>[z("div",Ue,[l(p,{onClick:e[8]||(e[8]=a=>c.value=!1)},{default:o(()=>e[18]||(e[18]=[g("取消")])),_:1,__:[18]}),l(p,{type:"primary",onClick:de},{default:o(()=>e[19]||(e[19]=[g("保存")])),_:1,__:[19]})])]),_:1})]),_:1})]),_:1},8,["title","modelValue"]),l(E,{title:(Q=t(y))==null?void 0:Q.ruleName,modelValue:t(v),"onUpdate:modelValue":e[11]||(e[11]=a=>D(v)?v.value=a:null),"append-to-body":"","destroy-on-close":""},{default:o(()=>[l(B,{style:{height:"100%"}},{default:o(()=>[l($,{style:{"max-height":"calc(100vh - 95px)"}},{default:o(()=>[l(m,{placeholder:"请输入转发规则名称",modelValue:t(y).ruleName,"onUpdate:modelValue":e[10]||(e[10]=a=>t(y).ruleName=a)},{suffix:o(()=>[l(p,{onClick:ae},{default:o(()=>e[20]||(e[20]=[g("保存")])),_:1,__:[20]})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["title","modelValue"]),l(E,{fullscreen:"",title:t(C)+" >> "+t(ee),modelValue:t(R),"onUpdate:modelValue":e[12]||(e[12]=a=>D(R)?R.value=a:null),"append-to-body":"","destroy-on-close":""},{default:o(()=>[l(B,{style:{height:"100%"}},{default:o(()=>[l($,{style:{"max-height":"calc(100vh - 95px)"}},{default:o(()=>{var a;return[l(De,{"rules-id":(a=t(V))==null?void 0:a.ruleId},null,8,["rules-id"])]}),_:1})]),_:1})]),_:1},8,["title","modelValue"])])}}});export{je as default};
//# sourceMappingURL=index.BeXYflT4.js.map
