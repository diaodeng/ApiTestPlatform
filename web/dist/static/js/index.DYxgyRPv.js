import{a6 as R,r,J as oe,N as ne,d as i,H as q,o as _,c as P,I as d,M as T,h as a,e as t,f as o,l as re,O as ie,P as se,m as x,K as U,p as y,aD as ue,i as B,y as $,F as pe,s as de}from"./index.DgyczuKs.js";import{l as me,d as ce}from"./report.ChInQ5hx.js";import{r as _e}from"./enum.Cve1eJHF.js";import{d as fe}from"./run-detail.CuvFN77U.js";import"./env-selector.CY0X6zlK.js";import"./env.D40RgY2q.js";import"./case.DjTsuh8x.js";import"./data-template.CBoE4CJQ.js";import"./tools.DGA99u3Z.js";import"./table-variables.UtV75Lvs.js";import"./ace-editor.BsmS0mEK.js";import"./ResizeObserver.es.B1PUzC5B.js";import"./module.Ckx2ii-L.js";import"./project.Ta7DfENy.js";import"./forward.Bd-7Bd9U.js";import"./agent.Dph-1RM_.js";const ge={class:"app-container"},he=pe({name:"RunDetail"}),Be=Object.assign(he,{setup(ve){const{proxy:p}=de();p.useDict("sys_normal_disable");const{hrm_run_status:I}=p.useDict("hrm_run_status");p.useDict("sys_request_method");const{hrm_data_type:z}=p.useDict("hrm_data_type"),{qtr_case_status:F}=p.useDict("qtr_case_status");R("hrm_data_type",z),R("qtr_case_status",F);const k=r([]);r([]),r(!1);const w=r(!0),K=r(!0),C=r([]),L=r(!0),j=r(!0),b=r(0),f=r(!1),N=r(null),g=r({}),h=r(!0),E=oe({queryParams:{pageNum:1,pageSize:10,reportId:void 0,reportName:void 0,projectId:void 0,moduleId:void 0,status:void 0,onlySelf:h}}),{queryParams:s}=ne(E);function m(){w.value=!0,me(s.value).then(n=>{k.value=n.rows,b.value=n.total,w.value=!1})}function D(){s.value.pageNum=1,m()}function O(){p.resetForm("queryRef"),D()}function Q(n){C.value=n.map(e=>e.reportId),L.value=n.length!=1,j.value=!n.length}function S(n){let e=[];n.reportId?e=[n.reportId]:e=C.value,p.$modal.confirm('是否确认删除ID为"'+e+'"的数据项？').then(function(){return ce({reportIds:e})}).then(()=>{m(),p.$modal.msgSuccess("删除成功")}).catch(()=>{})}function A(n){let e=n.reportId;g.value={},g.value=n,N.value=e,f.value=!0}return m(),(n,e)=>{const H=i("el-input"),v=i("el-form-item"),J=i("el-option"),M=i("el-select"),G=i("el-checkbox"),c=i("el-button"),W=i("el-form"),u=i("el-table-column"),X=i("el-table"),Y=i("pagination"),Z=i("el-main"),ee=i("el-container"),te=i("el-dialog"),V=q("hasPermi"),le=q("loading");return _(),P("div",ge,[d(t(W,{model:a(s),ref:"queryRef",inline:!0},{default:o(()=>[t(v,{label:"报告名称",prop:"reportName"},{default:o(()=>[t(H,{modelValue:a(s).reportName,"onUpdate:modelValue":e[0]||(e[0]=l=>a(s).reportName=l),placeholder:"请输入报告名称",clearable:"",style:{width:"200px"},onKeyup:re(D,["enter"])},null,8,["modelValue"])]),_:1}),t(v,{label:"状态",prop:"status"},{default:o(()=>[t(M,{modelValue:a(s).status,"onUpdate:modelValue":e[1]||(e[1]=l=>a(s).status=l),placeholder:"报告状态",clearable:"",style:{width:"100px"}},{default:o(()=>[(_(!0),P(ie,null,se(a(I),l=>(_(),x(J,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(v,null,{default:o(()=>[t(G,{modelValue:a(h),"onUpdate:modelValue":e[2]||(e[2]=l=>U(h)?h.value=l:null),onChange:m},{default:o(()=>e[6]||(e[6]=[y("仅自己的数据")])),_:1},8,["modelValue"])]),_:1}),t(v,null,{default:o(()=>[t(c,{type:"primary",icon:"Search",onClick:D},{default:o(()=>e[7]||(e[7]=[y("搜索")])),_:1}),t(c,{type:"default",icon:"Refresh",onClick:O},{default:o(()=>e[8]||(e[8]=[y("重置")])),_:1}),d((_(),x(c,{type:"danger",icon:"Delete",onClick:S},{default:o(()=>e[9]||(e[9]=[y("删除")])),_:1})),[[V,["hrm:report:delete"]]])]),_:1})]),_:1},8,["model"]),[[T,a(K)]]),d((_(),x(X,{data:a(k),onSelectionChange:Q,border:"","table-layout":"fixed","max-height":"calc(100vh - 240px)"},{default:o(()=>[t(u,{type:"selection",width:"55",align:"center"}),t(u,{label:"ID",align:"center",prop:"reportId",width:"150"}),t(u,{label:"报告名",align:"left",prop:"reportName","min-width":"200"}),t(u,{label:"success",align:"center",prop:"success",width:"80"}),t(u,{label:"total",align:"center",prop:"total",width:"70"}),t(u,{label:"status",align:"center",prop:"status",width:"80"},{default:o(l=>[t(ue,{options:a(I),value:l.row.status},null,8,["options","value"])]),_:1}),t(u,{label:"创建人",align:"center",prop:"createBy",width:"70"}),t(u,{label:"执行开始时间",align:"center",prop:"createTime","class-name":"small-padding fixed-width",width:"150"},{default:o(l=>[B("span",null,$(n.parseTime(l.row.startAt)),1)]),_:1}),t(u,{label:"执行时长(S)",align:"center",prop:"createTime","class-name":"small-padding fixed-width",width:"100"},{default:o(l=>[B("span",null,$(l.row.testDuration),1)]),_:1}),t(u,{label:"操作",width:"80",align:"center","class-name":"small-padding fixed-width",fixed:"right"},{default:o(l=>[d(t(c,{link:"",type:"primary",icon:"View",onClick:ae=>A(l.row),title:"查看"},null,8,["onClick"]),[[V,["hrm:report:detail"]]]),d(t(c,{link:"",type:"danger",icon:"Delete",onClick:ae=>S(l.row),title:"删除"},null,8,["onClick"]),[[V,["hrm:report:delete"]]])]),_:1})]),_:1},8,["data"])),[[le,a(w)]]),d(t(Y,{total:a(b),page:a(s).pageNum,"onUpdate:page":e[3]||(e[3]=l=>a(s).pageNum=l),limit:a(s).pageSize,"onUpdate:limit":e[4]||(e[4]=l=>a(s).pageSize=l),onPagination:m},null,8,["total","page","limit"]),[[T,a(b)>0]]),t(te,{fullscreen:"",modelValue:a(f),"onUpdate:modelValue":e[5]||(e[5]=l=>U(f)?f.value=l:null),title:"报告详情【"+a(g).reportId+">>"+a(g).reportName+"】","append-to-body":"","destroy-on-close":""},{default:o(()=>[t(ee,{style:{height:"100%"}},{default:o(()=>[t(Z,{style:{"max-height":"calc(100vh - 95px)"}},{default:o(()=>[t(fe,{"report-id":a(N),"view-type":a(_e).report},null,8,["report-id","view-type"])]),_:1})]),_:1})]),_:1},8,["modelValue","title"])])}}});export{Be as default};
