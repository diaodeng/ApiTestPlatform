{"version":3,"file":"index.DRBeWlVu.js","sources":["../../../src/api/hrm/api.js","../../../src/components/hrm/common/tree-view.vue","../../../src/views/hrm/api/index.vue"],"sourcesContent":["import request from '@/utils/request'\r\n\r\n// 查询API列表\r\nexport function apiTree(query) {\r\n    return request({\r\n        url: '/hrm/api/mult/tree',\r\n        method: 'get',\r\n        params: query\r\n    })\r\n}\r\n\r\n\r\n// 查询API详细\r\nexport function getApi(apiId) {\r\n    return request({\r\n        url: '/hrm/api/detail/' + apiId,\r\n        method: 'get'\r\n    })\r\n}\r\n\r\n// 新增API\r\nexport function addApi(data) {\r\n    return request({\r\n        url: '/hrm/api',\r\n        method: 'post',\r\n        data: data\r\n    })\r\n}\r\n\r\n// 修改API\r\nexport function updateApi(data) {\r\n    return request({\r\n        url: '/hrm/api',\r\n        method: 'put',\r\n        data: data\r\n    })\r\n}\r\n\r\n// 删除API\r\nexport function delApi(apiId) {\r\n    return request({\r\n        url: '/hrm/api/' + apiId,\r\n        method: 'delete'\r\n    })\r\n}\r\n\r\n\r\n// 复制API为用例\r\nexport function copyApiAsCase(data) {\r\n    return request({\r\n        url: '/hrm/api/copyAsCase',\r\n        method: 'post',\r\n        data: data\r\n    })\r\n}","<script lang=\"ts\" setup>\r\nimport type Node from 'element-plus/es/components/tree/src/model/node'\r\nimport type {DragEvents} from 'element-plus/es/components/tree/src/model/useDragNode'\r\nimport type {\r\n  AllowDropType,\r\n  NodeDropType,\r\n} from 'element-plus/es/components/tree/src/tree.type'\r\nimport {CirclePlusFilled, Folder, RemoveFilled, Tickets} from \"@element-plus/icons-vue\";\r\nimport EditLabelText from \"@/components/hrm/common/edit-label-text.vue\";\r\nimport ContextMenu from \"@/components/hrm/common/context-menu.vue\";\r\nimport {HrmDataTypeEnum, CaseStepTypeEnum} from \"@/components/hrm/enum\";\r\nimport {ElMessage, ElMessageBox} from \"element-plus\";\r\nimport {delApi} from \"@/api/hrm/api.js\";\r\nimport {randomNumber, randomString} from \"@/utils/tools.js\";\r\n\r\n\r\nconst dataSource = defineModel(\"dataSource\");\r\nconst filterText = defineModel(\"filterText\");\r\nconst treeRef = defineModel(\"treeRef\");\r\nconst contextMenuSelectNode = ref({e: null, data: null, node: null, nodeRef: null});\r\nconst contextMenu = reactive({\r\n  show: false,\r\n  x: 0,\r\n  y: 0,\r\n  data: [\r\n    {\r\n      title: '新增文件夹',\r\n      apiType: CaseStepTypeEnum.folder,\r\n      icon: 'Menu'\r\n    },\r\n    {\r\n      title: '新增http请求',\r\n      apiType: CaseStepTypeEnum.http,\r\n      icon: 'Menu',\r\n      divided: true\r\n    },\r\n    {\r\n      title: '新增websocket请求',\r\n      apiType: CaseStepTypeEnum.websocket,\r\n      icon: 'Menu',\r\n      divided: true\r\n    },\r\n    // {\r\n    //   title: '1-3 菜单',\r\n    //   icon: 'https://element-plus.org/images/element-plus-logo.svg',\r\n    //   children: [\r\n    //     {title: '1-3-1 菜单', remark: 'Ctrl+A'},\r\n    //     {title: '1-3-2 菜单', disabled: true},\r\n    //     {\r\n    //       title: '1-3-3 菜单',\r\n    //       className: 'custom-red-menu-item'\r\n    //     }\r\n    //   ],\r\n    //   disabled: true\r\n    // }\r\n  ],\r\n  onSelect: (item: any) => {\r\n    append(contextMenuSelectNode.value.data, item.apiType);\r\n    // ElMessage.success('选中了' + item.title)\r\n  }\r\n})\r\n\r\nconst emit = defineEmits([\"nodeDbClick\", \"delNode\", \"filter\", \"addNode\", \"moveNode\", \"editNode\", \"currentNodeChange\"]);\r\n\r\ninterface Tree {\r\n  apiId: bigint,\r\n  type: number,\r\n  apiType: number,\r\n  name: string,\r\n  parentId: bigint,\r\n  children?: Tree[],\r\n  isParent: boolean\r\n}\r\n\r\nlet id = 1000;\r\n\r\nconst handleNodeClick = (data: Tree, node, treeNode, event) => {\r\n  // console.log(data)\r\n  // console.log(node)\r\n  // console.log(treeNode)\r\n  // console.log(event)\r\n  // if (event && event.target) {\r\n  //\r\n  //   console.log(event.target)\r\n  // }\r\n}\r\n\r\n/*\r\n* 右键\r\n* */\r\nfunction handleNodeRightClick(event, data, node, nodeRef) {\r\n  // console.log(event)\r\n  // console.log(data)\r\n  // console.log(node)\r\n  // console.log(nodeRef.value)\r\n  event.preventDefault();\r\n  contextMenuSelectNode.value.e = event;\r\n  contextMenuSelectNode.value.data = data;\r\n  contextMenuSelectNode.value.node = node;\r\n  contextMenuSelectNode.value.nodeRef = nodeRef;\r\n  contextMenu.x = event.clientX\r\n  contextMenu.y = event.clientY\r\n  contextMenu.show = true;\r\n\r\n  // emit(\"nodeDbClick\", event, data, node, nodeRef)\r\n\r\n}\r\n\r\n// const dataSource = ref<Tree[]>([\r\n//   {\r\n//     id: 1,\r\n//     name: 'Level one 1',\r\n//     children: [\r\n//       {\r\n//         id: 2,\r\n//         name: 'Level two 1-1',\r\n//         children: [\r\n//           {\r\n//             id: 3,\r\n//             name: 'Level three 1-1-1',\r\n//           },\r\n//         ],\r\n//       },\r\n//     ],\r\n//   },\r\n//   {\r\n//     id: 4,\r\n//     name: 'Level one 2',\r\n//     children: [\r\n//       {\r\n//         id: 5,\r\n//         name: 'Level two 2-1',\r\n//         children: [\r\n//           {\r\n//             id: 6,\r\n//             name: 'Level three 2-1-1',\r\n//           },\r\n//         ],\r\n//       },\r\n//       {\r\n//         id: 7,\r\n//         name: 'Level two 2-2',\r\n//         children: [\r\n//           {\r\n//             id: 8,\r\n//             name: 'Level three 2-2-1',\r\n//           },\r\n//         ],\r\n//       },\r\n//     ],\r\n//   },\r\n//   {\r\n//     id: 9,\r\n//     name: 'Level one 3',\r\n//     children: [\r\n//       {\r\n//         id: 10,\r\n//         name: 'Level two 3-1',\r\n//         children: [\r\n//           {\r\n//             id: 11,\r\n//             name: 'Level three 3-1-1',\r\n//           },\r\n//         ],\r\n//       },\r\n//       {\r\n//         id: 12,\r\n//         name: 'Level two 3-2',\r\n//         children: [\r\n//           {\r\n//             id: 13,\r\n//             name: 'Level three 3-2-1',\r\n//           },\r\n//         ],\r\n//       },\r\n//     ],\r\n//   },\r\n// ])\r\n\r\nconst defaultProps = {\r\n  key: 'apiId',\r\n  children: 'children',\r\n  label: 'name',\r\n  isLeaf: \"isParent\",\r\n  parentId: \"parentId\"\r\n}\r\n\r\nconst append = (data: Tree, type) => {\r\n  if (!data.isParent) {\r\n    ElMessage.warning(\"只能在文件夹中新增节点\");\r\n    return;\r\n  }\r\n\r\n  const newStepId = randomString(10);\r\n  const newStepName = \"新增API\";\r\n  const newChild = {\r\n    id: null,\r\n    name: newStepName,\r\n    children: [],\r\n    isNew: true,\r\n    apiId: newStepId,\r\n    isParent: type === CaseStepTypeEnum.folder,\r\n    parentId: data.apiId,\r\n    type: type !== CaseStepTypeEnum.folder ? HrmDataTypeEnum.api : HrmDataTypeEnum.folder,\r\n    apiType: type,\r\n    edit: false\r\n  }\r\n  if (!data.children) {\r\n    data.children = []\r\n  }\r\n  data.children.splice(0, 0, newChild)\r\n  emit('addNode', type, newChild, data);\r\n  // dataSource.value = [...dataSource.value]\r\n}\r\n\r\nconst remove = (event, node: Node, data: Tree) => {\r\n  ElMessageBox.confirm(\"确定删除吗？\\n对应目录下的所有内容都将被删除\", \"提示\", {\r\n    confirmButtonText: \"确定\",\r\n    cancelButtonText: \"取消\",\r\n    type: \"warning\"\r\n  }).then(() => {\r\n    console.log(data)\r\n    delApi(data.apiId).then(res => {\r\n      // console.log(res)\r\n      const parent = node.parent;\r\n      const children: Tree[] = parent.data.children || parent.data;\r\n      const index = children.findIndex((d) => d.apiId === data.apiId);\r\n      children.splice(index, 1);\r\n      // dataSource.value = [...dataSource.value]\r\n      ElMessage.success(\"删除成功\");\r\n      emit('delNode', data);\r\n    }).catch(() => {\r\n    });\r\n\r\n  }).catch(() => {\r\n  });\r\n}\r\n\r\nconst handleDbClick = (event, node: Node, data: Tree) => {\r\n  emit('nodeDbClick', event, node, data);\r\n}\r\n\r\n\r\nfunction treeFilter(value, data, node) {\r\n  if (!value) {\r\n    return true\r\n  }\r\n  if (data.name.indexOf(value) !== -1 || data.title.indexOf(value) !== -1) {\r\n    return true;\r\n  } else {\r\n    return false;\r\n  }\r\n}\r\n\r\n\r\nconst handleDragStart = (node: Node, ev: DragEvents) => {\r\n  // console.log('drag start', node)\r\n}\r\nconst handleDragEnter = (\r\n    draggingNode: Node,\r\n    dropNode: Node,\r\n    ev: DragEvents\r\n) => {\r\n  // console.log('tree drag enter:', dropNode.label)\r\n}\r\nconst handleDragLeave = (\r\n    draggingNode: Node,\r\n    dropNode: Node,\r\n    ev: DragEvents\r\n) => {\r\n  // console.log('tree drag leave:', dropNode.label)\r\n}\r\nconst handleDragOver = (draggingNode: Node, dropNode: Node, ev: DragEvents) => {\r\n  console.log('tree drag over:', dropNode.label)\r\n}\r\nconst handleDragEnd = (\r\n    draggingNode: Node,\r\n    dropNode: Node,\r\n    dropType: NodeDropType,\r\n    ev: DragEvents\r\n) => {\r\n  if (dropType === \"none\") {\r\n    return false;\r\n  }\r\n  // console.log('tree drag end:', dropNode && dropNode.label, dropType)\r\n}\r\nconst handleDrop = (\r\n    draggingNode: Node,\r\n    dropNode: Node,\r\n    dropType: NodeDropType,\r\n    ev: DragEvents\r\n) => {\r\n  let parentId = null;\r\n  let nodeId = draggingNode.data.apiId;\r\n  let index = 0;\r\n  if (dropType === 'inner') {\r\n    parentId = dropNode.data.apiId;\r\n  } else if (dropType === 'after') {\r\n    parentId = dropNode.parent.data.apiId;\r\n  } else if (dropType === 'before') {\r\n    parentId = dropNode.parent.data.apiId;\r\n  }\r\n  if (parentId === nodeId) {\r\n    return\r\n  }\r\n  emit('moveNode', parentId, nodeId, index);\r\n}\r\n\r\nconst allowDrop = (draggingNode: Node, dropNode: Node, type: AllowDropType) => {\r\n  if ((!dropNode.data.isParent && type === 'inner') || (dropNode.data.apiId === draggingNode.data.apiId)) {\r\n    return false;\r\n  } else {\r\n    return true;\r\n  }\r\n}\r\nconst allowDrag = (draggingNode: Node) => {\r\n  return !draggingNode.data.label.includes('Level three 3-1-1')\r\n}\r\n\r\nconst handleEditNodeName = (evt, data, node) => {\r\n  emit('editNode', evt, data, node);\r\n}\r\n\r\nconst handleCurrentNodeChange = (nodeData, node) => {\r\n  emit('currentNodeChange', nodeData, node);\r\n}\r\n\r\n</script>\r\n\r\n<template>\r\n  <ContextMenu v-model:visible=\"contextMenu.show\"\r\n               :x=\"contextMenu.x\"\r\n               :y=\"contextMenu.y\"\r\n               @select=\"contextMenu.onSelect\"\r\n               :menus=\"contextMenu.data\"\r\n\r\n  ></ContextMenu>\r\n  <el-tree\r\n      style=\"max-width: 600px\"\r\n      :data=\"dataSource\"\r\n      highlight-current\r\n      :props=\"defaultProps\"\r\n      node-key=\"apiId\"\r\n      :expand-on-click-node=\"false\"\r\n      ref=\"treeRef\"\r\n      :filter-node-method=\"treeFilter\"\r\n      @node-contextmenu=\"handleNodeRightClick\"\r\n      draggable\r\n      :allow-drop=\"allowDrop\"\r\n      @node-drag-start=\"handleDragStart\"\r\n      @node-drag-enter=\"handleDragEnter\"\r\n      @node-drag-leave=\"handleDragLeave\"\r\n      @node-drag-over=\"handleDragOver\"\r\n      @node-drag-end=\"handleDragEnd\"\r\n      @node-drop=\"handleDrop\"\r\n      @current-change=\"handleCurrentNodeChange\"\r\n\r\n  >\r\n    <template #default=\"{ node, data }\">\r\n      <span @dblclick=\"(event) => {handleDbClick(event, node, data)}\"\r\n            @click=\"(event)=>{handleNodeClick(data, node, undefined, event)}\"\r\n            @mouseenter=\"(event)=>{node.data.edit=true}\"\r\n            @mouseleave=\"(event)=>{node.data.edit=false}\"\r\n      >\r\n          <el-icon v-if=\"data.apiType===CaseStepTypeEnum.folder\"><folder/></el-icon>\r\n          <el-button v-else-if=\"data.apiType===CaseStepTypeEnum.http\" type=\"success\" link>RQ</el-button>\r\n          <el-button v-else-if=\"data.apiType===CaseStepTypeEnum.websocket\" type=\"primary\" link>WS</el-button>\r\n          <el-button v-else-if=\"data.apiType===CaseStepTypeEnum.webui\" type=\"warning\" link>WB</el-button>\r\n          <span><edit-label-text v-model:content=\"data.name\"\r\n                                 v-model:show-edite=\"node.data.edit\"\r\n                                 @edite=\"handleEditNodeName($event, data, node);\"\r\n          ></edit-label-text></span>\r\n          <span v-if=\"node.data.edit\">\r\n<!--            <el-icon color=\"blue\"><edit></edit></el-icon>-->\r\n          <el-icon color=\"green\" @click.stop=\"handleNodeRightClick($event, data, node, undefined);\" v-if=\"data.apiType===CaseStepTypeEnum.folder\">\r\n            <circle-plus-filled></circle-plus-filled>\r\n          </el-icon>\r\n            <!--            <RequestTypeDropdown @type-selected=\"append\" :index-key=\"data\"></RequestTypeDropdown>-->\r\n            <el-icon color=\"red\" @click.stop=\"remove($event, node, data)\"><remove-filled></remove-filled></el-icon>\r\n          </span>\r\n        </span>\r\n\r\n    </template>\r\n\r\n  </el-tree>\r\n</template>\r\n\r\n<style scoped lang=\"scss\">\r\n\r\n</style>","<script setup name=\"Api\">\r\nimport {ElMessage} from \"element-plus\";\r\nimport SplitWindow from \"@/components/hrm/common/split-window.vue\";\r\nimport TreeView from \"@/components/hrm/common/tree-view.vue\";\r\nimport {addApi, apiTree, copyApiAsCase, getApi, updateApi} from \"@/api/hrm/api.js\";\r\nimport {allConfig} from \"@/api/hrm/config.js\";\r\n\r\nimport {initStepData} from \"@/components/hrm/data-template.js\";\r\nimport {randomString} from \"@/utils/tools.js\";\r\nimport {CaseStepTypeEnum, HrmDataTypeEnum, runDetailViewTypeEnum, RunTypeEnum} from \"@/components/hrm/enum.js\";\r\nimport StepRequest from \"@/components/hrm/case/step-request.vue\";\r\nimport StepWebsocket from \"@/components/hrm/case/step-websocket.vue\";\r\nimport {getApiFormDataByType} from \"@/components/hrm/case/case-utils.js\";\r\nimport RunDetail from \"@/components/hrm/common/run/run-detail.vue\";\r\nimport DebugComponent from \"@/components/hrm/common/debug_component.vue\";\r\n\r\n\r\nconst {proxy} = getCurrentInstance();\r\nconst {sys_normal_disable} = proxy.useDict(\"sys_normal_disable\");\r\nconst {hrm_data_type} = proxy.useDict(\"hrm_data_type\");\r\n\r\nprovide(\"hrm_data_type\", hrm_data_type);\r\nprovide('sys_normal_disable', sys_normal_disable);\r\n\r\nconst treeDataSource = ref([]);\r\nconst hrm_config_list = ref({});\r\n\r\nconst folderForm = ref({parentId: null, name: null})\r\nconst apiTabsData = ref([]);\r\nconst currentApiData = ref(apiTabsData.value[0] || null);\r\nconst currentTab = ref(0);  // 当前选中的tab，是apiId\r\nconst viewShow = ref({\r\n  runHistoryDialog: false\r\n});\r\nconst loadingApi = ref(false);\r\nconst onlySelf = ref(true);\r\nconst loading = ref({\r\n  page: false,\r\n  loadApiTree: false,\r\n  loadApiInfo: false,\r\n  saveApi: false,\r\n  debugApi: false,\r\n  preSaveDialog: false,\r\n  preSaveFolderDialog: false,\r\n  filter: false\r\n});\r\n\r\nconst treeFilterText = ref(\"\");\r\nconst treeRef = ref(null);\r\nconst currentSelectParentNode = ref();  // 当前可以使用的父节点\r\n\r\n\r\nonMounted(() => {\r\n  getApiTree();\r\n  allConfig().then(response => {\r\n    hrm_config_list.value = response.data;\r\n  });\r\n});\r\n\r\nconst debugFromCaseData = ref(null);\r\n\r\nwatch(() => currentApiData.value, (newData) => {\r\n  const apiData = toRaw(newData);\r\n\r\n  const data = apiData ? {\r\n    request: apiData.requestInfo,\r\n    type: apiData.type,\r\n    name: apiData.name,\r\n    caseId: apiData.apiId,\r\n  } : {};\r\n  debugFromCaseData.value = data;\r\n});\r\n\r\nprovide(\"hrm_case_config_list\", hrm_config_list);\r\n\r\n\r\nfunction addApiStep() {\r\n  let tmpStepData = JSON.parse(JSON.stringify(initStepData));\r\n  tmpStepData.step_id = randomString(10);\r\n  currentApiData.value.requestInfo.teststeps.push(tmpStepData);\r\n}\r\n\r\nfunction getApiInfo(apiId) {\r\n  getApi(apiId).then(res => {\r\n    const data = ref(res.data);\r\n    apiTabsData.value.push(data);\r\n    currentApiData.value = toRef(data);\r\n  })\r\n}\r\n\r\nfunction saveApiInfo(type) {\r\n\r\n  loading.value.saveApi = true;\r\n  let data = toRaw(currentApiData.value);\r\n  data = structuredClone(data);\r\n\r\n  data.type = HrmDataTypeEnum.api\r\n\r\n  data.requestInfo.teststeps.forEach((step) => {\r\n    step.result = null;\r\n  });\r\n\r\n  if (data.id && data.apiId && !data.isNew) {\r\n    if (type === 'copy2case') {\r\n      copyApiAsCase(data).then(res => {\r\n        ElMessage({message: \"API成功另存为CASE\", type: \"success\"});\r\n      }).catch(error => {\r\n        ElMessage.error(\"API另存为CASE失败\");\r\n      }).finally(() => {\r\n        loading.value.saveApi = false;\r\n        loading.value.preSaveDialog = false;\r\n      })\r\n    } else {\r\n      updateApi(data).then(res => {\r\n        ElMessage({message: \"API保存成功\", type: \"success\"});\r\n        apiSaveSuccess(res, data.apiId);\r\n      }).catch(error => {\r\n        ElMessage({message: \"API保存失败\", type: \"success\"});\r\n      }).finally(() => {\r\n        loading.value.saveApi = false;\r\n        loading.value.preSaveDialog = false;\r\n      })\r\n    }\r\n\r\n  } else {\r\n    const oldApiId = data.apiId;\r\n    delete data.isNew;\r\n    delete data.apiId;\r\n    delete data.id;\r\n    addApi(data).then(res => {\r\n      ElMessage({message: \"API保存成功\", type: \"success\"});\r\n      apiSaveSuccess(res, oldApiId);\r\n    }).finally(() => {\r\n      loading.value.saveApi = false;\r\n      loading.value.preSaveDialog = false;\r\n    });\r\n  }\r\n\r\n}\r\n\r\n/*\r\n* 保存成功后更新apiTabsData和treeDataSource、当前选中的tabid\r\n* */\r\nfunction apiSaveSuccess(res, oldApiId) {\r\n  if (res && res.data && res.data.apiId) {\r\n    currentApiData.value.apiId = res.data.apiId;\r\n  }\r\n  let response = res;\r\n  if (response) {\r\n    let treeNode = treeRef.value.getNode(oldApiId);\r\n    treeNode.data.apiId = response.data.apiId;\r\n    treeNode.data.name = response.data.name;\r\n    treeNode.data.isNew = false;\r\n\r\n    treeNode.apiId = response.data.apiId;\r\n    treeNode.name = response.data.name;\r\n\r\n    apiTabsData.value.forEach(apiInfo => {\r\n      if (apiInfo.apiId === oldApiId) {\r\n        apiInfo.apiId = response.data.apiId;\r\n        currentTab.value = response.data.apiId;\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\nfunction saveFolderInfo() {\r\n  let parentId = null;\r\n  if (currentSelectParentNode.value) {\r\n    parentId = currentSelectParentNode.apiId;\r\n    parentId = treeRef.value.getNode(parentId) ? parentId : null\r\n  }\r\n  loading.value.preSaveFolderDialog = true;\r\n  let data = folderForm.value;\r\n  data.type = HrmDataTypeEnum.folder\r\n  data.apiType = CaseStepTypeEnum.folder\r\n  data.parentId = parentId;\r\n  addApi(data).then(res => {\r\n    if (!parentId) {\r\n      treeDataSource.value.splice(0, 0, res.data);\r\n    } else {\r\n      let parentNode = treeRef.value.getNode(parentId);\r\n      parentNode.data.children.splice(0, 0, res.data);\r\n    }\r\n\r\n    ElMessage({message: \"Folder保存成功\", type: \"success\"});\r\n  }).finally(() => {\r\n    loading.value.preSaveFolderDialog = false;\r\n  })\r\n}\r\n\r\nfunction getApiTree() {\r\n  treeRef.value.setCurrentKey(null, false);\r\n  loadingApi.value = true;\r\n  apiTree({onlySelf: onlySelf.value}).then(res => {\r\n    treeDataSource.value = res.data;\r\n  }).finally(() => {\r\n    loadingApi.value = false;\r\n  })\r\n}\r\n\r\nfunction nodeDbClick(event, node, data) {\r\n\r\n  if (node.data.isParent) {\r\n    node.expanded = !node.expanded;\r\n  } else {\r\n    const nodeId = node.data.apiId;\r\n    const nodeTabIndex = apiTabsData.value.findIndex(dict => dict.apiId === nodeId);\r\n    if (nodeTabIndex !== -1) {\r\n      currentTab.value = nodeId;\r\n      currentApiData.value = apiTabsData.value[nodeTabIndex];\r\n      loadingApi.value = false;\r\n    } else {\r\n      loadingApi.value = true;\r\n\r\n      if (node.data.isNew) {\r\n        let emptyData = getApiFormDataByType(node.data.apiType);\r\n        // currentApiData.value.apiId = nodeId;\r\n        emptyData.isNew = true;\r\n        emptyData.type = node.data.type;\r\n        emptyData.apiType = node.data.apiType;\r\n        emptyData.requestInfo.name = node.name;\r\n        emptyData.parentId = node.data.parentId;\r\n        emptyData.apiId = node.data.apiId;\r\n        apiTabsData.value.push(emptyData);\r\n\r\n        currentApiData.value = apiTabsData.value[apiTabsData.value.length - 1];\r\n        currentTab.value = emptyData.apiId;\r\n\r\n        if (apiTabsData.value[0].isEmpty) {\r\n          apiTabsData.value.splice(0, 1);\r\n        }\r\n\r\n        loadingApi.value = false;\r\n        return;\r\n      }\r\n\r\n      getApi(node.data.apiId).then(res => {\r\n        // const data = ref(res.data);\r\n        apiTabsData.value.push(res.data);\r\n        currentApiData.value = apiTabsData.value[apiTabsData.value.length - 1];\r\n        currentTab.value = res.data.apiId;\r\n\r\n        if (apiTabsData.value[0].isEmpty) {\r\n          apiTabsData.value.splice(0, 1);\r\n        }\r\n        console.log(\"当前tab：\" + currentTab.value)\r\n      }).catch(() => {\r\n\r\n      }).finally(() => {\r\n        loadingApi.value = false\r\n      })\r\n\r\n    }\r\n  }\r\n\r\n}\r\n\r\n\r\nfunction delTreeNode(data) {\r\n  const dataIndex = apiTabsData.value.findIndex(dict => dict.apiId === data.apiId)\r\n  if (dataIndex !== -1) {\r\n    apiTabsData.value.splice(dataIndex, 1);\r\n  }\r\n}\r\n\r\n// currentApiData.isEmpty = true;\r\n\r\nfunction delTab(event, tabId) {\r\n  const currentTabIndex = apiTabsData.value.findIndex(dict => dict.apiId === tabId);\r\n  if (currentTabIndex === -1) {\r\n    return;\r\n  }\r\n  if (apiTabsData.value.length === 1) {\r\n    currentApiData.value = false;\r\n\r\n    // apiTabsData.value.push(JSON.parse(JSON.stringify(initApiFormData)));\r\n    // currentApiData = apiTabsData.value[1];\r\n    //\r\n    // currentTab.value = currentApiData.apiId;\r\n\r\n  } else if (apiTabsData.value.length - 1 === currentTabIndex) {\r\n    currentApiData.value = apiTabsData.value[currentTabIndex - 1];\r\n    currentTab.value = currentApiData.value.apiId;\r\n  } else {\r\n    currentApiData.value = apiTabsData.value[currentTabIndex + 1];\r\n    currentTab.value = currentApiData.value.apiId;\r\n  }\r\n  apiTabsData.value.splice(currentTabIndex, 1);\r\n  // apiTabsData.value.splice(tabId, 1);\r\n  console.log(\"删除了tab:\" + tabId)\r\n}\r\n\r\nfunction clickTab(tab, event) {\r\n  // console.log(\"点击了tab:\" + tab.paneName + \" \" + \"当前tab：\" + currentTab.value)\r\n}\r\n\r\nfunction activeTabChange(tabName) {\r\n  const currentTabIndex = apiTabsData.value.findIndex(dict => dict.apiId === tabName);\r\n  currentApiData.value = apiTabsData.value[currentTabIndex];\r\n  currentTab.value = tabName;\r\n  treeRef.value.setCurrentKey(tabName);\r\n  // console.log(\"tab切换了:\" + tabName + \"  \" + \"当前tab：\" + currentTab.value)\r\n}\r\n\r\nfunction debug(response) {\r\n  for (const step_result_key in response.data) {\r\n    currentApiData.value.requestInfo.teststeps.find(dict => dict['step_id'] === step_result_key).result = response.data[step_result_key]\r\n  }\r\n\r\n}\r\n\r\nfunction apiTreeFilter() {\r\n  loading.value.filter = true;\r\n  treeRef.value.filter(treeFilterText.value);\r\n  loading.value.filter = false;\r\n}\r\n\r\nconst handelMoveNode = (parentId, nodeId, index) => {\r\n  updateApi({parentId: parentId, apiId: nodeId}).then(res => {\r\n    ElMessage.success(\"移动节点成功\");\r\n  }).catch(err => {\r\n  })\r\n}\r\n\r\nconst handleEditNode = (evt, data, node) => {\r\n  updateApi({name: data.name, apiId: data.apiId}).then(res => {\r\n    ElMessage.success(\"修改成功\");\r\n  }).catch(err => {\r\n  })\r\n}\r\n\r\nconst handleAddNode = (type, newData, parentNodeData) => {\r\n  if (type !== CaseStepTypeEnum.folder) {\r\n    return;\r\n  }\r\n  let dataType = type === CaseStepTypeEnum.folder ? HrmDataTypeEnum.folder : HrmDataTypeEnum.api;\r\n  addApi({type: dataType, apiType: type, name: newData.name, parentId: parentNodeData.apiId}).then(res => {\r\n    ElMessage.success(\"文件夹【\" + newData.name + \"】新增成功\");\r\n  }).catch(err => {\r\n  });\r\n\r\n}\r\n\r\nconst copyAsCase = () => {\r\n  copyApi({apiId: data.apiId}).then(res => {\r\n    ElMessage.success(\"复制成功\");\r\n  }).catch(err => {\r\n  });\r\n}\r\n\r\nfunction showRunHistory() {\r\n  if (!currentApiData.value) {\r\n    ElMessage.warning(\"请先选择一个接口\");\r\n    return;\r\n  }\r\n  viewShow.value.runHistoryDialog = true;\r\n}\r\n\r\nfunction handleNodeChange(nodeData, node) {\r\n  if (!nodeData) {\r\n    return;\r\n  }\r\n  if (nodeData && nodeData.type === HrmDataTypeEnum.folder) {\r\n    return;\r\n  }\r\n  const currentIndex = apiTabsData.value.findIndex(dict => dict.apiId === nodeData.apiId)\r\n  if (currentIndex === -1) {\r\n    return;\r\n  }\r\n  currentTab.value = nodeData.apiId;\r\n  activeTabChange(nodeData.apiId);\r\n\r\n}\r\n\r\nfunction showFolderDialog() {\r\n  loading.value.preSaveFolderDialog = true;\r\n  let currentNodeObj = treeRef.value.getCurrentNode();\r\n  if (currentNodeObj && !currentNodeObj.isParent) {\r\n    currentNodeObj = treeRef.value.getNode(currentNodeObj.patentId)\r\n  }\r\n  if (currentNodeObj) {\r\n    currentSelectParentNode.value = currentNodeObj;\r\n  } else {\r\n    currentSelectParentNode.value = null;\r\n  }\r\n\r\n}\r\n\r\n\r\n</script>\r\n\r\n<template>\r\n  <div class=\"app-container\" v-loading=\"loadingApi\" style=\"height: 100%\">\r\n    <el-row :gutter=\"10\">\r\n      <el-button @click=\"getApiTree\" icon=\"RefreshRight\"></el-button>\r\n      <el-button @click=\"showFolderDialog\" type=\"primary\">新增文件夹</el-button>\r\n      <span style=\"flex-grow: 1\"></span>\r\n      <el-dropdown split-button type=\"primary\" @click=\"loading.preSaveDialog = true\"\r\n                   v-loading=\"loading.saveApi\" :disabled=\"loading.saveApi\">\r\n        保存\r\n        <template #dropdown>\r\n          <el-dropdown-menu>\r\n            <el-dropdown-item @click=\"saveApiInfo('copy2case');\">另存为用例</el-dropdown-item>\r\n            <el-dropdown-item disabled @click=\"console.log('复制API')\">复制</el-dropdown-item>\r\n            <el-dropdown-item @click=\"showRunHistory\">执行历史</el-dropdown-item>\r\n          </el-dropdown-menu>\r\n        </template>\r\n      </el-dropdown>\r\n\r\n      <DebugComponent :run-type=\"RunTypeEnum.api\"\r\n                      :case-data=\"debugFromCaseData\"\r\n                      @debug-run=\"debug\"\r\n      ></DebugComponent>\r\n\r\n    </el-row>\r\n\r\n    <el-container>\r\n      <split-window left-width=\"250px\" window-height=\"calc(100vh - 156px)\">\r\n        <template v-slot:left>\r\n          <el-row>\r\n            <!--                <el-icon><setting></setting></el-icon>-->\r\n            <el-checkbox v-model=\"onlySelf\" @change=\"getApiTree\">仅自己的数据</el-checkbox>\r\n          </el-row>\r\n          <el-row>\r\n            <el-col :span=\"24\">\r\n              <el-input v-model=\"treeFilterText\" clearable placeholder=\"输入名称或者接口或者path\">\r\n                <template #suffix>\r\n                  <el-button icon=\"Search\"\r\n                             type=\"info\"\r\n                             @click=\"apiTreeFilter\"\r\n                             :loading=\"loading.filter\"\r\n                             :disabled=\"loading.filter\" link></el-button>\r\n                  <!--                  <el-icon @click=\"apiTreeFilter\"><search></search></el-icon>-->\r\n                </template>\r\n              </el-input>\r\n            </el-col>\r\n\r\n          </el-row>\r\n          <el-scrollbar height=\"calc(100% - 70px)\">\r\n            <div style=\"display: flex\">\r\n              <TreeView v-model:data-source=\"treeDataSource\"\r\n                        @node-db-click=\"nodeDbClick\"\r\n                        v-model:filter-text=\"treeFilterText\"\r\n                        v-model:tree-ref=\"treeRef\"\r\n                        @del-node=\"delTreeNode\"\r\n                        @move-node=\"handelMoveNode\"\r\n                        @edit-node=\"handleEditNode\"\r\n                        @add-node=\"handleAddNode\"\r\n                        @current-node-change=\"handleNodeChange\"\r\n              ></TreeView>\r\n            </div>\r\n          </el-scrollbar>\r\n\r\n        </template>\r\n        <template v-slot:right>\r\n          <el-container style=\"display:flex;flex-direction: column;height: 100%; padding-left: 5px;\">\r\n            <el-tabs type=\"card\"\r\n                     v-model=\"currentTab\"\r\n                     @tab-click=\"clickTab\"\r\n                     @tab-change=\"activeTabChange\"\r\n            >\r\n              <el-tab-pane v-for=\"(apiData, index) in apiTabsData\" :label=\"apiData.name\"\r\n                           :key=\"apiData.requestInfo.teststeps[0].step_id\" :name=\"apiData.apiId\">\r\n                <template #label size=\"small\">\r\n                  <el-badge is-dot :hidden=\"!apiData.modify\">\r\n                    <span style=\"margin: 0px; padding: 0px\">\r\n                      <span @dblclick=\"activeTabChange(apiData.apiId);\">{{ apiData.name }}</span>\r\n                      <el-button @click.stop=\"(event) => {delTab(event, apiData.apiId)}\" icon=\"Close\" link></el-button>\r\n                    </span>\r\n                  </el-badge>\r\n                </template>\r\n              </el-tab-pane>\r\n            </el-tabs>\r\n            <template v-if=\"currentApiData\">\r\n              <div v-if=\"currentApiData\" style=\"flex-grow: 1;display: flex;flex-direction: column;\">\r\n                <template v-if=\"currentApiData.requestInfo.teststeps[0].step_type === CaseStepTypeEnum.http\">\r\n                  <StepRequest v-model:step-detail-data=\"currentApiData.requestInfo.teststeps[0]\"\r\n                               request-container-height=\"calc(100vh - 165px)\"\r\n                  ></StepRequest>\r\n                </template>\r\n                <template v-if=\"currentApiData.requestInfo.teststeps[0].step_type === CaseStepTypeEnum.websocket\">\r\n                  <StepWebsocket v-model:step-detail-data=\"currentApiData.requestInfo.teststeps[0]\"\r\n                                 step-container-height=\"calc(100vh - 245px)\"></StepWebsocket>\r\n                </template>\r\n              </div>\r\n            </template>\r\n            <template v-else>\r\n              <el-text type=\"warning\" size=\"large\">请选择api或者新增api</el-text>\r\n            </template>\r\n\r\n\r\n          </el-container>\r\n\r\n        </template>\r\n      </split-window>\r\n    </el-container>\r\n    <el-dialog :title=\"currentApiData?.name\" @close=\"loading.preSaveDialog = false\" v-model=\"loading.preSaveDialog\">\r\n      <el-main>\r\n        <el-input v-model=\"currentApiData.name\" placeholder=\"请输入名称\">\r\n          <template #prepend>\r\n            <el-text>API名称:</el-text>\r\n          </template>\r\n        </el-input>\r\n      </el-main>\r\n      <el-button type=\"info\" @click=\"loading.preSaveDialog = false\">取消</el-button>\r\n      <el-button type=\"primary\" @click=\"saveApiInfo\" :disabled=\"loading.saveApi\" :loading=\"loading.saveApi\">保存\r\n      </el-button>\r\n    </el-dialog>\r\n\r\n    <el-dialog :title=\"folderForm.name\" @close=\"loading.preSaveFolderDialog = false\"\r\n               v-model=\"loading.preSaveFolderDialog\">\r\n      <el-main>\r\n        <el-input :model-value=\"currentSelectParentNode?currentSelectParentNode.name:'根目录'\"\r\n                  placeholder=\"请输入文件夹名称\" disabled>\r\n          <template #prepend>\r\n            <el-text>父级目录:</el-text>\r\n          </template>\r\n        </el-input>\r\n        <el-input v-model=\"folderForm.name\" placeholder=\"请输入文件夹名称\" style=\"padding-top: 5px\">\r\n          <template #prepend>\r\n            <el-text>文件夹名称:</el-text>\r\n          </template>\r\n        </el-input>\r\n      </el-main>\r\n      <el-button type=\"info\" @click=\"loading.preSaveFolderDialog = false\">取消</el-button>\r\n      <el-button type=\"primary\" @click=\"saveFolderInfo\" :disabled=\"loading.saveApi\">保存</el-button>\r\n    </el-dialog>\r\n\r\n    <el-dialog fullscreen :title=\"'【' + currentApiData?.apiId + '】' + currentApiData?.name\"\r\n               v-model=\"viewShow.runHistoryDialog\" append-to-body destroy-on-close>\r\n      <el-container style=\"height: 100%\">\r\n        <!--          <el-header height=\"20px\" border=\"2px\" style=\"border-bottom-color: #97a8be;text-align: right\">-->\r\n        <!--          </el-header>-->\r\n        <el-main style=\"max-height: calc(100vh - 95px);\">\r\n          <RunDetail :run-id=\"currentApiData.apiId\" :view-type=\"runDetailViewTypeEnum.api\"></RunDetail>\r\n        </el-main>\r\n      </el-container>\r\n    </el-dialog>\r\n  </div>\r\n\r\n</template>\r\n\r\n<style scoped lang=\"scss\">\r\n\r\n</style>\r\n"],"names":["apiTree","query","request","getApi","apiId","addApi","data","updateApi","delApi","copyApiAsCase","dataSource","_useModel","__props","treeRef","contextMenuSelectNode","ref","contextMenu","reactive","CaseStepTypeEnum","item","append","emit","__emit","handleNodeClick","node","treeNode","event","handleNodeRightClick","nodeRef","defaultProps","type","ElMessage","newStepId","randomString","newChild","HrmDataTypeEnum","remove","ElMessageBox","res","parent","children","index","d","handleDbClick","treeFilter","value","handleDragStart","ev","handleDragEnter","draggingNode","dropNode","handleDragLeave","handleDragOver","handleDragEnd","dropType","handleDrop","parentId","nodeId","allowDrop","handleEditNodeName","evt","handleCurrentNodeChange","nodeData","proxy","getCurrentInstance","sys_normal_disable","hrm_data_type","provide","treeDataSource","hrm_config_list","folderForm","apiTabsData","currentApiData","currentTab","viewShow","loadingApi","onlySelf","loading","treeFilterText","currentSelectParentNode","onMounted","getApiTree","allConfig","response","debugFromCaseData","watch","newData","apiData","toRaw","saveApiInfo","step","error","apiSaveSuccess","oldApiId","apiInfo","saveFolderInfo","nodeDbClick","nodeTabIndex","dict","emptyData","getApiFormDataByType","delTreeNode","dataIndex","delTab","tabId","currentTabIndex","clickTab","tab","activeTabChange","tabName","debug","step_result_key","apiTreeFilter","handelMoveNode","err","handleEditNode","handleAddNode","parentNodeData","dataType","showRunHistory","handleNodeChange","showFolderDialog","currentNodeObj"],"mappings":"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"}