{"version":3,"file":"index.DpYOPlw3.js","sources":["../../../src/views/hrm/project/index.vue"],"sourcesContent":["<template>\r\n  <div class=\"app-container\">\r\n    <ProjectTableQuery @select-change=\"handleSelectionChange\" ref=\"projectQueryViewRef\">\r\n      <template #table-tool>\r\n        <el-col :span=\"1.5\">\r\n          <el-button\r\n              type=\"primary\"\r\n              plain\r\n              icon=\"Plus\"\r\n              @click=\"handleAdd\"\r\n              v-hasPermi=\"['hrm:project:add']\"\r\n          >新增\r\n          </el-button>\r\n        </el-col>\r\n        <el-col :span=\"1.5\">\r\n          <el-button type=\"warning\" icon=\"CaretRight\" @click=\"runTest\"\r\n                     v-hasPermi=\"['hrm:case:run']\" title=\"运行\">\r\n            执行\r\n          </el-button>\r\n        </el-col>\r\n      </template>\r\n      <template #tableOperate=\"{scope}\">\r\n        <el-button link type=\"primary\" icon=\"Edit\" :loading=\"loading\" @click=\"handleUpdate(scope.row)\" v-hasPermi=\"['hrm:project:edit']\"\r\n                   title=\"修改\">\r\n        </el-button>\r\n        <el-button link type=\"warning\" icon=\"CaretRight\" @click=\"runTest(scope.row)\"\r\n                   v-hasPermi=\"['hrm:case:run']\" title=\"运行\">\r\n        </el-button>\r\n        <!--               <el-button link type=\"primary\" icon=\"Plus\" @click=\"handleAdd(scope.row)\" v-hasPermi=\"['hrm:project:add']\">新增</el-button>-->\r\n        <el-button link type=\"primary\" icon=\"Delete\" @click=\"handleDelete(scope.row)\"\r\n                   v-hasPermi=\"['hrm:project:remove']\" title=\"修改\">\r\n        </el-button>\r\n      </template>\r\n    </ProjectTableQuery>\r\n\r\n    <!-- 添加或修改项目对话框 -->\r\n    <el-dialog :title=\"title\" v-model=\"open\" width=\"800px\" append-to-body>\r\n      <el-form ref=\"projectRef\" :model=\"form\" :rules=\"rules\" label-width=\"90px\">\r\n        <el-row>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"项目名称\" prop=\"projectName\">\r\n              <el-input v-model=\"form.projectName\" placeholder=\"请输入项目名称\"/>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"显示排序\" prop=\"orderNum\">\r\n              <el-input-number v-model=\"form.orderNum\" controls-position=\"right\" :min=\"0\"/>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"项目负责人\" prop=\"responsibleName\">\r\n              <el-input v-model=\"form.responsibleName\" placeholder=\"请输入负责人\" maxlength=\"20\"/>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"测试负责人\" prop=\"testUser\">\r\n              <el-input v-model=\"form.testUser\" placeholder=\"请输入测试负责人\" maxlength=\"25\"/>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"开发负责人\" prop=\"devUser\">\r\n              <el-input v-model=\"form.devUser\" placeholder=\"请输入开发负责人\" maxlength=\"20\"/>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"发布应用\" prop=\"publishApp\">\r\n              <el-input v-model=\"form.publishApp\" placeholder=\"请输入发布应用\" maxlength=\"20\"/>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"简要描述\" prop=\"simpleDesc\">\r\n              <el-input type=\"textarea\" :rows=\"4\" v-model=\"form.simpleDesc\" placeholder=\"简要描述\" maxlength=\"100\"/>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"其他信息\" prop=\"otherDesc\">\r\n              <el-input type=\"textarea\" :rows=\"4\" v-model=\"form.otherDesc\" placeholder=\"其他信息\" maxlength=\"100\"/>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"项目状态\">\r\n              <el-radio-group v-model=\"form.status\">\r\n                <el-radio\r\n                    v-for=\"dict in qtr_data_status\"\r\n                    :key=\"dict.value * 1\"\r\n                    :value=\"dict.value * 1\"\r\n                >{{ dict.label }}\r\n                </el-radio>\r\n              </el-radio-group>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n      </el-form>\r\n      <template #footer>\r\n        <div class=\"dialog-footer\">\r\n          <el-button type=\"primary\" @click=\"submitForm\">确 定</el-button>\r\n          <el-button @click=\"cancel\">取 消</el-button>\r\n        </div>\r\n      </template>\r\n    </el-dialog>\r\n\r\n    <!-- 运行用例对话框 -->\r\n    <RunDialog v-model:dialog-visible=\"runDialogShow\" :run-type=\"RunTypeEnum.project\" :run-ids=\"runIds\"></RunDialog>\r\n  </div>\r\n</template>\r\n\r\n<script setup name=\"project\">\r\nimport {ElMessageBox} from \"element-plus\";\r\nimport {addProject, delProject, getProject, updateProject} from \"@/api/hrm/project.js\";\r\nimport {RunTypeEnum, StatusNewEnum} from \"@/components/hrm/enum.js\";\r\nimport RunDialog from \"@/components/hrm/common/run/run_dialog.vue\";\r\nimport ProjectTableQuery from \"@/components/hrm/util-data-table/project-table-query.vue\";\r\n\r\nconst {proxy} = getCurrentInstance();\r\nconst {qtr_data_status} = proxy.useDict(\"qtr_data_status\");\r\n\r\nconst projectQueryViewRef = ref(null);\r\nconst total = ref(0);\r\nconst open = ref(false);\r\nconst loading = ref(false);\r\nconst showSearch = ref(true);\r\nconst title = ref(\"\");\r\nconst isExpandAll = ref(true);\r\nconst refreshTable = ref(true);\r\n\r\nconst runDialogShow = ref(false);\r\nconst runIds = ref([]);\r\n\r\nconst data = reactive({\r\n  form: {},\r\n  queryParams: {\r\n    projectName: undefined,\r\n    status: undefined,\r\n    pageNum: 1,\r\n    pageSize: 10\r\n  },\r\n  rules: {\r\n    projectName: [{required: true, message: \"项目名称不能为空\", trigger: \"blur\"}],\r\n    orderNum: [{required: true, message: \"显示排序不能为空\", trigger: \"blur\"}]\r\n  },\r\n});\r\n\r\nconst {queryParams, form, rules} = toRefs(data);\r\n\r\nfunction handleSelectionChange(selection) {\r\n  runIds.value = selection.map(item => item.projectId);\r\n}\r\n\r\n\r\n/** 取消按钮 */\r\nfunction cancel() {\r\n  open.value = false;\r\n  reset();\r\n}\r\n\r\n/** 表单重置 */\r\nfunction reset() {\r\n  form.value = {\r\n    projectId: undefined,\r\n    projectName: undefined,\r\n    orderNum: 0,\r\n    simpleDesc: undefined,\r\n    status: StatusNewEnum.normal.value\r\n  };\r\n  proxy.resetForm(\"projectRef\");\r\n}\r\n\r\n\r\n/** 新增按钮操作 */\r\nfunction handleAdd(row) {\r\n  reset();\r\n  open.value = true;\r\n  title.value = \"添加项目\";\r\n}\r\n\r\n/** 展开/折叠操作 */\r\nfunction toggleExpandAll() {\r\n  refreshTable.value = false;\r\n  isExpandAll.value = !isExpandAll.value;\r\n  nextTick(() => {\r\n    refreshTable.value = true;\r\n  });\r\n}\r\n\r\n/** 修改按钮操作 */\r\nfunction handleUpdate(row) {\r\n  loading.value = true;\r\n  reset();\r\n  getProject(row.projectId).then(response => {\r\n    form.value = response.data;\r\n    open.value = true;\r\n    title.value = \"修改项目\";\r\n  }).finally(()=>{\r\n    loading.value = false;\r\n  });\r\n}\r\n\r\n/** 提交按钮 */\r\nfunction submitForm() {\r\n  proxy.$refs[\"projectRef\"].validate(valid => {\r\n    if (valid) {\r\n      if (form.value.projectId != undefined) {\r\n        updateProject(form.value).then(response => {\r\n          proxy.$modal.msgSuccess(\"修改成功\");\r\n          open.value = false;\r\n          projectQueryViewRef.value.handleQuery();\r\n        });\r\n      } else {\r\n        addProject(form.value).then(response => {\r\n          proxy.$modal.msgSuccess(\"新增成功\");\r\n          open.value = false;\r\n          projectQueryViewRef.value.handleQuery();\r\n        });\r\n      }\r\n    }\r\n  });\r\n}\r\n\r\n/** 删除按钮操作 */\r\nfunction handleDelete(row) {\r\n  proxy.$modal.confirm('是否确认删除名称为\"' + row.projectName + '\"的数据项?').then(function () {\r\n    return delProject(row.projectId);\r\n  }).then(() => {\r\n    projectQueryViewRef.value.handleQuery();\r\n    proxy.$modal.msgSuccess(\"删除成功\");\r\n  }).catch(() => {\r\n  });\r\n}\r\n\r\nfunction runTest(row) {\r\n  if (row && \"projectId\" in row && row.projectId) {\r\n    runIds.value = [row.projectId];\r\n  }\r\n  if (!runIds.value || runIds.value.length === 0) {\r\n    ElMessageBox.alert('请选择要运行的项目', \"提示！\", {type: 'warning'});\r\n    return;\r\n  }\r\n\r\n  runDialogShow.value = true;\r\n\r\n}\r\n</script>\r\n"],"names":["proxy","getCurrentInstance","qtr_data_status","projectQueryViewRef","ref","open","loading","title","runDialogShow","runIds","data","reactive","queryParams","form","rules","toRefs","handleSelectionChange","selection","item","cancel","reset","StatusNewEnum","handleAdd","row","handleUpdate","getProject","response","submitForm","valid","updateProject","addProject","handleDelete","delProject","runTest","ElMessageBox"],"mappings":"+uBAiHA,KAAM,CAAC,MAAAA,CAAK,EAAIC,KACV,CAAC,gBAAAC,CAAe,EAAIF,EAAM,QAAQ,iBAAiB,EAEnDG,EAAsBC,EAAI,IAAI,EACtBA,EAAI,CAAC,EACnB,MAAMC,EAAOD,EAAI,EAAK,EAChBE,EAAUF,EAAI,EAAK,EACNA,EAAI,EAAI,EAC3B,MAAMG,EAAQH,EAAI,EAAE,EACAA,EAAI,EAAI,EACPA,EAAI,EAAI,EAE7B,MAAMI,EAAgBJ,EAAI,EAAK,EACzBK,EAASL,EAAI,CAAA,CAAE,EAEfM,EAAOC,EAAS,CACpB,KAAM,CAAE,EACR,YAAa,CACX,YAAa,OACb,OAAQ,OACR,QAAS,EACT,SAAU,EACX,EACD,MAAO,CACL,YAAa,CAAC,CAAC,SAAU,GAAM,QAAS,WAAY,QAAS,MAAM,CAAC,EACpE,SAAU,CAAC,CAAC,SAAU,GAAM,QAAS,WAAY,QAAS,MAAM,CAAC,CAClE,CACH,CAAC,EAEK,CAAC,YAAAC,GAAa,KAAAC,EAAM,MAAAC,CAAK,EAAIC,GAAOL,CAAI,EAE9C,SAASM,EAAsBC,EAAW,CACxCR,EAAO,MAAQQ,EAAU,IAAIC,GAAQA,EAAK,SAAS,CACrD,CAIA,SAASC,GAAS,CAChBd,EAAK,MAAQ,GACbe,GACF,CAGA,SAASA,GAAQ,CACfP,EAAK,MAAQ,CACX,UAAW,OACX,YAAa,OACb,SAAU,EACV,WAAY,OACZ,OAAQQ,EAAc,OAAO,KACjC,EACErB,EAAM,UAAU,YAAY,CAC9B,CAIA,SAASsB,EAAUC,EAAK,CACtBH,IACAf,EAAK,MAAQ,GACbE,EAAM,MAAQ,MAChB,CAYA,SAASiB,EAAaD,EAAK,CACzBjB,EAAQ,MAAQ,GAChBc,IACAK,EAAWF,EAAI,SAAS,EAAE,KAAKG,GAAY,CACzCb,EAAK,MAAQa,EAAS,KACtBrB,EAAK,MAAQ,GACbE,EAAM,MAAQ,MAClB,CAAG,EAAE,QAAQ,IAAI,CACbD,EAAQ,MAAQ,EACpB,CAAG,CACH,CAGA,SAASqB,GAAa,CACpB3B,EAAM,MAAM,WAAc,SAAS4B,GAAS,CACtCA,IACEf,EAAK,MAAM,WAAa,KAC1BgB,EAAchB,EAAK,KAAK,EAAE,KAAKa,GAAY,CACzC1B,EAAM,OAAO,WAAW,MAAM,EAC9BK,EAAK,MAAQ,GACbF,EAAoB,MAAM,aACpC,CAAS,EAED2B,EAAWjB,EAAK,KAAK,EAAE,KAAKa,GAAY,CACtC1B,EAAM,OAAO,WAAW,MAAM,EAC9BK,EAAK,MAAQ,GACbF,EAAoB,MAAM,aACpC,CAAS,EAGT,CAAG,CACH,CAGA,SAAS4B,EAAaR,EAAK,CACzBvB,EAAM,OAAO,QAAQ,aAAeuB,EAAI,YAAc,QAAQ,EAAE,KAAK,UAAY,CAC/E,OAAOS,EAAWT,EAAI,SAAS,CACnC,CAAG,EAAE,KAAK,IAAM,CACZpB,EAAoB,MAAM,cAC1BH,EAAM,OAAO,WAAW,MAAM,CAClC,CAAG,EAAE,MAAM,IAAM,CACjB,CAAG,CACH,CAEA,SAASiC,EAAQV,EAAK,CAIpB,GAHIA,GAAO,cAAeA,GAAOA,EAAI,YACnCd,EAAO,MAAQ,CAACc,EAAI,SAAS,GAE3B,CAACd,EAAO,OAASA,EAAO,MAAM,SAAW,EAAG,CAC9CyB,GAAa,MAAM,YAAa,MAAO,CAAC,KAAM,SAAS,CAAC,EACxD,MACD,CAED1B,EAAc,MAAQ,EAExB"}