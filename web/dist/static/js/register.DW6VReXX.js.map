{"version":3,"file":"register.DW6VReXX.js","sources":["../../../src/views/register.vue"],"sourcesContent":["<template>\r\n  <div class=\"register\">\r\n    <el-form ref=\"registerRef\" :model=\"registerForm\" :rules=\"registerRules\" class=\"register-form\">\r\n      <div class=\"title-container\">\r\n        <img src=\"../assets/images/login-logo.png\" alt=\"\" style=\"width: 210px; margin-bottom: 10px; align-self: center;\">\r\n        <h3 class=\"title\">T-Runner 自动化测试平台</h3>\r\n      </div>\r\n      <el-form-item prop=\"username\">\r\n        <el-input\r\n          v-model=\"registerForm.username\"\r\n          type=\"text\"\r\n          size=\"large\"\r\n          auto-complete=\"off\"\r\n          placeholder=\"账号\"\r\n        >\r\n          <template #prefix><svg-icon icon-class=\"user\" class=\"el-input__icon input-icon\" /></template>\r\n        </el-input>\r\n      </el-form-item>\r\n      <el-form-item prop=\"password\">\r\n        <el-input\r\n          v-model=\"registerForm.password\"\r\n          type=\"password\"\r\n          size=\"large\"\r\n          auto-complete=\"off\"\r\n          placeholder=\"密码\"\r\n          @keyup.enter=\"handleRegister\"\r\n        >\r\n          <template #prefix><svg-icon icon-class=\"password\" class=\"el-input__icon input-icon\" /></template>\r\n        </el-input>\r\n      </el-form-item>\r\n      <el-form-item prop=\"confirmPassword\">\r\n        <el-input\r\n          v-model=\"registerForm.confirmPassword\"\r\n          type=\"password\"\r\n          size=\"large\"\r\n          auto-complete=\"off\"\r\n          placeholder=\"确认密码\"\r\n          @keyup.enter=\"handleRegister\"\r\n        >\r\n          <template #prefix><svg-icon icon-class=\"password\" class=\"el-input__icon input-icon\" /></template>\r\n        </el-input>\r\n      </el-form-item>\r\n      <el-form-item prop=\"code\" v-if=\"captchaEnabled\">\r\n        <el-input\r\n          size=\"large\"\r\n          v-model=\"registerForm.code\"\r\n          auto-complete=\"off\"\r\n          placeholder=\"验证码\"\r\n          style=\"width: 67%\"\r\n          @keyup.enter=\"handleRegister\"\r\n        >\r\n          <template #prefix><svg-icon icon-class=\"validCode\" class=\"el-input__icon input-icon\" /></template>\r\n        </el-input>\r\n        <div class=\"register-code\">\r\n          <img :src=\"codeUrl\" @click=\"getCode\" class=\"register-code-img\"/>\r\n        </div>\r\n      </el-form-item>\r\n      <el-form-item style=\"width:100%;\">\r\n        <el-button\r\n          :loading=\"loading\"\r\n          size=\"large\"\r\n          type=\"primary\"\r\n          class=\"hover-button\"\r\n          @click.prevent=\"handleRegister\"\r\n        >\r\n          <span v-if=\"!loading\">注 册</span>\r\n          <span v-else>注 册 中...</span>\r\n        </el-button>\r\n        <div style=\"float: right;\">\r\n          <router-link class=\"link-type\" :to=\"'/login'\">使用已有账户登录</router-link>\r\n        </div>\r\n      </el-form-item>\r\n    </el-form>\r\n    <!--  底部  -->\r\n    <div class=\"el-register-footer\">\r\n<!--      <span>Copyright © 2024 insistence.tech All Rights Reserved.</span>-->\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ElMessageBox } from \"element-plus\";\r\nimport { getCodeImg, register } from \"@/api/login\";\r\n\r\nconst router = useRouter();\r\nconst { proxy } = getCurrentInstance();\r\n\r\nconst registerForm = ref({\r\n  username: \"\",\r\n  password: \"\",\r\n  confirmPassword: \"\",\r\n  code: \"\",\r\n  uuid: \"\"\r\n});\r\n\r\nconst equalToPassword = (rule, value, callback) => {\r\n  if (registerForm.value.password !== value) {\r\n    callback(new Error(\"两次输入的密码不一致\"));\r\n  } else {\r\n    callback();\r\n  }\r\n};\r\n\r\nconst registerRules = {\r\n  username: [\r\n    { required: true, trigger: \"blur\", message: \"请输入您的账号\" },\r\n    { min: 2, max: 20, message: \"用户账号长度必须介于 2 和 20 之间\", trigger: \"blur\" }\r\n  ],\r\n  password: [\r\n    { required: true, trigger: \"blur\", message: \"请输入您的密码\" },\r\n    { min: 5, max: 20, message: \"用户密码长度必须介于 5 和 20 之间\", trigger: \"blur\" }\r\n  ],\r\n  confirmPassword: [\r\n    { required: true, trigger: \"blur\", message: \"请再次输入您的密码\" },\r\n    { required: true, validator: equalToPassword, trigger: \"blur\" }\r\n  ],\r\n  code: [{ required: true, trigger: \"change\", message: \"请输入验证码\" }]\r\n};\r\n\r\nconst codeUrl = ref(\"\");\r\nconst loading = ref(false);\r\nconst captchaEnabled = ref(true);\r\n\r\nfunction handleRegister() {\r\n  proxy.$refs.registerRef.validate(valid => {\r\n    if (valid) {\r\n      loading.value = true;\r\n      register(registerForm.value).then(res => {\r\n        const username = registerForm.value.username;\r\n        ElMessageBox.alert(\"<font color='red'>恭喜你，您的账号 \" + username + \" 注册成功！</font>\", \"系统提示\", {\r\n          dangerouslyUseHTMLString: true,\r\n          type: \"success\",\r\n        }).then(() => {\r\n          router.push(\"/login\");\r\n        }).catch(() => {});\r\n      }).catch(() => {\r\n        loading.value = false;\r\n        if (captchaEnabled) {\r\n          getCode();\r\n        }\r\n      });\r\n    }\r\n  });\r\n}\r\n\r\nfunction getCode() {\r\n  getCodeImg().then(res => {\r\n    captchaEnabled.value = res.captchaEnabled === undefined ? true : res.captchaEnabled;\r\n    if (captchaEnabled.value) {\r\n      codeUrl.value = \"data:image/gif;base64,\" + res.img;\r\n      registerForm.value.uuid = res.uuid;\r\n    }\r\n  });\r\n}\r\n\r\ngetCode();\r\n</script>\r\n\r\n<style lang='scss' scoped>\r\n.register {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  height: 100%;\r\n  background-image: url(\"../assets/images/login-background.jpg\");\r\n  background-size: cover;\r\n\r\n  :deep(.el-input__inner) {\r\n    background: transparent !important;\r\n    color: #ffffff;\r\n  }\r\n\r\n  :deep(.el-input__wrapper) {\r\n    background: transparent !important;\r\n    color: #454545;\r\n    box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.1);\r\n  }\r\n  .hover-button:hover, .hover-button:focus {\r\n    color: #ffffff;\r\n    background: #5c5c59;\r\n    border-color: #5c5c59;\r\n  }\r\n\r\n  .hover-button {\r\n    width: 100%;\r\n    background: #333330;\r\n    border-color: #333330;\r\n\r\n  }\r\n\r\n  :deep(input:-webkit-autofill) {\r\n\t  box-shadow: 0 0 0 1000px transparent  !important;\r\n\t  /* 浏览器记住密码的底色的颜色 */\r\n\t  -webkit-text-fill-color: #fff !important;\r\n\t  /* 浏览器记住密码的字的颜色 */\r\n\t  transition: background-color 300000s ease-in-out 0s;\r\n\t  /* 通过延时渲染背景色变相去除背景颜色 */\r\n\t}\r\n}\r\n.title {\r\n  margin: 0px auto 30px auto;\r\n  text-align: center;\r\n  color: #fff;\r\n}\r\n\r\n.register-form {\r\n  border-radius: 6px;\r\n  //background: #ffffff;\r\n  background: transparent;\r\n  width: 450px;\r\n  padding: 25px 25px 5px 25px;\r\n  .el-input {\r\n    height: 47px;\r\n    input {\r\n      height: 47px;\r\n    }\r\n  }\r\n  .input-icon {\r\n    height: 39px;\r\n    width: 14px;\r\n    margin-left: 0px;\r\n  }\r\n}\r\n.register-tip {\r\n  font-size: 13px;\r\n  text-align: center;\r\n  color: #bfbfbf;\r\n}\r\n.register-code {\r\n  width: 33%;\r\n  height: 47px;\r\n  float: right;\r\n  img {\r\n    cursor: pointer;\r\n    vertical-align: middle;\r\n  }\r\n}\r\n.el-register-footer {\r\n  height: 40px;\r\n  line-height: 40px;\r\n  position: fixed;\r\n  bottom: 0;\r\n  width: 100%;\r\n  text-align: center;\r\n  color: #fff;\r\n  font-family: Arial;\r\n  font-size: 12px;\r\n  letter-spacing: 1px;\r\n}\r\n.register-code-img {\r\n  height: 47px;\r\n  padding-left: 12px;\r\n}\r\n.title-container {\r\n\r\n  text-align: center;\r\n\r\n  .title {\r\n    font-size: 30px;\r\n    color: #fff;\r\n    margin: 10px auto 40px 10px;\r\n    text-align: center;\r\n    font-weight: bold;\r\n  }\r\n}\r\n</style>\r\n"],"names":["router","useRouter","proxy","getCurrentInstance","registerForm","ref","registerRules","rule","value","callback","codeUrl","loading","captchaEnabled","handleRegister","valid","register","res","username","ElMessageBox","getCode","getCodeImg"],"mappings":"yVAoFA,MAAMA,EAASC,EAAS,EAClB,CAAE,MAAAC,CAAK,EAAKC,IAEZC,EAAeC,EAAI,CACvB,SAAU,GACV,SAAU,GACV,gBAAiB,GACjB,KAAM,GACN,KAAM,EACR,CAAC,EAUKC,EAAgB,CACpB,SAAU,CACR,CAAE,SAAU,GAAM,QAAS,OAAQ,QAAS,SAAW,EACvD,CAAE,IAAK,EAAG,IAAK,GAAI,QAAS,uBAAwB,QAAS,MAAQ,CACtE,EACD,SAAU,CACR,CAAE,SAAU,GAAM,QAAS,OAAQ,QAAS,SAAW,EACvD,CAAE,IAAK,EAAG,IAAK,GAAI,QAAS,uBAAwB,QAAS,MAAQ,CACtE,EACD,gBAAiB,CACf,CAAE,SAAU,GAAM,QAAS,OAAQ,QAAS,WAAa,EACzD,CAAE,SAAU,GAAM,UAnBE,CAACC,EAAMC,EAAOC,IAAa,CAC7CL,EAAa,MAAM,WAAaI,EAClCC,EAAS,IAAI,MAAM,YAAY,CAAC,EAEhCA,GAEJ,EAakD,QAAS,MAAQ,CAChE,EACD,KAAM,CAAC,CAAE,SAAU,GAAM,QAAS,SAAU,QAAS,SAAU,CACjE,EAEMC,EAAUL,EAAI,EAAE,EAChBM,EAAUN,EAAI,EAAK,EACnBO,EAAiBP,EAAI,EAAI,EAE/B,SAASQ,GAAiB,CACxBX,EAAM,MAAM,YAAY,SAASY,GAAS,CACpCA,IACFH,EAAQ,MAAQ,GAChBI,EAASX,EAAa,KAAK,EAAE,KAAKY,GAAO,CACvC,MAAMC,EAAWb,EAAa,MAAM,SACpCc,EAAa,MAAM,8BAAgCD,EAAW,gBAAiB,OAAQ,CACrF,yBAA0B,GAC1B,KAAM,SAChB,CAAS,EAAE,KAAK,IAAM,CACZjB,EAAO,KAAK,QAAQ,CAC9B,CAAS,EAAE,MAAM,IAAM,CAAA,CAAE,CACzB,CAAO,EAAE,MAAM,IAAM,CACbW,EAAQ,MAAQ,GACZC,GACFO,GAEV,CAAO,EAEP,CAAG,CACH,CAEA,SAASA,GAAU,CACjBC,EAAY,EAAC,KAAKJ,GAAO,CACvBJ,EAAe,MAAQI,EAAI,iBAAmB,OAAY,GAAOA,EAAI,eACjEJ,EAAe,QACjBF,EAAQ,MAAQ,yBAA2BM,EAAI,IAC/CZ,EAAa,MAAM,KAAOY,EAAI,KAEpC,CAAG,CACH,CAEA,OAAAG"}