import{af as B,V as ae,r as s,D as ne,a0 as oe,d as r,J as R,o as _,c as T,I as d,U,h as a,e,f as n,k as re,P as se,a7 as ie,l as k,$ as P,p as y,aC as ue,m as $,z as q,C as pe,v as de}from"./index.CHnR_MAu.js";import{r as ce}from"./project.BpVuymad.js";import{c as me}from"./run-detail.CU1qKOwv.js";import"./run_detail.CgntWMNI.js";import"./case.CZLC1pq4.js";import"./table-variables.iSiz_YnM.js";import"./data-template.CF-ivY4r.js";import"./tools.B8u06WSF.js";import"./ace-editor.UAWmui2X.js";import"./ResizeObserver.es.B1PUzC5B.js";import"./module.BMNy9Seo.js";import"./env.jLYomLFD.js";function _e(f){return B({url:"/hrm/report/list",method:"get",params:f})}function fe(f){return B({url:"/hrm/report",method:"DELETE",data:f})}const ge={class:"app-container"},he=pe({name:"RunDetail"}),Re=Object.assign(he,{setup(f){const{proxy:p}=de();p.useDict("sys_normal_disable");const{hrm_run_status:C}=p.useDict("hrm_run_status");p.useDict("sys_request_method");const{hrm_data_type:E}=p.useDict("hrm_data_type");ae("hrm_data_type",E);const I=s([]);s([]),s(!1);const b=s(!0),z=s(!0),x=s([]),L=s(!0),j=s(!0),w=s(0),g=s(!1),S=s(null),h=s(!0),F=ne({queryParams:{pageNum:1,pageSize:10,reportId:void 0,reportName:void 0,projectId:void 0,moduleId:void 0,status:void 0,onlySelf:h}}),{queryParams:i}=oe(F);function c(){b.value=!0,_e(i.value).then(o=>{I.value=o.rows,w.value=o.total,b.value=!1})}function D(){i.value.pageNum=1,c()}function K(){p.resetForm("queryRef"),D()}function Q(o){x.value=o.map(l=>l.reportId),L.value=o.length!=1,j.value=!o.length}function N(o){let l=[];o.reportId?l=[o.reportId]:l=x.value,p.$modal.confirm('是否确认删除ID为"'+l+'"的数据项？').then(function(){return fe({reportIds:l})}).then(()=>{c(),p.$modal.msgSuccess("删除成功")}).catch(()=>{})}function A(o){let l=o.reportId;S.value=l,g.value=!0}return c(),(o,l)=>{const J=r("el-input"),v=r("el-form-item"),O=r("el-option"),G=r("el-select"),H=r("el-checkbox"),m=r("el-button"),M=r("el-form"),u=r("el-table-column"),W=r("el-table"),X=r("pagination"),Y=r("el-main"),Z=r("el-container"),ee=r("el-dialog"),V=R("hasPermi"),te=R("loading");return _(),T("div",ge,[d(e(M,{model:a(i),ref:"queryRef",inline:!0},{default:n(()=>[e(v,{label:"报告名称",prop:"reportName"},{default:n(()=>[e(J,{modelValue:a(i).reportName,"onUpdate:modelValue":l[0]||(l[0]=t=>a(i).reportName=t),placeholder:"请输入报告名称",clearable:"",style:{width:"200px"},onKeyup:re(D,["enter"])},null,8,["modelValue"])]),_:1}),e(v,{label:"状态",prop:"status"},{default:n(()=>[e(G,{modelValue:a(i).status,"onUpdate:modelValue":l[1]||(l[1]=t=>a(i).status=t),placeholder:"报告状态",clearable:"",style:{width:"100px"}},{default:n(()=>[(_(!0),T(se,null,ie(a(C),t=>(_(),k(O,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(v,null,{default:n(()=>[e(H,{modelValue:a(h),"onUpdate:modelValue":l[2]||(l[2]=t=>P(h)?h.value=t:null),onChange:c},{default:n(()=>[y("仅自己的数据")]),_:1},8,["modelValue"])]),_:1}),e(v,null,{default:n(()=>[e(m,{type:"primary",icon:"Search",onClick:D},{default:n(()=>[y("搜索")]),_:1}),e(m,{type:"default",icon:"Refresh",onClick:K},{default:n(()=>[y("重置")]),_:1}),d((_(),k(m,{type:"danger",icon:"Delete",onClick:N},{default:n(()=>[y("删除")]),_:1})),[[V,["hrm:report:delete"]]])]),_:1})]),_:1},8,["model"]),[[U,a(z)]]),d((_(),k(W,{data:a(I),onSelectionChange:Q,border:""},{default:n(()=>[e(u,{type:"selection",width:"55",align:"center"}),e(u,{label:"ID",align:"center",prop:"reportId"}),e(u,{label:"报告名",align:"center",prop:"reportName"}),e(u,{label:"success",align:"center",prop:"success"}),e(u,{label:"total",align:"center",prop:"total"}),e(u,{label:"status",align:"center",prop:"status"},{default:n(t=>[e(ue,{options:a(C),value:t.row.status},null,8,["options","value"])]),_:1}),e(u,{label:"创建人",align:"center",prop:"createBy"}),e(u,{label:"执行开始时间",align:"center",prop:"createTime","class-name":"small-padding fixed-width"},{default:n(t=>[$("span",null,q(o.parseTime(t.row.startAt)),1)]),_:1}),e(u,{label:"执行时长(S)",align:"center",prop:"createTime","class-name":"small-padding fixed-width"},{default:n(t=>[$("span",null,q(t.row.testDuration),1)]),_:1}),e(u,{label:"操作",width:"200",align:"center","class-name":"small-padding fixed-width"},{default:n(t=>[d(e(m,{link:"",type:"primary",icon:"View",onClick:le=>A(t.row),title:"查看"},null,8,["onClick"]),[[V,["hrm:report:detail"]]]),d(e(m,{link:"",type:"danger",icon:"Delete",onClick:le=>N(t.row),title:"删除"},null,8,["onClick"]),[[V,["hrm:report:delete"]]])]),_:1})]),_:1},8,["data"])),[[te,a(b)]]),d(e(X,{total:a(w),page:a(i).pageNum,"onUpdate:page":l[3]||(l[3]=t=>a(i).pageNum=t),limit:a(i).pageSize,"onUpdate:limit":l[4]||(l[4]=t=>a(i).pageSize=t),onPagination:c},null,8,["total","page","limit"]),[[U,a(w)>0]]),e(ee,{fullscreen:"",modelValue:a(g),"onUpdate:modelValue":l[5]||(l[5]=t=>P(g)?g.value=t:null),"append-to-body":"","destroy-on-close":""},{default:n(()=>[e(Z,{style:{height:"100%"}},{default:n(()=>[e(Y,{style:{"max-height":"calc(100vh - 95px)"}},{default:n(()=>[e(me,{"report-id":a(S),"view-type":a(ce).report},null,8,["report-id","view-type"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}});export{Re as default};
