import{r as m,J as fe,N as ge,d as u,H as K,o as b,c as P,I as v,M as L,h as a,e,f as o,l as _e,O,P as Q,m as j,p as V,K as R,i as T,y as $,n as be,F as ve,s as he,E as Ve}from"./index.B-ki0wTK.js";import{R as we,l as M,g as ye,u as je,a as Ne,d as xe}from"./project.CjUq6QCv.js";import{_ as Ue}from"./run_dialog.hwjk6Wms.js";import"./run_detail.B7CDhMn4.js";import"./env.BXDgmL9O.js";const ke={class:"app-container"},Ce={class:"dialog-footer"},Se=ve({name:"project"}),qe=Object.assign(Se,{setup(De){const{proxy:c}=he(),{qtr_data_status:k}=c.useDict("qtr_data_status"),q=m([]),C=m(0),g=m(!1),N=m(!0),x=m(!0),S=m(""),H=m(!0),J=m(!0),U=m(!1),w=m([]),G=fe({form:{},queryParams:{projectName:void 0,status:void 0,pageNum:1,pageSize:10},rules:{projectName:[{required:!0,message:"项目名称不能为空",trigger:"blur"}],orderNum:[{required:!0,message:"显示排序不能为空",trigger:"blur"}]}}),{queryParams:p,form:n,rules:W}=ge(G);function h(){N.value=!0,M(p.value).then(r=>{q.value=r.rows,C.value=r.total,N.value=!1})}function X(r){w.value=r.map(l=>l.projectId)}function Y(){g.value=!1,D()}function D(){n.value={projectId:void 0,projectName:void 0,orderNum:0,simpleDesc:void 0,status:"0"},c.resetForm("projectRef")}function I(){h()}function Z(){c.resetForm("queryRef"),I()}function ee(r){D(),M().then(l=>{projectOptions.value=c.handleTree(l.data,"projectId")}),g.value=!0,S.value="添加项目"}function le(r){D(),ye(r.projectId).then(l=>{n.value=l.data,g.value=!0,S.value="修改项目"})}function te(){c.$refs.projectRef.validate(r=>{r&&(n.value.projectId!=null?je(n.value).then(l=>{c.$modal.msgSuccess("修改成功"),g.value=!1,h()}):Ne(n.value).then(l=>{c.$modal.msgSuccess("新增成功"),g.value=!1,h()}))})}function ae(r){c.$modal.confirm('是否确认删除名称为"'+r.projectName+'"的数据项?').then(function(){return xe(r.projectId)}).then(()=>{h(),c.$modal.msgSuccess("删除成功")}).catch(()=>{})}function E(r){if(r&&"projectId"in r&&r.projectId&&(w.value=[r.projectId]),!w.value||w.value.length===0){Ve.alert("请选择要运行的项目","提示！",{type:"warning"});return}U.value=!0}return h(),(r,l)=>{const _=u("el-input"),s=u("el-form-item"),oe=u("el-option"),ne=u("el-select"),f=u("el-button"),A=u("el-form"),d=u("el-col"),re=u("right-toolbar"),B=u("el-row"),i=u("el-table-column"),ue=u("dict-tag"),se=u("el-table"),de=u("pagination"),ie=u("el-input-number"),pe=u("el-radio"),me=u("el-radio-group"),ce=u("el-dialog"),y=K("hasPermi"),F=K("loading");return b(),P("div",ke,[v(e(A,{model:a(p),ref:"queryRef",inline:!0},{default:o(()=>[e(s,{label:"项目名称",prop:"projectName"},{default:o(()=>[e(_,{modelValue:a(p).projectName,"onUpdate:modelValue":l[0]||(l[0]=t=>a(p).projectName=t),placeholder:"请输入项目名称",clearable:"",style:{width:"200px"},onKeyup:_e(I,["enter"])},null,8,["modelValue"])]),_:1}),e(s,{label:"状态",prop:"status"},{default:o(()=>[e(ne,{modelValue:a(p).status,"onUpdate:modelValue":l[1]||(l[1]=t=>a(p).status=t),placeholder:"项目状态",clearable:"",style:{width:"200px"}},{default:o(()=>[(b(!0),P(O,null,Q(a(k),t=>(b(),j(oe,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(s,null,{default:o(()=>[e(f,{type:"primary",icon:"Search",onClick:I},{default:o(()=>l[16]||(l[16]=[V("搜索")])),_:1}),e(f,{icon:"Refresh",onClick:Z},{default:o(()=>l[17]||(l[17]=[V("重置")])),_:1})]),_:1})]),_:1},8,["model"]),[[L,a(x)]]),e(B,{gutter:10,class:"mb8"},{default:o(()=>[e(d,{span:1.5},{default:o(()=>[v((b(),j(f,{type:"primary",plain:"",icon:"Plus",onClick:ee},{default:o(()=>l[18]||(l[18]=[V("新增 ")])),_:1})),[[y,["hrm:project:add"]]])]),_:1}),e(d,{span:1.5},{default:o(()=>[v((b(),j(f,{type:"warning",icon:"CaretRight",onClick:E,title:"运行"},{default:o(()=>l[19]||(l[19]=[V(" 执行 ")])),_:1})),[[y,["hrm:case:run"]]])]),_:1}),e(re,{showSearch:a(x),"onUpdate:showSearch":l[2]||(l[2]=t=>R(x)?x.value=t:null),onQueryTable:h},null,8,["showSearch"])]),_:1}),a(J)?v((b(),j(se,{key:0,border:"",data:a(q),"row-key":"projectId","table-layout":"fixed","default-expand-all":a(H),onSelectionChange:X,"max-height":"calc(100vh - 280px)"},{default:o(()=>[e(i,{type:"selection",width:"55",align:"center"}),e(i,{prop:"projectId",label:"ID",width:"150"}),e(i,{prop:"projectName",align:"left",label:"项目名称","min-width":"200"}),e(i,{prop:"responsibleName",align:"center",label:"负责人",width:"100"}),e(i,{prop:"testUser",label:"测试负责人",align:"center",width:"100"}),e(i,{prop:"devUser",label:"开发负责人",align:"center",width:"100"}),e(i,{prop:"orderNum",label:"排序",align:"center",width:"70"}),e(i,{prop:"status",label:"状态",align:"center",width:"70"},{default:o(t=>[e(ue,{options:a(k),value:t.row.status},null,8,["options","value"])]),_:1}),e(i,{label:"创建时间",align:"center",prop:"createTime","class-name":"small-padding fixed-width",width:"150"},{default:o(t=>[T("span",null,$(r.parseTime(t.row.createTime)),1)]),_:1}),e(i,{label:"更新时间",align:"center",prop:"updateTime","class-name":"small-padding fixed-width",width:"150"},{default:o(t=>[T("span",null,$(r.parseTime(t.row.updateTime)),1)]),_:1}),e(i,{label:"操作",align:"center","class-name":"small-padding fixed-width",fixed:"right",width:"120"},{default:o(t=>[v(e(f,{link:"",type:"primary",icon:"Edit",onClick:z=>le(t.row),title:"修改"},null,8,["onClick"]),[[y,["hrm:project:edit"]]]),v(e(f,{link:"",type:"warning",icon:"CaretRight",onClick:z=>E(t.row),title:"运行"},null,8,["onClick"]),[[F,a(N)],[y,["hrm:case:run"]]]),v(e(f,{link:"",type:"primary",icon:"Delete",onClick:z=>ae(t.row),title:"修改"},null,8,["onClick"]),[[y,["hrm:project:remove"]]])]),_:1})]),_:1},8,["data","default-expand-all"])),[[F,a(N)]]):be("",!0),v(e(de,{total:a(C),page:a(p).pageNum,"onUpdate:page":l[3]||(l[3]=t=>a(p).pageNum=t),limit:a(p).pageSize,"onUpdate:limit":l[4]||(l[4]=t=>a(p).pageSize=t),onPagination:h},null,8,["total","page","limit"]),[[L,a(C)>0]]),e(ce,{title:a(S),modelValue:a(g),"onUpdate:modelValue":l[14]||(l[14]=t=>R(g)?g.value=t:null),width:"800px","append-to-body":""},{footer:o(()=>[T("div",Ce,[e(f,{type:"primary",onClick:te},{default:o(()=>l[20]||(l[20]=[V("确 定")])),_:1}),e(f,{onClick:Y},{default:o(()=>l[21]||(l[21]=[V("取 消")])),_:1})])]),default:o(()=>[e(A,{ref:"projectRef",model:a(n),rules:a(W),"label-width":"90px"},{default:o(()=>[e(B,null,{default:o(()=>[e(d,{span:12},{default:o(()=>[e(s,{label:"项目名称",prop:"projectName"},{default:o(()=>[e(_,{modelValue:a(n).projectName,"onUpdate:modelValue":l[5]||(l[5]=t=>a(n).projectName=t),placeholder:"请输入项目名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{span:12},{default:o(()=>[e(s,{label:"显示排序",prop:"orderNum"},{default:o(()=>[e(ie,{modelValue:a(n).orderNum,"onUpdate:modelValue":l[6]||(l[6]=t=>a(n).orderNum=t),"controls-position":"right",min:0},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{span:12},{default:o(()=>[e(s,{label:"项目负责人",prop:"responsibleName"},{default:o(()=>[e(_,{modelValue:a(n).responsibleName,"onUpdate:modelValue":l[7]||(l[7]=t=>a(n).responsibleName=t),placeholder:"请输入负责人",maxlength:"20"},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{span:12},{default:o(()=>[e(s,{label:"测试负责人",prop:"testUser"},{default:o(()=>[e(_,{modelValue:a(n).testUser,"onUpdate:modelValue":l[8]||(l[8]=t=>a(n).testUser=t),placeholder:"请输入测试负责人",maxlength:"25"},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{span:12},{default:o(()=>[e(s,{label:"开发负责人",prop:"devUser"},{default:o(()=>[e(_,{modelValue:a(n).devUser,"onUpdate:modelValue":l[9]||(l[9]=t=>a(n).devUser=t),placeholder:"请输入开发负责人",maxlength:"20"},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{span:12},{default:o(()=>[e(s,{label:"发布应用",prop:"publishApp"},{default:o(()=>[e(_,{modelValue:a(n).publishApp,"onUpdate:modelValue":l[10]||(l[10]=t=>a(n).publishApp=t),placeholder:"请输入发布应用",maxlength:"20"},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{span:12},{default:o(()=>[e(s,{label:"简要描述",prop:"simpleDesc"},{default:o(()=>[e(_,{type:"textarea",rows:4,modelValue:a(n).simpleDesc,"onUpdate:modelValue":l[11]||(l[11]=t=>a(n).simpleDesc=t),placeholder:"简要描述",maxlength:"100"},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{span:12},{default:o(()=>[e(s,{label:"其他信息",prop:"otherDesc"},{default:o(()=>[e(_,{type:"textarea",rows:4,modelValue:a(n).otherDesc,"onUpdate:modelValue":l[12]||(l[12]=t=>a(n).otherDesc=t),placeholder:"其他信息",maxlength:"100"},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{span:12},{default:o(()=>[e(s,{label:"项目状态"},{default:o(()=>[e(me,{modelValue:a(n).status,"onUpdate:modelValue":l[13]||(l[13]=t=>a(n).status=t)},{default:o(()=>[(b(!0),P(O,null,Q(a(k),t=>(b(),j(pe,{key:t.value,label:t.value},{default:o(()=>[V($(t.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"]),e(Ue,{"dialog-visible":a(U),"onUpdate:dialogVisible":l[15]||(l[15]=t=>R(U)?U.value=t:null),"run-type":a(we).project,"run-ids":a(w)},null,8,["dialog-visible","run-type","run-ids"])])}}});export{qe as default};
