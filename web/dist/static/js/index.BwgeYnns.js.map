{"version":3,"file":"index.BwgeYnns.js","sources":["../../../src/api/monitor/online.js","../../../src/views/monitor/online/index.vue"],"sourcesContent":["import request from '@/utils/request'\r\n\r\n// 查询在线用户列表\r\nexport function list(query) {\r\n  return request({\r\n    url: '/monitor/online/list',\r\n    method: 'get',\r\n    params: query\r\n  })\r\n}\r\n\r\n// 强退用户\r\nexport function forceLogout(tokenId) {\r\n  return request({\r\n    url: '/monitor/online/' + tokenId,\r\n    method: 'delete'\r\n  })\r\n}\r\n","<template>\r\n   <div class=\"app-container\">\r\n      <el-form :model=\"queryParams\" ref=\"queryRef\" :inline=\"true\">\r\n         <el-form-item label=\"登录地址\" prop=\"ipaddr\">\r\n            <el-input\r\n               v-model=\"queryParams.ipaddr\"\r\n               placeholder=\"请输入登录地址\"\r\n               clearable\r\n               style=\"width: 200px\"\r\n               @keyup.enter=\"handleQuery\"\r\n            />\r\n         </el-form-item>\r\n         <el-form-item label=\"用户名称\" prop=\"userName\">\r\n            <el-input\r\n               v-model=\"queryParams.userName\"\r\n               placeholder=\"请输入用户名称\"\r\n               clearable\r\n               style=\"width: 200px\"\r\n               @keyup.enter=\"handleQuery\"\r\n            />\r\n         </el-form-item>\r\n         <el-form-item>\r\n            <el-button type=\"primary\" icon=\"Search\" @click=\"handleQuery\">搜索</el-button>\r\n            <el-button icon=\"Refresh\" @click=\"resetQuery\">重置</el-button>\r\n         </el-form-item>\r\n      </el-form>\r\n      <el-table\r\n         v-loading=\"loading\"\r\n         :data=\"onlineList.slice((pageNum - 1) * pageSize, pageNum * pageSize)\"\r\n         style=\"width: 100%;\"\r\n      >\r\n         <el-table-column label=\"序号\" width=\"50\" type=\"index\" align=\"center\">\r\n            <template #default=\"scope\">\r\n               <span>{{ (pageNum - 1) * pageSize + scope.$index + 1 }}</span>\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column label=\"会话编号\" align=\"center\" prop=\"tokenId\" :show-overflow-tooltip=\"true\" />\r\n         <el-table-column label=\"登录名称\" align=\"center\" prop=\"userName\" :show-overflow-tooltip=\"true\" />\r\n         <el-table-column label=\"所属部门\" align=\"center\" prop=\"deptName\" :show-overflow-tooltip=\"true\" />\r\n         <el-table-column label=\"主机\" align=\"center\" prop=\"ipaddr\" :show-overflow-tooltip=\"true\" />\r\n         <el-table-column label=\"登录地点\" align=\"center\" prop=\"loginLocation\" :show-overflow-tooltip=\"true\" />\r\n         <el-table-column label=\"操作系统\" align=\"center\" prop=\"os\" :show-overflow-tooltip=\"true\" />\r\n         <el-table-column label=\"浏览器\" align=\"center\" prop=\"browser\" :show-overflow-tooltip=\"true\" />\r\n         <el-table-column label=\"登录时间\" align=\"center\" prop=\"loginTime\" width=\"180\">\r\n            <template #default=\"scope\">\r\n               <span>{{ parseTime(scope.row.loginTime) }}</span>\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column label=\"操作\" align=\"center\" class-name=\"small-padding fixed-width\">\r\n            <template #default=\"scope\">\r\n               <el-button link type=\"primary\" icon=\"Delete\" @click=\"handleForceLogout(scope.row)\" v-hasPermi=\"['monitor:online:forceLogout']\">强退</el-button>\r\n            </template>\r\n         </el-table-column>\r\n      </el-table>\r\n\r\n      <pagination v-show=\"total > 0\" :total=\"total\" v-model:page=\"pageNum\" v-model:limit=\"pageSize\" />\r\n   </div>\r\n</template>\r\n\r\n<script setup name=\"Online\">\r\nimport { forceLogout, list as initData } from \"@/api/monitor/online\";\r\n\r\nconst { proxy } = getCurrentInstance();\r\n\r\nconst onlineList = ref([]);\r\nconst loading = ref(true);\r\nconst total = ref(0);\r\nconst pageNum = ref(1);\r\nconst pageSize = ref(10);\r\n\r\nconst queryParams = ref({\r\n  ipaddr: undefined,\r\n  userName: undefined\r\n});\r\n\r\n/** 查询登录日志列表 */\r\nfunction getList() {\r\n  loading.value = true;\r\n  initData(queryParams.value).then(response => {\r\n    onlineList.value = response.rows;\r\n    total.value = response.total;\r\n    loading.value = false;\r\n  });\r\n}\r\n/** 搜索按钮操作 */\r\nfunction handleQuery() {\r\n  pageNum.value = 1;\r\n  getList();\r\n}\r\n/** 重置按钮操作 */\r\nfunction resetQuery() {\r\n  proxy.resetForm(\"queryRef\");\r\n  handleQuery();\r\n}\r\n/** 强退按钮操作 */\r\nfunction handleForceLogout(row) {\r\n    proxy.$modal.confirm('是否确认强退名称为\"' + row.userName + '\"的用户?').then(function () {\r\n  return forceLogout(row.tokenId);\r\n  }).then(() => {\r\n    getList();\r\n    proxy.$modal.msgSuccess(\"删除成功\");\r\n  }).catch(() => {});\r\n}\r\n\r\ngetList();\r\n</script>\r\n"],"names":["list","query","request","forceLogout","tokenId","proxy","getCurrentInstance","onlineList","ref","loading","total","pageNum","pageSize","queryParams","getList","initData","response","handleQuery","resetQuery","handleForceLogout","row"],"mappings":"iKAGO,SAASA,EAAKC,EAAO,CAC1B,OAAOC,EAAQ,CACb,IAAK,uBACL,OAAQ,MACR,OAAQD,CACZ,CAAG,CACH,CAGO,SAASE,EAAYC,EAAS,CACnC,OAAOF,EAAQ,CACb,IAAK,mBAAqBE,EAC1B,OAAQ,QACZ,CAAG,CACH,kFC6CA,KAAM,CAAE,MAAAC,CAAK,EAAKC,IAEZC,EAAaC,EAAI,CAAA,CAAE,EACnBC,EAAUD,EAAI,EAAI,EAClBE,EAAQF,EAAI,CAAC,EACbG,EAAUH,EAAI,CAAC,EACfI,EAAWJ,EAAI,EAAE,EAEjBK,EAAcL,EAAI,CACtB,OAAQ,OACR,SAAU,MACZ,CAAC,EAGD,SAASM,GAAU,CACjBL,EAAQ,MAAQ,GAChBM,EAASF,EAAY,KAAK,EAAE,KAAKG,GAAY,CAC3CT,EAAW,MAAQS,EAAS,KAC5BN,EAAM,MAAQM,EAAS,MACvBP,EAAQ,MAAQ,EACpB,CAAG,CACH,CAEA,SAASQ,GAAc,CACrBN,EAAQ,MAAQ,EAChBG,GACF,CAEA,SAASI,GAAa,CACpBb,EAAM,UAAU,UAAU,EAC1BY,GACF,CAEA,SAASE,EAAkBC,EAAK,CAC5Bf,EAAM,OAAO,QAAQ,aAAee,EAAI,SAAW,OAAO,EAAE,KAAK,UAAY,CAC/E,OAAOjB,EAAYiB,EAAI,OAAO,CAChC,CAAG,EAAE,KAAK,IAAM,CACZN,IACAT,EAAM,OAAO,WAAW,MAAM,CAClC,CAAG,EAAE,MAAM,IAAM,CAAA,CAAE,CACnB,CAEA,OAAAS"}