import{r as d,a5 as de,v as ue,C as se,d as i,H as z,o as k,c as re,I as v,M as F,h as l,e as t,f as a,l as M,p as f,m as O,K as N,i as D,y as S,F as pe,au as T,s as me}from"./index.N0ypA0wQ.js";import{l as ge,g as fe,d as ce,u as _e}from"./agent.CW2QP-1A.js";import{i as Q}from"./data-template.pUAxcsDo.js";import{A as ve}from"./enum.Cve1eJHF.js";import{T as ye}from"./tag-enum.B5VENiUp.js";import"./tools.fhJnEm5t.js";const he={class:"app-container"},be={class:"dialog-footer"},we=pe({name:"Agent"}),De=Object.assign(we,{setup(Ce){const{proxy:w}=me(),U=d([]),h=d(!0),H=d(!0),q=d(!0),C=d(0),E=d(""),x=d([]),c=d(!1),V=d(!1),A=d(Q),u=de({pageNum:1,pageSize:10,agentCode:void 0,agentName:void 0,status:void 0}),s=d(Q),r=d({page:!1,edite:!1,copy:!1}),L=ue(()=>(s.value.agentId?"【"+s.value.agentId+"】":"")+s.value.agentName);function y(){r.value.page=!0,ge(u.value).then(o=>{U.value=o.rows,C.value=o.total}).finally(()=>{r.value.page=!1})}function b(){u.value.pageNum=1,y()}function G(){w.resetForm("queryRef"),b()}function J(o){x.value=o.map(e=>e.agentId),H.value=o.length!==1,q.value=!o.length}function W(o){r.value.edite=!0;const e=o.agentId||x.value;fe(e).then(p=>{if(!p.data||Object.keys(p.data).length===0){T.warning("未查到对应数据！");return}s.value=p.data,E.value="修改Agent",c.value=!0}).finally(()=>{r.value.edite=!1})}function R(o){const e=o.agentId?[o.agentId]:x.value;w.$modal.confirm('是否确认删除ID为"'+e+'"的数据项？').then(function(){return ce({agentId:e})}).then(()=>{y(),w.$modal.msgSuccess("删除成功")}).catch(()=>{})}function X(){r.value.edite=!0,_e(s.value).then(o=>{T.success(o.msg),c.value=!1}).catch(o=>{T.error("操作失败："+o)}).finally(()=>{r.value.edite=!1})}return se(()=>{y()}),(o,e)=>{var j;const p=i("el-input"),_=i("el-form-item"),m=i("el-button"),$=i("el-form"),Y=i("el-col"),Z=i("right-toolbar"),ee=i("el-row"),g=i("el-table-column"),te=i("el-table"),le=i("pagination"),ae=i("el-text"),B=i("el-main"),ne=i("el-footer"),K=i("el-container"),P=i("el-dialog"),I=z("hasPermi"),oe=z("loading");return k(),re("div",he,[v(t($,{model:l(u),ref:"queryRef",inline:!0},{default:a(()=>[t(_,{label:"AgentCode",prop:"agentId"},{default:a(()=>[t(p,{modelValue:l(u).agentCode,"onUpdate:modelValue":e[0]||(e[0]=n=>l(u).agentCode=n),placeholder:"请输入AgentCode",clearable:"",style:{width:"200px"},onKeyup:M(b,["enter"])},null,8,["modelValue"])]),_:1}),t(_,{label:"Agent名称",prop:"agentName"},{default:a(()=>[t(p,{modelValue:l(u).agentName,"onUpdate:modelValue":e[1]||(e[1]=n=>l(u).agentName=n),placeholder:"请输入Agent名称",clearable:"",style:{width:"200px"},onKeyup:M(b,["enter"])},null,8,["modelValue"])]),_:1}),t(_,null,{default:a(()=>[t(m,{type:"primary",icon:"Search",onClick:b,loading:l(r).page,disabled:l(r).page},{default:a(()=>e[11]||(e[11]=[f(" 搜索 ")])),_:1},8,["loading","disabled"]),t(m,{type:"default",icon:"Refresh",onClick:G},{default:a(()=>e[12]||(e[12]=[f("重置")])),_:1})]),_:1})]),_:1},8,["model"]),[[F,l(h)]]),t(ee,{gutter:10,class:"mb8"},{default:a(()=>[t(Y,{span:1.5},{default:a(()=>[v((k(),O(m,{type:"danger",plain:"",icon:"Delete",disabled:l(q),onClick:R},{default:a(()=>e[13]||(e[13]=[f("删除 ")])),_:1},8,["disabled"])),[[I,["qtr:agent:remove"]]])]),_:1}),t(Z,{showSearch:l(h),"onUpdate:showSearch":e[2]||(e[2]=n=>N(h)?h.value=n:null),onQueryTable:y},null,8,["showSearch"])]),_:1}),v((k(),O(te,{data:l(U),onSelectionChange:J,border:"","table-layout":"fixed","max-height":"calc(100vh - 280px)"},{default:a(()=>[t(g,{type:"selection",width:"55",align:"center"}),t(g,{label:"AgentID",prop:"agentId",width:"150px"}),t(g,{label:"Agent名称",prop:"agentName",width:"auto","min-width":"200px"}),t(g,{label:"AgentCode",prop:"agentCode",width:"auto","min-width":"200px"}),t(g,{label:"状态",prop:"status",width:"100px","min-width":"100px"},{default:a(n=>[t(ye,{options:Object.values(l(ve)),value:[n.row.status]},null,8,["options","value"])]),_:1}),t(g,{label:"在线时间",align:"center",prop:"onlineTime","class-name":"small-padding fixed-width",width:"150px"},{default:a(n=>[D("span",null,S(o.parseTime(n.row.onlineTime)),1)]),_:1}),t(g,{label:"离线时间",align:"center",prop:"offlineTime","class-name":"small-padding fixed-width",width:"150px"},{default:a(n=>[D("span",null,S(o.parseTime(n.row.offlineTime)),1)]),_:1}),t(g,{label:"操作",width:"170",align:"center","class-name":"small-padding fixed-width",fixed:"right"},{default:a(n=>[v(t(m,{link:"",type:"warning",icon:"Edit",loading:l(r).edite,onClick:ie=>W(n.row),title:"编辑"},null,8,["loading","onClick"]),[[I,["qtr:agent:edit"]]]),v(t(m,{link:"",type:"danger",icon:"Delete",onClick:ie=>R(n.row),title:"删除"},null,8,["onClick"]),[[I,["qtr:agent:remove"]]])]),_:1})]),_:1},8,["data"])),[[oe,l(r).page]]),v(t(le,{total:l(C),page:l(u).pageNum,"onUpdate:page":e[3]||(e[3]=n=>l(u).pageNum=n),limit:l(u).pageSize,"onUpdate:limit":e[4]||(e[4]=n=>l(u).pageSize=n),onPagination:y},null,8,["total","page","limit"]),[[F,l(C)>0]]),t(P,{title:l(E)+" >> "+l(L),modelValue:l(c),"onUpdate:modelValue":e[8]||(e[8]=n=>N(c)?c.value=n:null),"append-to-body":"","destroy-on-close":""},{default:a(()=>[t(K,{style:{height:"100%"}},{default:a(()=>[t(B,{style:{"max-height":"calc(100vh - 95px)"}},{default:a(()=>[t($,null,{default:a(()=>[t(_,{label:"Agent名称："},{default:a(()=>[t(p,{modelValue:l(s).agentName,"onUpdate:modelValue":e[5]||(e[5]=n=>l(s).agentName=n)},null,8,["modelValue"])]),_:1}),t(_,{label:"AgentCode："},{default:a(()=>[t(ae,null,{default:a(()=>[f(S(l(s).agentCode),1)]),_:1})]),_:1}),t(_,{label:"简要描述："},{default:a(()=>[t(p,{modelValue:l(s).simpleDesc,"onUpdate:modelValue":e[6]||(e[6]=n=>l(s).simpleDesc=n)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(ne,null,{default:a(()=>[D("div",be,[t(m,{onClick:e[7]||(e[7]=n=>c.value=!1)},{default:a(()=>e[14]||(e[14]=[f("取消")])),_:1}),t(m,{type:"primary",onClick:X},{default:a(()=>e[15]||(e[15]=[f("保存")])),_:1})])]),_:1})]),_:1})]),_:1},8,["title","modelValue"]),t(P,{title:(j=l(A))==null?void 0:j.agentName,modelValue:l(V),"onUpdate:modelValue":e[10]||(e[10]=n=>N(V)?V.value=n:null),"append-to-body":"","destroy-on-close":""},{default:a(()=>[t(K,{style:{height:"100%"}},{default:a(()=>[t(B,{style:{"max-height":"calc(100vh - 95px)"}},{default:a(()=>[t(p,{placeholder:"请输入Agent名称",modelValue:l(A).agentName,"onUpdate:modelValue":e[9]||(e[9]=n=>l(A).agentName=n)},{suffix:a(()=>[t(m,{onClick:o.copyAgentHandle},{default:a(()=>e[16]||(e[16]=[f("保存")])),_:1},8,["onClick"])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["title","modelValue"])])}}});export{De as default};
//# sourceMappingURL=index.BcTJQaOs.js.map
