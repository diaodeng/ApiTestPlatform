import{r as i,a5 as ve,v as J,C as ye,d as u,H as A,o as N,c as _e,I as f,M as G,h as t,e as l,f as o,l as W,p as g,m as P,K as D,i as z,y as X,F as we,az as he,ab as be,au as b,s as Ve}from"./index.DgyczuKs.js";import{c as Ie,l as ke,g as xe,d as Ce,u as Re,a as Ne}from"./forward.Bd-7Bd9U.js";import{c as S}from"./data-template.CBoE4CJQ.js";import De from"./forward_detail_index.BmP-MeWl.js";import"./tools.DGA99u3Z.js";import"./enum.Cve1eJHF.js";import"./tag-selector.BEiILwwx.js";import"./tag-enum.BEjq4_fY.js";const Se={class:"app-container"},Ue={class:"dialog-footer"},qe=we({name:"Rules"}),He=Object.assign(qe,{setup(Te){const{proxy:U}=Ve(),K=i([]),x=i(!0),Y=i(!0),O=i(!0),q=i(0),C=i(""),T=i([]),c=i(!1),R=i(!1),V=i(S),y=i(!1),_=i(S),d=ve({pageNum:1,pageSize:10,ruleId:void 0,ruleName:void 0,status:void 0,onlySelf:!0}),s=i(S),r=i({page:!1,edite:!1,copy:!1}),Z=J(()=>s.value.ruleId?"【"+s.value.ruleId+"】":""),ee=J(()=>(V.value.ruleId?"【"+V.value.ruleId+"】":"")+V.value.ruleName);function le(n){R.value=!0,V.value=n}function te(n){y.value=!0,_.value=structuredClone(he(be(n)))}function ae(){y.value=!0;let n={ruleId:_.value.ruleId,ruleName:_.value.ruleName};Ie(n).then(e=>{b.success("复制成功")}).finally(()=>{y.value=!1})}function I(){r.value.page=!0,ke(d.value).then(n=>{K.value=n.rows,q.value=n.total}).finally(()=>{r.value.page=!1})}function k(){d.value.pageNum=1,I()}function oe(){U.resetForm("queryRef"),k()}function ne(n){T.value=n.map(e=>e.ruleId),Y.value=n.length!==1,O.value=!n.length}function ue(){C.value="添加转发规则",s.value=JSON.parse(JSON.stringify(S)),c.value=!0}function ie(n){r.value.edite=!0;const e=n.ruleId||T.value;xe(e).then(m=>{if(!m.data||Object.keys(m.data).length===0){b.warning("未查到对应数据！");return}s.value=m.data,C.value="修改转发规则",c.value=!0}).finally(()=>{r.value.edite=!1})}function H(n){const e=n.ruleId?[n.ruleId]:T.value;U.$modal.confirm('是否确认删除ID为"'+e+'"的数据项？').then(function(){return Ce({ruleId:e})}).then(()=>{I(),U.$modal.msgSuccess("删除成功")}).catch(()=>{})}function de(){r.value.edite=!0,s.value.ruleId?Re(s.value).then(n=>{b.success(n.msg),c.value=!1}).catch(n=>{b.error("操作失败："+n)}).finally(()=>{r.value.edite=!1}):Ne(s.value).then(n=>{b.success(n.msg),c.value=!1}).catch(n=>{b.error("操作失败："+n)}).finally(()=>{r.value.edite=!1})}return ye(()=>{I()}),(n,e)=>{var Q,j;const m=u("el-input"),w=u("el-form-item"),re=u("el-checkbox"),p=u("el-button"),L=u("el-form"),M=u("el-col"),se=u("right-toolbar"),pe=u("el-row"),v=u("el-table-column"),me=u("el-table"),fe=u("pagination"),$=u("el-main"),ce=u("el-footer"),B=u("el-container"),E=u("el-dialog"),h=A("hasPermi"),ge=A("loading");return N(),_e("div",Se,[f(l(L,{model:t(d),ref:"queryRef",inline:!0},{default:o(()=>[l(w,{label:"转发规则ID",prop:"ruleId"},{default:o(()=>[l(m,{modelValue:t(d).ruleId,"onUpdate:modelValue":e[0]||(e[0]=a=>t(d).ruleId=a),placeholder:"请输入转发规则Id",clearable:"",style:{width:"200px"},onKeyup:W(k,["enter"])},null,8,["modelValue"])]),_:1}),l(w,{label:"转发规则名称",prop:"ruleName"},{default:o(()=>[l(m,{modelValue:t(d).ruleName,"onUpdate:modelValue":e[1]||(e[1]=a=>t(d).ruleName=a),placeholder:"请输入转发规则名称",clearable:"",style:{width:"200px"},onKeyup:W(k,["enter"])},null,8,["modelValue"])]),_:1}),l(w,null,{default:o(()=>[l(re,{modelValue:t(d).onlySelf,"onUpdate:modelValue":e[2]||(e[2]=a=>t(d).onlySelf=a),onChange:k},{default:o(()=>e[13]||(e[13]=[g("仅自己的数据")])),_:1},8,["modelValue"])]),_:1}),l(w,null,{default:o(()=>[l(p,{type:"primary",icon:"Search",onClick:k,loading:t(r).page,disabled:t(r).page},{default:o(()=>e[14]||(e[14]=[g(" 搜索 ")])),_:1},8,["loading","disabled"]),l(p,{type:"default",icon:"Refresh",onClick:oe},{default:o(()=>e[15]||(e[15]=[g("重置")])),_:1})]),_:1})]),_:1},8,["model"]),[[G,t(x)]]),l(pe,{gutter:10,class:"mb8"},{default:o(()=>[l(M,{span:1.5},{default:o(()=>[f((N(),P(p,{type:"primary",plain:"",icon:"Plus",onClick:ue},{default:o(()=>e[16]||(e[16]=[g("新增 ")])),_:1})),[[h,["qtr:forwardRules:add"]]])]),_:1}),l(M,{span:1.5},{default:o(()=>[f((N(),P(p,{type:"danger",plain:"",icon:"Delete",disabled:t(O),onClick:H},{default:o(()=>e[17]||(e[17]=[g("删除 ")])),_:1},8,["disabled"])),[[h,["qtr:forwardRules:remove"]]])]),_:1}),l(se,{showSearch:t(x),"onUpdate:showSearch":e[3]||(e[3]=a=>D(x)?x.value=a:null),onQueryTable:I},null,8,["showSearch"])]),_:1}),f((N(),P(me,{data:t(K),onSelectionChange:ne,border:"","table-layout":"fixed","max-height":"calc(100vh - 280px)"},{default:o(()=>[l(v,{type:"selection",width:"55",align:"center"}),l(v,{label:"转发规则ID",prop:"ruleId",width:"150px"}),l(v,{label:"转发规则名称",prop:"ruleName",width:"auto","min-width":"200px"}),l(v,{label:"创建人",align:"center",prop:"createBy",width:"80px"}),l(v,{label:"创建时间",align:"center",prop:"createTime","class-name":"small-padding fixed-width",width:"150px"},{default:o(a=>[z("span",null,X(n.parseTime(a.row.createTime)),1)]),_:1}),l(v,{label:"更新时间",align:"center",prop:"createTime","class-name":"small-padding fixed-width",width:"150px"},{default:o(a=>[z("span",null,X(n.parseTime(a.row.updateTime)),1)]),_:1}),l(v,{label:"操作",width:"170",align:"center","class-name":"small-padding fixed-width",fixed:"right"},{default:o(a=>[f(l(p,{link:"",type:"warning",icon:"Histogram",loading:t(r).edite,onClick:F=>le(a.row),title:"详情"},null,8,["loading","onClick"]),[[h,["qtr:forwardRules:edit"]]]),f(l(p,{link:"",type:"warning",icon:"Edit",loading:t(r).edite,onClick:F=>ie(a.row),title:"编辑"},null,8,["loading","onClick"]),[[h,["qtr:forwardRules:edit"]]]),f(l(p,{link:"",type:"warning",icon:"CopyDocument",loading:t(r).copy,onClick:F=>te(a.row),title:"复制"},null,8,["loading","onClick"]),[[h,["qtr:forwardRules:copy"]]]),f(l(p,{link:"",type:"danger",icon:"Delete",onClick:F=>H(a.row),title:"删除"},null,8,["onClick"]),[[h,["qtr:forwardRules:remove"]]])]),_:1})]),_:1},8,["data"])),[[ge,t(r).page]]),f(l(fe,{total:t(q),page:t(d).pageNum,"onUpdate:page":e[4]||(e[4]=a=>t(d).pageNum=a),limit:t(d).pageSize,"onUpdate:limit":e[5]||(e[5]=a=>t(d).pageSize=a),onPagination:I},null,8,["total","page","limit"]),[[G,t(q)>0]]),l(E,{title:t(C)+" >> "+t(Z)+((Q=t(s))==null?void 0:Q.ruleName),modelValue:t(c),"onUpdate:modelValue":e[9]||(e[9]=a=>D(c)?c.value=a:null),"append-to-body":"","destroy-on-close":""},{default:o(()=>[l(B,{style:{height:"100%"}},{default:o(()=>[l($,{style:{"max-height":"calc(100vh - 95px)"}},{default:o(()=>[l(L,null,{default:o(()=>[l(w,{label:"规则名称："},{default:o(()=>[l(m,{modelValue:t(s).ruleName,"onUpdate:modelValue":e[6]||(e[6]=a=>t(s).ruleName=a)},null,8,["modelValue"])]),_:1}),l(w,{label:"简要描述："},{default:o(()=>[l(m,{modelValue:t(s).simpleDesc,"onUpdate:modelValue":e[7]||(e[7]=a=>t(s).simpleDesc=a)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(ce,null,{default:o(()=>[z("div",Ue,[l(p,{onClick:e[8]||(e[8]=a=>c.value=!1)},{default:o(()=>e[18]||(e[18]=[g("取消")])),_:1}),l(p,{type:"primary",onClick:de},{default:o(()=>e[19]||(e[19]=[g("保存")])),_:1})])]),_:1})]),_:1})]),_:1},8,["title","modelValue"]),l(E,{title:(j=t(_))==null?void 0:j.ruleName,modelValue:t(y),"onUpdate:modelValue":e[11]||(e[11]=a=>D(y)?y.value=a:null),"append-to-body":"","destroy-on-close":""},{default:o(()=>[l(B,{style:{height:"100%"}},{default:o(()=>[l($,{style:{"max-height":"calc(100vh - 95px)"}},{default:o(()=>[l(m,{placeholder:"请输入转发规则名称",modelValue:t(_).ruleName,"onUpdate:modelValue":e[10]||(e[10]=a=>t(_).ruleName=a)},{suffix:o(()=>[l(p,{onClick:ae},{default:o(()=>e[20]||(e[20]=[g("保存")])),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["title","modelValue"]),l(E,{fullscreen:"",title:t(C)+" >> "+t(ee),modelValue:t(R),"onUpdate:modelValue":e[12]||(e[12]=a=>D(R)?R.value=a:null),"append-to-body":"","destroy-on-close":""},{default:o(()=>[l(B,{style:{height:"100%"}},{default:o(()=>[l($,{style:{"max-height":"calc(100vh - 95px)"}},{default:o(()=>{var a;return[l(De,{"rules-id":(a=t(V))==null?void 0:a.ruleId},null,8,["rules-id"])]}),_:1})]),_:1})]),_:1},8,["title","modelValue"])])}}});export{He as default};
