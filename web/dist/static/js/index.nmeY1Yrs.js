import{F as de,d as ue,r as d,a5 as se,v as re,C as pe,e as i,H as z,c as me,o as I,I as v,f as e,M as F,l,i as a,m as M,n as f,j as O,K as N,h as D,y as S,au as T}from"./index.DLM0P_FN.js";import{l as ge,d as fe,g as ce,u as _e}from"./agent.DUVcbZuN.js";import{i as Q}from"./data-template.BrUbBjfC.js";import{A as ve}from"./enum.BYy-eByp.js";import{T as ye}from"./tag-enum.DfiWmJ8r.js";import"./tools.De_J0dJF.js";const he={class:"app-container"},be={class:"dialog-footer"},we=de({name:"Agent"}),De=Object.assign(we,{setup(Ce){const{proxy:w}=ue(),U=d([]),h=d(!0),H=d(!0),q=d(!0),C=d(0),E=d(""),x=d([]),c=d(!1),V=d(!1),A=d(Q),u=se({pageNum:1,pageSize:10,agentCode:void 0,agentName:void 0,status:void 0}),s=d(Q),r=d({page:!1,edite:!1,copy:!1}),L=re(()=>(s.value.agentId?"【"+s.value.agentId+"】":"")+s.value.agentName);function y(){r.value.page=!0,ge(u.value).then(o=>{U.value=o.rows,C.value=o.total}).finally(()=>{r.value.page=!1})}function b(){u.value.pageNum=1,y()}function G(){w.resetForm("queryRef"),b()}function J(o){x.value=o.map(t=>t.agentId),H.value=o.length!==1,q.value=!o.length}function W(o){r.value.edite=!0;const t=o.agentId||x.value;ce(t).then(p=>{if(!p.data||Object.keys(p.data).length===0){T.warning("未查到对应数据！");return}s.value=p.data,E.value="修改Agent",c.value=!0}).finally(()=>{r.value.edite=!1})}function R(o){const t=o.agentId?[o.agentId]:x.value;w.$modal.confirm('是否确认删除ID为"'+t+'"的数据项？').then(function(){return fe({})}).then(()=>{y(),w.$modal.msgSuccess("删除成功")}).catch(()=>{})}function X(){r.value.edite=!0,_e(s.value).then(o=>{T.success(o.msg),c.value=!1}).catch(o=>{T.error("操作失败："+o)}).finally(()=>{r.value.edite=!1})}return pe(()=>{y()}),(o,t)=>{var P;const p=i("el-input"),_=i("el-form-item"),m=i("el-button"),$=i("el-form"),Y=i("el-col"),Z=i("right-toolbar"),ee=i("el-row"),g=i("el-table-column"),te=i("el-table"),le=i("pagination"),ae=i("el-text"),j=i("el-main"),ne=i("el-footer"),B=i("el-container"),K=i("el-dialog"),k=z("hasPermi"),oe=z("loading");return I(),me("div",he,[v(e($,{model:l(u),ref:"queryRef",inline:!0},{default:a(()=>[e(_,{label:"AgentCode",prop:"agentId"},{default:a(()=>[e(p,{modelValue:l(u).agentCode,"onUpdate:modelValue":t[0]||(t[0]=n=>l(u).agentCode=n),placeholder:"请输入AgentCode",clearable:"",style:{width:"200px"},onKeyup:M(b,["enter"])},null,8,["modelValue"])]),_:1}),e(_,{label:"Agent名称",prop:"agentName"},{default:a(()=>[e(p,{modelValue:l(u).agentName,"onUpdate:modelValue":t[1]||(t[1]=n=>l(u).agentName=n),placeholder:"请输入Agent名称",clearable:"",style:{width:"200px"},onKeyup:M(b,["enter"])},null,8,["modelValue"])]),_:1}),e(_,null,{default:a(()=>[e(m,{type:"primary",icon:"Search",onClick:b,loading:l(r).page,disabled:l(r).page},{default:a(()=>t[11]||(t[11]=[f(" 搜索 ")])),_:1,__:[11]},8,["loading","disabled"]),e(m,{type:"default",icon:"Refresh",onClick:G},{default:a(()=>t[12]||(t[12]=[f("重置")])),_:1,__:[12]})]),_:1})]),_:1},8,["model"]),[[F,l(h)]]),e(ee,{gutter:10,class:"mb8"},{default:a(()=>[e(Y,{span:1.5},{default:a(()=>[v((I(),O(m,{type:"danger",plain:"",icon:"Delete",disabled:l(q),onClick:R},{default:a(()=>t[13]||(t[13]=[f("删除 ")])),_:1,__:[13]},8,["disabled"])),[[k,["qtr:agent:remove"]]])]),_:1}),e(Z,{showSearch:l(h),"onUpdate:showSearch":t[2]||(t[2]=n=>N(h)?h.value=n:null),onQueryTable:y},null,8,["showSearch"])]),_:1}),v((I(),O(te,{data:l(U),onSelectionChange:J,border:"","table-layout":"fixed","max-height":"calc(100vh - 280px)"},{default:a(()=>[e(g,{type:"selection",width:"55",align:"center"}),e(g,{label:"AgentID",prop:"agentId",width:"150px"}),e(g,{label:"Agent名称",prop:"agentName",width:"auto","min-width":"200px"}),e(g,{label:"AgentCode",prop:"agentCode",width:"auto","min-width":"200px"}),e(g,{label:"状态",prop:"status",width:"100px","min-width":"100px"},{default:a(n=>[e(ye,{options:Object.values(l(ve)),value:[n.row.status]},null,8,["options","value"])]),_:1}),e(g,{label:"在线时间",align:"center",prop:"onlineTime","class-name":"small-padding fixed-width",width:"150px"},{default:a(n=>[D("span",null,S(o.parseTime(n.row.onlineTime)),1)]),_:1}),e(g,{label:"离线时间",align:"center",prop:"offlineTime","class-name":"small-padding fixed-width",width:"150px"},{default:a(n=>[D("span",null,S(o.parseTime(n.row.offlineTime)),1)]),_:1}),e(g,{label:"操作",width:"170",align:"center","class-name":"small-padding fixed-width",fixed:"right"},{default:a(n=>[v(e(m,{link:"",type:"warning",icon:"Edit",loading:l(r).edite,onClick:ie=>W(n.row),title:"编辑"},null,8,["loading","onClick"]),[[k,["qtr:agent:edit"]]]),v(e(m,{link:"",type:"danger",icon:"Delete",onClick:ie=>R(n.row),title:"删除"},null,8,["onClick"]),[[k,["qtr:agent:remove"]]])]),_:1})]),_:1},8,["data"])),[[oe,l(r).page]]),v(e(le,{total:l(C),page:l(u).pageNum,"onUpdate:page":t[3]||(t[3]=n=>l(u).pageNum=n),limit:l(u).pageSize,"onUpdate:limit":t[4]||(t[4]=n=>l(u).pageSize=n),onPagination:y},null,8,["total","page","limit"]),[[F,l(C)>0]]),e(K,{title:l(E)+" >> "+l(L),modelValue:l(c),"onUpdate:modelValue":t[8]||(t[8]=n=>N(c)?c.value=n:null),"append-to-body":"","destroy-on-close":""},{default:a(()=>[e(B,{style:{height:"100%"}},{default:a(()=>[e(j,{style:{"max-height":"calc(100vh - 95px)"}},{default:a(()=>[e($,null,{default:a(()=>[e(_,{label:"Agent名称："},{default:a(()=>[e(p,{modelValue:l(s).agentName,"onUpdate:modelValue":t[5]||(t[5]=n=>l(s).agentName=n)},null,8,["modelValue"])]),_:1}),e(_,{label:"AgentCode："},{default:a(()=>[e(ae,null,{default:a(()=>[f(S(l(s).agentCode),1)]),_:1})]),_:1}),e(_,{label:"简要描述："},{default:a(()=>[e(p,{modelValue:l(s).simpleDesc,"onUpdate:modelValue":t[6]||(t[6]=n=>l(s).simpleDesc=n)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(ne,null,{default:a(()=>[D("div",be,[e(m,{onClick:t[7]||(t[7]=n=>c.value=!1)},{default:a(()=>t[14]||(t[14]=[f("取消")])),_:1,__:[14]}),e(m,{type:"primary",onClick:X},{default:a(()=>t[15]||(t[15]=[f("保存")])),_:1,__:[15]})])]),_:1})]),_:1})]),_:1},8,["title","modelValue"]),e(K,{title:(P=l(A))==null?void 0:P.agentName,modelValue:l(V),"onUpdate:modelValue":t[10]||(t[10]=n=>N(V)?V.value=n:null),"append-to-body":"","destroy-on-close":""},{default:a(()=>[e(B,{style:{height:"100%"}},{default:a(()=>[e(j,{style:{"max-height":"calc(100vh - 95px)"}},{default:a(()=>[e(p,{placeholder:"请输入Agent名称",modelValue:l(A).agentName,"onUpdate:modelValue":t[9]||(t[9]=n=>l(A).agentName=n)},{suffix:a(()=>[e(m,{onClick:o.copyAgentHandle},{default:a(()=>t[16]||(t[16]=[f("保存")])),_:1,__:[16]},8,["onClick"])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["title","modelValue"])])}}});export{De as default};
//# sourceMappingURL=index.nmeY1Yrs.js.map
