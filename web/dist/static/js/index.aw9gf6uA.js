import{V as _e,r as v,D as fe,a0 as ve,d as u,J as Q,o as i,c as x,I as b,U as be,h as t,e,f as l,k as ge,P as T,a7 as q,l as y,p,$ as A,m as D,z as P,n as he,C as ye,v as ke,ay as we}from"./index.CHnR_MAu.js";import{l as Ve,g as Ce,u as Ue,a as Ne,d as xe}from"./env.jLYomLFD.js";import{_ as De}from"./table-variables.iSiz_YnM.js";import{_ as Ee}from"./edit-label-text.CqCNkUML.js";const $e={class:"app-container"},Ie={style:{"padding-bottom":"10px"}},Re={class:"dialog-footer"},Se=ye({name:"Env"}),Fe=Object.assign(Se,{setup(Te){const{proxy:d}=ke(),{sys_normal_disable:E}=d.useDict("sys_normal_disable"),{hrm_data_type:G}=d.useDict("hrm_data_type");_e("hrm_data_type",G);const L=v([]),c=v(!1),$=v(!0),V=v(!0),I=v(""),K=v(!0),j=v(!0),J=fe({queryParams:{envName:void 0,status:void 0},rules:{envName:[{required:!0,message:"环境名称不能为空",trigger:"blur"}],orderNum:[{required:!0,message:"显示排序不能为空",trigger:"blur"}],envUrl:[{required:!0,message:"环境地址不能为空",trigger:"blur"}]}}),{queryParams:g,rules:M}=ve(J),o=v({envConfig:{variables:[{key:"default",value:[]}]},envName:"",envUrl:"",orderNum:0,simpleDesc:""});function O(){o.value.envConfig.variables.push({key:"default",desc:"",value:[]})}function H(s){o.value.envConfig.variables.splice(s,1)}function h(){$.value=!0,Ve(g.value).then(s=>{L.value=d.handleTree(s.data,"envId"),$.value=!1})}function W(){c.value=!1,R()}function R(){o.value={envId:void 0,envName:void 0,orderNum:0,envUrl:void 0,simpleDesc:void 0,status:"0",envConfig:{variables:[{value:[],key:"default"}]}},d.resetForm("envRef")}function S(){h()}function X(){d.resetForm("queryRef"),S()}function Y(s){R(),c.value=!0,I.value="添加环境"}function Z(s){R(),Ce(s.envId).then(a=>{o.value=a.data,c.value=!0,I.value="修改环境"})}function ee(){d.$refs.envRef.validate(s=>{s&&(o.value.envId!=null?Ue(o.value).then(a=>{d.$modal.msgSuccess("修改成功"),c.value=!1,h()}):Ne(o.value).then(a=>{d.$modal.msgSuccess("新增成功"),c.value=!1,h()}))})}function le(s){d.$modal.confirm('是否确认删除名称为"'+s.envName+'"的数据项?').then(function(){return xe(s.envId)}).then(()=>{h(),d.$modal.msgSuccess("删除成功")}).catch(()=>{})}function ne(s){we.warning("暂未实现复制功能")}return h(),(s,a)=>{const C=u("el-input"),m=u("el-form-item"),te=u("el-option"),ae=u("el-select"),oe=u("el-checkbox"),r=u("el-button"),B=u("el-form"),_=u("el-col"),ue=u("right-toolbar"),U=u("el-row"),f=u("el-table-column"),se=u("dict-tag"),de=u("el-table"),re=u("el-input-number"),ie=u("el-radio"),me=u("el-radio-group"),F=u("el-text"),z=u("el-tooltip"),pe=u("el-dialog"),k=Q("hasPermi"),ce=Q("loading");return i(),x("div",$e,[b(e(B,{model:t(g),ref:"queryRef",inline:!0},{default:l(()=>[e(m,{label:"环境名称",prop:"envName"},{default:l(()=>[e(C,{modelValue:t(g).envName,"onUpdate:modelValue":a[0]||(a[0]=n=>t(g).envName=n),placeholder:"请输入环境名称",clearable:"",style:{width:"200px"},onKeyup:ge(S,["enter"])},null,8,["modelValue"])]),_:1}),e(m,{label:"状态",prop:"status"},{default:l(()=>[e(ae,{modelValue:t(g).status,"onUpdate:modelValue":a[1]||(a[1]=n=>t(g).status=n),placeholder:"环境状态",clearable:"",style:{width:"200px"}},{default:l(()=>[(i(!0),x(T,null,q(t(E),n=>(i(),y(te,{key:n.value,label:n.label,value:n.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(m,null,{default:l(()=>[e(oe,null,{default:l(()=>[p("仅自己的数据")]),_:1})]),_:1}),e(m,null,{default:l(()=>[e(r,{type:"primary",icon:"Search",onClick:S},{default:l(()=>[p("搜索")]),_:1}),e(r,{icon:"Refresh",onClick:X},{default:l(()=>[p("重置")]),_:1})]),_:1})]),_:1},8,["model"]),[[be,t(V)]]),e(U,{gutter:10,class:"mb8"},{default:l(()=>[e(_,{span:1.5},{default:l(()=>[b((i(),y(r,{type:"primary",plain:"",icon:"Plus",onClick:Y},{default:l(()=>[p("新增 ")]),_:1})),[[k,["hrm:env:add"]]])]),_:1}),e(ue,{showSearch:t(V),"onUpdate:showSearch":a[2]||(a[2]=n=>A(V)?V.value=n:null),onQueryTable:h},null,8,["showSearch"])]),_:1}),t(j)?b((i(),y(de,{key:0,border:"",data:t(L),"row-key":"envId","default-expand-all":t(K)},{default:l(()=>[e(f,{prop:"envId",label:"ID",width:"160"}),e(f,{prop:"envName",label:"环境名称",width:"200"}),e(f,{prop:"envUrl",label:"环境URL",width:"260"}),e(f,{prop:"orderNum",label:"排序",width:"200"}),e(f,{prop:"status",label:"状态",width:"100"},{default:l(n=>[e(se,{options:t(E),value:n.row.status},null,8,["options","value"])]),_:1}),e(f,{label:"创建时间",align:"center",prop:"createTime","class-name":"small-padding fixed-width"},{default:l(n=>[D("span",null,P(s.parseTime(n.row.createTime)),1)]),_:1}),e(f,{label:"更新时间",align:"center",prop:"updateTime","class-name":"small-padding fixed-width"},{default:l(n=>[D("span",null,P(s.parseTime(n.row.updateTime)),1)]),_:1}),e(f,{label:"操作",align:"center","class-name":"small-padding fixed-width",width:"110px"},{default:l(n=>[b(e(r,{link:"",type:"primary",icon:"Edit",onClick:w=>Z(n.row)},null,8,["onClick"]),[[k,["hrm:env:edit","hrm:env:detail"]]]),b(e(r,{link:"",type:"warning",icon:"CopyDocument",onClick:w=>ne(n.row)},null,8,["onClick"]),[[k,["hrm:env:copy"]]]),b(e(r,{link:"",type:"danger",icon:"Delete",onClick:w=>le(n.row)},null,8,["onClick"]),[[k,["hrm:env:remove"]]])]),_:1})]),_:1},8,["data","default-expand-all"])),[[ce,t($)]]):he("",!0),e(pe,{title:t(I),modelValue:t(c),"onUpdate:modelValue":a[8]||(a[8]=n=>A(c)?c.value=n:null),width:"70%","append-to-body":""},{footer:l(()=>[D("div",Re,[b((i(),y(r,{type:"primary",onClick:ee},{default:l(()=>[p("确 定")]),_:1})),[[k,["hrm:env:edit"]]]),e(r,{onClick:W},{default:l(()=>[p("取 消")]),_:1})])]),default:l(()=>[e(B,{ref:"envRef",model:t(o),rules:t(M),"label-width":"80px"},{default:l(()=>[e(U,null,{default:l(()=>[e(_,{span:12},{default:l(()=>[e(m,{label:"环境名称",prop:"envName"},{default:l(()=>[e(C,{modelValue:t(o).envName,"onUpdate:modelValue":a[3]||(a[3]=n=>t(o).envName=n),placeholder:"请输入环境名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(_,{span:12},{default:l(()=>[e(m,{label:"显示排序",prop:"orderNum"},{default:l(()=>[e(re,{modelValue:t(o).orderNum,"onUpdate:modelValue":a[4]||(a[4]=n=>t(o).orderNum=n),"controls-position":"right",min:0},null,8,["modelValue"])]),_:1})]),_:1}),e(_,{span:12},{default:l(()=>[e(m,{label:"环境地址",prop:"envUrl"},{default:l(()=>[e(C,{modelValue:t(o).envUrl,"onUpdate:modelValue":a[5]||(a[5]=n=>t(o).envUrl=n),placeholder:"请输入URL地址",maxlength:"200"},null,8,["modelValue"])]),_:1})]),_:1}),e(_,{span:12},{default:l(()=>[e(m,{label:"环境描述",prop:"simpleDesc"},{default:l(()=>[e(C,{modelValue:t(o).simpleDesc,"onUpdate:modelValue":a[6]||(a[6]=n=>t(o).simpleDesc=n),placeholder:"请输入描述",maxlength:"400"},null,8,["modelValue"])]),_:1})]),_:1}),e(_,{span:12},{default:l(()=>[e(m,{label:"环境状态"},{default:l(()=>[e(me,{modelValue:t(o).status,"onUpdate:modelValue":a[7]||(a[7]=n=>t(o).status=n)},{default:l(()=>[(i(!0),x(T,null,q(t(E),n=>(i(),y(ie,{key:n.value,value:n.value},{default:l(()=>[p(P(n.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(U,{style:{"padding-bottom":"20px"}},{default:l(()=>[e(_,null,{default:l(()=>[e(F,null,{default:l(()=>[p("添加环境分组：")]),_:1}),e(z,{content:"添加环境变量分组",placement:"top-start"},{default:l(()=>[e(r,{size:"small",type:"success",icon:"Plus",onClick:O})]),_:1})]),_:1})]),_:1}),e(U,null,{default:l(()=>[(i(!0),x(T,null,q(t(o).envConfig.variables,(n,w)=>(i(),y(_,{key:w,style:{"padding-bottom":"20px"}},{default:l(()=>[D("div",Ie,[e(F,null,{default:l(()=>[p("分组名称：")]),_:1}),e(Ee,{content:n.key,"onUpdate:content":N=>n.key=N},null,8,["content","onUpdate:content"]),e(z,{content:"删除环境变量分组",placement:"top-start"},{default:l(()=>[e(r,{size:"small",type:"danger",icon:"Delete",onClick:N=>H(w)},null,8,["onClick"])]),_:2},1024)]),e(De,{modelValue:n.value,"onUpdate:modelValue":N=>n.value=N},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024))),128))]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}});export{Fe as default};
