{"version":3,"file":"selectUser.BOadXIOW.js","sources":["../../../src/views/system/role/selectUser.vue"],"sourcesContent":["<template>\r\n   <!-- 授权用户 -->\r\n   <el-dialog title=\"选择用户\" v-model=\"visible\" width=\"800px\" top=\"5vh\" append-to-body>\r\n      <el-form :model=\"queryParams\" ref=\"queryRef\" :inline=\"true\">\r\n         <el-form-item label=\"用户名称\" prop=\"userName\">\r\n            <el-input\r\n               v-model=\"queryParams.userName\"\r\n               placeholder=\"请输入用户名称\"\r\n               clearable\r\n               style=\"width: 200px\"\r\n               @keyup.enter=\"handleQuery\"\r\n            />\r\n         </el-form-item>\r\n         <el-form-item label=\"手机号码\" prop=\"phonenumber\">\r\n            <el-input\r\n               v-model=\"queryParams.phonenumber\"\r\n               placeholder=\"请输入手机号码\"\r\n               clearable\r\n               style=\"width: 200px\"\r\n               @keyup.enter=\"handleQuery\"\r\n            />\r\n         </el-form-item>\r\n         <el-form-item>\r\n            <el-button type=\"primary\" icon=\"Search\" @click=\"handleQuery\">搜索</el-button>\r\n            <el-button icon=\"Refresh\" @click=\"resetQuery\">重置</el-button>\r\n         </el-form-item>\r\n      </el-form>\r\n      <el-row>\r\n         <el-table @row-click=\"clickRow\" ref=\"refTable\" :data=\"userList\" @selection-change=\"handleSelectionChange\" height=\"260px\">\r\n            <el-table-column type=\"selection\" width=\"55\"></el-table-column>\r\n            <el-table-column label=\"用户名称\" prop=\"userName\" :show-overflow-tooltip=\"true\" />\r\n            <el-table-column label=\"用户昵称\" prop=\"nickName\" :show-overflow-tooltip=\"true\" />\r\n            <el-table-column label=\"邮箱\" prop=\"email\" :show-overflow-tooltip=\"true\" />\r\n            <el-table-column label=\"手机\" prop=\"phonenumber\" :show-overflow-tooltip=\"true\" />\r\n            <el-table-column label=\"状态\" align=\"center\" prop=\"status\">\r\n               <template #default=\"scope\">\r\n                  <dict-tag :options=\"sys_normal_disable\" :value=\"scope.row.status\" />\r\n               </template>\r\n            </el-table-column>\r\n            <el-table-column label=\"创建时间\" align=\"center\" prop=\"createTime\" width=\"180\">\r\n               <template #default=\"scope\">\r\n                  <span>{{ parseTime(scope.row.createTime) }}</span>\r\n               </template>\r\n            </el-table-column>\r\n         </el-table>\r\n         <pagination\r\n            v-show=\"total > 0\"\r\n            :total=\"total\"\r\n            v-model:page=\"queryParams.pageNum\"\r\n            v-model:limit=\"queryParams.pageSize\"\r\n            @pagination=\"getList\"\r\n         />\r\n      </el-row>\r\n      <template #footer>\r\n         <div class=\"dialog-footer\">\r\n            <el-button type=\"primary\" @click=\"handleSelectUser\">确 定</el-button>\r\n            <el-button @click=\"visible = false\">取 消</el-button>\r\n         </div>\r\n      </template>\r\n   </el-dialog>\r\n</template>\r\n\r\n<script setup name=\"SelectUser\">\r\nimport { authUserSelectAll, unallocatedUserList } from \"@/api/system/role\";\r\n\r\nconst props = defineProps({\r\n  roleId: {\r\n    type: [Number, String]\r\n  }\r\n});\r\n\r\nconst { proxy } = getCurrentInstance();\r\nconst { sys_normal_disable } = proxy.useDict(\"sys_normal_disable\");\r\n\r\nconst userList = ref([]);\r\nconst visible = ref(false);\r\nconst total = ref(0);\r\nconst userIds = ref([]);\r\n\r\nconst queryParams = reactive({\r\n  pageNum: 1,\r\n  pageSize: 10,\r\n  roleId: undefined,\r\n  userName: undefined,\r\n  phonenumber: undefined\r\n});\r\n\r\n// 显示弹框\r\nfunction show() {\r\n  queryParams.roleId = props.roleId;\r\n  getList();\r\n  visible.value = true;\r\n}\r\n/**选择行 */\r\nfunction clickRow(row) {\r\n  proxy.$refs[\"refTable\"].toggleRowSelection(row);\r\n}\r\n// 多选框选中数据\r\nfunction handleSelectionChange(selection) {\r\n  userIds.value = selection.map(item => item.userId);\r\n}\r\n// 查询表数据\r\nfunction getList() {\r\n  unallocatedUserList(queryParams).then(res => {\r\n    userList.value = res.rows;\r\n    total.value = res.total;\r\n  });\r\n}\r\n/** 搜索按钮操作 */\r\nfunction handleQuery() {\r\n  queryParams.pageNum = 1;\r\n  getList();\r\n}\r\n/** 重置按钮操作 */\r\nfunction resetQuery() {\r\n  proxy.resetForm(\"queryRef\");\r\n  handleQuery();\r\n}\r\nconst emit = defineEmits([\"ok\"]);\r\n/** 选择授权用户操作 */\r\nfunction handleSelectUser() {\r\n  const roleId = queryParams.roleId;\r\n  const uIds = userIds.value.join(\",\");\r\n  if (uIds == \"\") {\r\n    proxy.$modal.msgError(\"请选择要分配的用户\");\r\n    return;\r\n  }\r\n  authUserSelectAll({ roleId: roleId, userIds: uIds }).then(res => {\r\n    proxy.$modal.msgSuccess(res.msg);\r\n    if (res.code === 200) {\r\n      visible.value = false;\r\n      emit(\"ok\");\r\n    }\r\n  });\r\n}\r\n\r\ndefineExpose({\r\n  show,\r\n});\r\n</script>\r\n"],"names":["props","__props","proxy","getCurrentInstance","sys_normal_disable","userList","ref","visible","total","userIds","queryParams","reactive","show","getList","clickRow","row","handleSelectionChange","selection","item","unallocatedUserList","res","handleQuery","resetQuery","emit","__emit","handleSelectUser","roleId","uIds","authUserSelectAll","__expose"],"mappings":"iWAiEA,MAAMA,EAAQC,EAMR,CAAE,MAAAC,CAAK,EAAKC,IACZ,CAAE,mBAAAC,CAAkB,EAAKF,EAAM,QAAQ,oBAAoB,EAE3DG,EAAWC,EAAI,CAAA,CAAE,EACjBC,EAAUD,EAAI,EAAK,EACnBE,EAAQF,EAAI,CAAC,EACbG,EAAUH,EAAI,CAAA,CAAE,EAEhBI,EAAcC,EAAS,CAC3B,QAAS,EACT,SAAU,GACV,OAAQ,OACR,SAAU,OACV,YAAa,MACf,CAAC,EAGD,SAASC,GAAO,CACdF,EAAY,OAASV,EAAM,OAC3Ba,IACAN,EAAQ,MAAQ,EAClB,CAEA,SAASO,EAASC,EAAK,CACrBb,EAAM,MAAM,SAAY,mBAAmBa,CAAG,CAChD,CAEA,SAASC,EAAsBC,EAAW,CACxCR,EAAQ,MAAQQ,EAAU,IAAIC,GAAQA,EAAK,MAAM,CACnD,CAEA,SAASL,GAAU,CACjBM,EAAoBT,CAAW,EAAE,KAAKU,GAAO,CAC3Cf,EAAS,MAAQe,EAAI,KACrBZ,EAAM,MAAQY,EAAI,KACtB,CAAG,CACH,CAEA,SAASC,GAAc,CACrBX,EAAY,QAAU,EACtBG,GACF,CAEA,SAASS,GAAa,CACpBpB,EAAM,UAAU,UAAU,EAC1BmB,GACF,CACA,MAAME,EAAOC,EAEb,SAASC,GAAmB,CAC1B,MAAMC,EAAShB,EAAY,OACrBiB,EAAOlB,EAAQ,MAAM,KAAK,GAAG,EACnC,GAAIkB,GAAQ,GAAI,CACdzB,EAAM,OAAO,SAAS,WAAW,EACjC,MACD,CACD0B,EAAkB,CAAE,OAAQF,EAAQ,QAASC,EAAM,EAAE,KAAKP,GAAO,CAC/DlB,EAAM,OAAO,WAAWkB,EAAI,GAAG,EAC3BA,EAAI,OAAS,MACfb,EAAQ,MAAQ,GAChBgB,EAAK,IAAI,EAEf,CAAG,CACH,CAEA,OAAAM,EAAa,CACX,KAAAjB,CACF,CAAC"}