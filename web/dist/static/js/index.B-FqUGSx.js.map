{"version":3,"file":"index.B-FqUGSx.js","sources":["../../../src/api/monitor/logininfor.js","../../../src/views/monitor/logininfor/index.vue"],"sourcesContent":["import request from '@/utils/request'\r\n\r\n// 查询登录日志列表\r\nexport function list(query) {\r\n  return request({\r\n    url: '/monitor/logininfor/list',\r\n    method: 'get',\r\n    params: query\r\n  })\r\n}\r\n\r\n// 删除登录日志\r\nexport function delLogininfor(infoId) {\r\n  return request({\r\n    url: '/monitor/logininfor/' + infoId,\r\n    method: 'delete'\r\n  })\r\n}\r\n\r\n// 解锁用户登录状态\r\nexport function unlockLogininfor(userName) {\r\n  return request({\r\n    url: '/monitor/logininfor/unlock/' + userName,\r\n    method: 'get'\r\n  })\r\n}\r\n\r\n// 清空登录日志\r\nexport function cleanLogininfor() {\r\n  return request({\r\n    url: '/monitor/logininfor/clean',\r\n    method: 'delete'\r\n  })\r\n}\r\n","<template>\r\n   <div class=\"app-container\">\r\n      <el-form :model=\"queryParams\" ref=\"queryRef\" :inline=\"true\" v-show=\"showSearch\" label-width=\"68px\">\r\n         <el-form-item label=\"登录地址\" prop=\"ipaddr\">\r\n            <el-input\r\n               v-model=\"queryParams.ipaddr\"\r\n               placeholder=\"请输入登录地址\"\r\n               clearable\r\n               style=\"width: 240px;\"\r\n               @keyup.enter=\"handleQuery\"\r\n            />\r\n         </el-form-item>\r\n         <el-form-item label=\"用户名称\" prop=\"userName\">\r\n            <el-input\r\n               v-model=\"queryParams.userName\"\r\n               placeholder=\"请输入用户名称\"\r\n               clearable\r\n               style=\"width: 240px;\"\r\n               @keyup.enter=\"handleQuery\"\r\n            />\r\n         </el-form-item>\r\n         <el-form-item label=\"状态\" prop=\"status\">\r\n            <el-select\r\n               v-model=\"queryParams.status\"\r\n               placeholder=\"登录状态\"\r\n               clearable\r\n               style=\"width: 240px\"\r\n            >\r\n               <el-option\r\n                  v-for=\"dict in sys_common_status\"\r\n                  :key=\"dict.value\"\r\n                  :label=\"dict.label\"\r\n                  :value=\"dict.value\"\r\n               />\r\n            </el-select>\r\n         </el-form-item>\r\n         <el-form-item label=\"登录时间\" style=\"width: 308px\">\r\n            <el-date-picker\r\n               v-model=\"dateRange\"\r\n               value-format=\"YYYY-MM-DD HH:mm:ss\"\r\n               type=\"daterange\"\r\n               range-separator=\"-\"\r\n               start-placeholder=\"开始日期\"\r\n               end-placeholder=\"结束日期\"\r\n               :default-time=\"[new Date(2000, 1, 1, 0, 0, 0), new Date(2000, 1, 1, 23, 59, 59)]\"\r\n            ></el-date-picker>\r\n         </el-form-item>\r\n         <el-form-item>\r\n            <el-button type=\"primary\" icon=\"Search\" @click=\"handleQuery\">搜索</el-button>\r\n            <el-button icon=\"Refresh\" @click=\"resetQuery\">重置</el-button>\r\n         </el-form-item>\r\n      </el-form>\r\n\r\n      <el-row :gutter=\"10\" class=\"mb8\">\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"danger\"\r\n               plain\r\n               icon=\"Delete\"\r\n               :disabled=\"multiple\"\r\n               @click=\"handleDelete\"\r\n               v-hasPermi=\"['monitor:logininfor:remove']\"\r\n            >删除</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"danger\"\r\n               plain\r\n               icon=\"Delete\"\r\n               @click=\"handleClean\"\r\n               v-hasPermi=\"['monitor:logininfor:remove']\"\r\n            >清空</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"primary\"\r\n               plain\r\n               icon=\"Unlock\"\r\n               :disabled=\"single\"\r\n               @click=\"handleUnlock\"\r\n               v-hasPermi=\"['monitor:logininfor:unlock']\"\r\n            >解锁</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"warning\"\r\n               plain\r\n               icon=\"Download\"\r\n               @click=\"handleExport\"\r\n               v-hasPermi=\"['monitor:logininfor:export']\"\r\n            >导出</el-button>\r\n         </el-col>\r\n         <right-toolbar v-model:showSearch=\"showSearch\" @queryTable=\"getList\"></right-toolbar>\r\n      </el-row>\r\n\r\n      <el-table ref=\"logininforRef\" v-loading=\"loading\" :data=\"logininforList\" @selection-change=\"handleSelectionChange\" :default-sort=\"defaultSort\" @sort-change=\"handleSortChange\">\r\n         <el-table-column type=\"selection\" width=\"55\" align=\"center\" />\r\n         <el-table-column label=\"访问编号\" align=\"center\" prop=\"infoId\" />\r\n         <el-table-column label=\"用户名称\" align=\"center\" prop=\"userName\" :show-overflow-tooltip=\"true\" sortable=\"custom\" :sort-orders=\"['descending', 'ascending']\" />\r\n         <el-table-column label=\"地址\" align=\"center\" prop=\"ipaddr\" :show-overflow-tooltip=\"true\" />\r\n         <el-table-column label=\"登录地点\" align=\"center\" prop=\"loginLocation\" :show-overflow-tooltip=\"true\" />\r\n         <el-table-column label=\"操作系统\" align=\"center\" prop=\"os\" :show-overflow-tooltip=\"true\" />\r\n         <el-table-column label=\"浏览器\" align=\"center\" prop=\"browser\" :show-overflow-tooltip=\"true\" />\r\n         <el-table-column label=\"登录状态\" align=\"center\" prop=\"status\">\r\n            <template #default=\"scope\">\r\n               <dict-tag :options=\"sys_common_status\" :value=\"scope.row.status\" />\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column label=\"描述\" align=\"center\" prop=\"msg\" :show-overflow-tooltip=\"true\" />\r\n         <el-table-column label=\"访问时间\" align=\"center\" prop=\"loginTime\" sortable=\"custom\" :sort-orders=\"['descending', 'ascending']\" width=\"180\">\r\n            <template #default=\"scope\">\r\n               <span>{{ parseTime(scope.row.loginTime) }}</span>\r\n            </template>\r\n         </el-table-column>\r\n      </el-table>\r\n\r\n      <pagination\r\n         v-show=\"total > 0\"\r\n         :total=\"total\"\r\n         v-model:page=\"queryParams.pageNum\"\r\n         v-model:limit=\"queryParams.pageSize\"\r\n         @pagination=\"getList\"\r\n      />\r\n   </div>\r\n</template>\r\n\r\n<script setup name=\"Logininfor\">\r\nimport { list, delLogininfor, cleanLogininfor, unlockLogininfor } from \"@/api/monitor/logininfor\";\r\n\r\nconst { proxy } = getCurrentInstance();\r\nconst { sys_common_status } = proxy.useDict(\"sys_common_status\");\r\n\r\nconst logininforList = ref([]);\r\nconst loading = ref(true);\r\nconst showSearch = ref(true);\r\nconst ids = ref([]);\r\nconst single = ref(true);\r\nconst multiple = ref(true);\r\nconst selectName = ref(\"\");\r\nconst total = ref(0);\r\nconst dateRange = ref([]);\r\nconst defaultSort = ref({ prop: \"loginTime\", order: \"descending\" });\r\n\r\n// 查询参数\r\nconst queryParams = ref({\r\n  pageNum: 1,\r\n  pageSize: 10,\r\n  ipaddr: undefined,\r\n  userName: undefined,\r\n  status: undefined,\r\n  orderByColumn: undefined,\r\n  isAsc: undefined\r\n});\r\n\r\n/** 查询登录日志列表 */\r\nfunction getList() {\r\n  loading.value = true;\r\n  list(proxy.addDateRange(queryParams.value, dateRange.value)).then(response => {\r\n    logininforList.value = response.rows;\r\n    total.value = response.total;\r\n    loading.value = false;\r\n  });\r\n}\r\n/** 搜索按钮操作 */\r\nfunction handleQuery() {\r\n  queryParams.value.pageNum = 1;\r\n  getList();\r\n}\r\n/** 重置按钮操作 */\r\nfunction resetQuery() {\r\n  dateRange.value = [];\r\n  proxy.resetForm(\"queryRef\");\r\n  queryParams.value.pageNum = 1;\r\n  proxy.$refs[\"logininforRef\"].sort(defaultSort.value.prop, defaultSort.value.order);\r\n}\r\n/** 多选框选中数据 */\r\nfunction handleSelectionChange(selection) {\r\n  ids.value = selection.map(item => item.infoId);\r\n  multiple.value = !selection.length;\r\n  single.value = selection.length != 1;\r\n  selectName.value = selection.map(item => item.userName);\r\n}\r\n/** 排序触发事件 */\r\nfunction handleSortChange(column, prop, order) {\r\n  queryParams.value.orderByColumn = column.prop;\r\n  queryParams.value.isAsc = column.order;\r\n  getList();\r\n}\r\n/** 删除按钮操作 */\r\nfunction handleDelete(row) {\r\n  const infoIds = row.infoId || ids.value;\r\n  proxy.$modal.confirm('是否确认删除访问编号为\"' + infoIds + '\"的数据项?').then(function () {\r\n    return delLogininfor(infoIds);\r\n  }).then(() => {\r\n    getList();\r\n    proxy.$modal.msgSuccess(\"删除成功\");\r\n  }).catch(() => {});\r\n}\r\n/** 清空按钮操作 */\r\nfunction handleClean() {\r\n  proxy.$modal.confirm(\"是否确认清空所有登录日志数据项?\").then(function () {\r\n    return cleanLogininfor();\r\n  }).then(() => {\r\n    getList();\r\n    proxy.$modal.msgSuccess(\"清空成功\");\r\n  }).catch(() => {});\r\n}\r\n/** 解锁按钮操作 */\r\nfunction handleUnlock() {\r\n  const username = selectName.value;\r\n  proxy.$modal.confirm('是否确认解锁用户\"' + username + '\"数据项?').then(function () {\r\n    return unlockLogininfor(username);\r\n  }).then(() => {\r\n    proxy.$modal.msgSuccess(\"用户\" + username + \"解锁成功\");\r\n  }).catch(() => {});\r\n}\r\n/** 导出按钮操作 */\r\nfunction handleExport() {\r\n  proxy.download(\"monitor/logininfor/export\", {\r\n    ...queryParams.value,\r\n  }, `config_${new Date().getTime()}.xlsx`);\r\n}\r\n\r\ngetList();\r\n</script>\r\n"],"names":["list","query","request","delLogininfor","infoId","unlockLogininfor","userName","cleanLogininfor","proxy","getCurrentInstance","sys_common_status","logininforList","ref","loading","showSearch","ids","single","multiple","selectName","total","dateRange","defaultSort","queryParams","getList","response","handleQuery","resetQuery","handleSelectionChange","selection","item","handleSortChange","column","prop","order","handleDelete","row","infoIds","handleClean","handleUnlock","username","handleExport"],"mappings":"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"}