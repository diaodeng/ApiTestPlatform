{"version":3,"file":"index.BH8LV6tq.js","sources":["../../../src/components/hrm/common/echarts.vue"],"sourcesContent":["<script setup>\r\nimport * as echarts from 'echarts'\r\nimport {countInfo} from \"@/api/hrm/report.js\"\r\nimport {Pear} from \"@element-plus/icons-vue\";\r\n\r\nconst echartsRef = ref(null);\r\nlet echartInstance = null;\r\nconst loading = ref(false);\r\n\r\nconst options = ref({\r\n  tooltip: {\r\n    trigger: 'axis',\r\n    axisPointer: {\r\n      type: 'cross',\r\n      crossStyle: {\r\n        color: '#999'\r\n      }\r\n    }\r\n  },\r\n  toolbox: {\r\n    feature: {\r\n      dataView: {show: false, readOnly: false},\r\n      magicType: {show: true, type: ['line', 'bar']},\r\n      restore: {show: true},\r\n      saveAsImage: {show: true}\r\n    }\r\n  },\r\n  legend: {\r\n    data: ['失败用例', '成功用例', '通过率']\r\n  },\r\n  xAxis: [\r\n    {\r\n      type: 'category',\r\n      data: [],\r\n      axisPointer: {\r\n        type: 'shadow'\r\n      }\r\n    }\r\n  ],\r\n  yAxis: [\r\n    {\r\n      type: 'value',\r\n      name: '个数',\r\n      min: 0,\r\n      max: 100,\r\n      interval: 10,\r\n      axisLabel: {\r\n        formatter: '{value} '\r\n      }\r\n    },\r\n    {\r\n      type: 'value',\r\n      name: '成功率',\r\n      min: 0,\r\n      max: 100,\r\n      interval: 10,\r\n      axisLabel: {\r\n        formatter: '% {value}'\r\n      }\r\n    }\r\n  ],\r\n  series: [\r\n    {\r\n      name: '失败用例',\r\n      type: 'bar',\r\n      data: [0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0]\r\n    },\r\n    {\r\n      name: '通过率',\r\n      type: 'line',\r\n      yAxisIndex: 1,\r\n      data: [0, 0, 90, 0, 0, 0, 0, 0, 0, 0, 0, 0]\r\n    },\r\n    {\r\n      name: '成功用例',\r\n      type: 'bar',\r\n      data: [0, 0, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0]\r\n    }\r\n  ]\r\n});\r\n\r\nconst responseData = ref({});\r\n\r\nlet option1 = {\r\n  title: {\r\n    text: 'ECharts 入门示例'\r\n  },\r\n  tooltip: {},\r\n  legend: {\r\n    data: ['销量']\r\n  },\r\n  xAxis: {\r\n    data: ['衬衫', '羊毛衫', '雪纺衫', '裤子', '高跟鞋', '袜子']\r\n  },\r\n  yAxis: {},\r\n  series: [{\r\n    name: '销量',\r\n    type: 'bar',\r\n    data: [5, 20, 36, 10, 10, 20]\r\n  }]\r\n}\r\n\r\n\r\nfunction get_date_xAxis() {\r\n  let data = [];\r\n  for (var i = 0; i < 12; i++) {\r\n    data[i] = getDay(i)\r\n  }\r\n  return data.reverse();\r\n}\r\n\r\nfunction getDay(day) {\r\n  let today = new Date();\r\n  let targetday_milliseconds = today.getTime() + 1000 * 60 * 60 * 24 * day * -1;\r\n  today.setTime(targetday_milliseconds); //注意，这行是关键代码\r\n  let tYear = today.getFullYear();\r\n  let tMonth = today.getMonth();\r\n  let tDate = today.getDate();\r\n  tMonth = doHandleMonth(tMonth + 1);\r\n  tDate = doHandleMonth(tDate);\r\n  return tYear + \"-\" + tMonth + \"-\" + tDate;\r\n}\r\n\r\nfunction doHandleMonth(month) {\r\n  let m = month;\r\n  if (month.toString().length === 1) {\r\n    m = \"0\" + month;\r\n  }\r\n  return m;\r\n}\r\n\r\nonMounted(async () => {\r\n  loading.value = true;\r\n  countInfo().then((res) => {\r\n\r\n    let data = res.data;\r\n    responseData.value = data;\r\n    let pass = data.total.pass;\r\n    let fail = data.total.fail;\r\n    // let total = data.total;\r\n    let pass_rate = data.total.percent;\r\n    let xAxis_data = get_date_xAxis();\r\n    options.value.xAxis[0].data = xAxis_data;\r\n    options.value.series[0].data = fail;\r\n    options.value.series[1].data = pass_rate;\r\n    options.value.series[2].data = pass;\r\n\r\n\r\n    let max_fail = Math.max.apply(null, options.value.series[0].data);\r\n    let max_pass = Math.max.apply(null, options.value.series[2].data);\r\n\r\n    if (Math.max(max_fail, max_pass) > 100) {\r\n      options.value.yAxis[0].max = Math.max(max_fail, max_pass) + 10;\r\n      options.value.yAxis[0].interval = parseInt(Math.max(max_fail, max_pass) / 10);\r\n    }\r\n\r\n    // await nextTick();\r\n    echartInstance = echarts.init(echartsRef.value);\r\n    echartInstance.setOption(options.value, true);\r\n  }).finally(() => {\r\n    loading.value = false;\r\n  });\r\n\r\n\r\n  window.addEventListener('resize', () => {\r\n    echartInstance.resize()\r\n  }, false);\r\n\r\n});\r\n\r\nonUnmounted(() => {\r\n  if (echartInstance != null && echartInstance.dispose) {\r\n    echartInstance.dispose();\r\n  }\r\n\r\n});\r\n\r\n\r\n</script>\r\n\r\n<template>\r\n  <!--  <div>{{options}}</div>-->\r\n  <div style=\"width: 100%;height: 100%;display: flex;flex-direction: column;align-items: stretch;padding-top: 10px\"\r\n       v-loading=\"loading\">\r\n    <el-row justify=\"space-evenly\">\r\n      <el-card style=\"width: 20%\" shadow=\"hover\">\r\n        <div style=\"display: flex;flex-direction: row\">\r\n          <div>\r\n            <el-icon size=\"50\" color=\"#2BE5BFFF\" style=\"color:#efd110;\">\r\n              <UserFilled></UserFilled>\r\n            </el-icon>\r\n          </div>\r\n          <div>\r\n            <el-statistic :value=\"responseData.projectCount\">\r\n              <template #title>\r\n                <div style=\"display: inline-flex; align-items: center\">\r\n                  项目\r\n                  <el-tooltip\r\n                      effect=\"dark\"\r\n                      content=\"项目总数\"\r\n                      placement=\"top\"\r\n                  >\r\n                    <el-icon style=\"margin-left: 4px\" :size=\"12\">\r\n                      <Warning/>\r\n                    </el-icon>\r\n                  </el-tooltip>\r\n                </div>\r\n              </template>\r\n            </el-statistic>\r\n          </div>\r\n        </div>\r\n      </el-card>\r\n      <el-card style=\"width: 20%\" shadow=\"hover\">\r\n        <div style=\"display: flex\">\r\n          <div>\r\n            <el-icon size=\"50\" color=\"#EA5959FF\">\r\n              <HelpFilled></HelpFilled>\r\n            </el-icon>\r\n          </div>\r\n          <div>\r\n            <el-statistic :value=\"responseData.moduleCount\">\r\n              <template #title>\r\n                <div style=\"display: inline-flex; align-items: center\">\r\n                  模块\r\n                  <el-tooltip\r\n                      effect=\"dark\"\r\n                      content=\"模块总数\"\r\n                      placement=\"top\"\r\n                  >\r\n                    <el-icon style=\"margin-left: 4px\" :size=\"12\">\r\n                      <Warning/>\r\n                    </el-icon>\r\n                  </el-tooltip>\r\n                </div>\r\n              </template>\r\n            </el-statistic>\r\n          </div>\r\n        </div>\r\n      </el-card>\r\n      <el-card style=\"width: 20%\" shadow=\"hover\">\r\n        <div style=\"display:flex;\">\r\n          <div>\r\n            <el-icon size=\"50\" color=\"#19C6EFFF\">\r\n              <Histogram></Histogram>\r\n            </el-icon>\r\n          </div>\r\n          <div>\r\n            <el-statistic :value=\"responseData.caseCount\">\r\n              <template #title>\r\n                <div style=\"display: inline-flex; align-items: center\">\r\n                  用例\r\n                  <el-tooltip\r\n                      effect=\"dark\"\r\n                      content=\"用例总数\"\r\n                      placement=\"top\"\r\n                  >\r\n                    <el-icon style=\"margin-left: 4px\" :size=\"12\">\r\n                      <Warning/>\r\n                    </el-icon>\r\n                  </el-tooltip>\r\n                </div>\r\n              </template>\r\n            </el-statistic>\r\n          </div>\r\n        </div>\r\n\r\n      </el-card>\r\n      <el-card style=\"width: 20%\" shadow=\"hover\">\r\n        <div style=\"display: flex\">\r\n          <div>\r\n            <el-icon size=\"50\" color=\"#EFD110FF\">\r\n              <Operation></Operation>\r\n            </el-icon>\r\n          </div>\r\n          <div>\r\n            <el-statistic :value=\"responseData.suiteCount\">\r\n              <template #title>\r\n                <div style=\"display: inline-flex; align-items: center\">\r\n                  套件\r\n                  <el-tooltip\r\n                      effect=\"dark\"\r\n                      content=\"套件总数\"\r\n                      placement=\"top\"\r\n                  >\r\n                    <el-icon style=\"margin-left: 4px\" :size=\"12\">\r\n                      <Warning/>\r\n                    </el-icon>\r\n                  </el-tooltip>\r\n                </div>\r\n              </template>\r\n            </el-statistic>\r\n          </div>\r\n        </div>\r\n      </el-card>\r\n    </el-row>\r\n    <div class=\"echarts\" ref=\"echartsRef\" style=\"width: 100%;flex-grow: 1\">\r\n\r\n    </div>\r\n  </div>\r\n\r\n</template>\r\n\r\n<style scoped lang=\"scss\">\r\n.echarts {\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n</style>"],"names":["echartsRef","ref","echartInstance","loading","options","responseData","get_date_xAxis","data","i","getDay","day","today","targetday_milliseconds","tYear","tMonth","tDate","doHandleMonth","month","m","onMounted","countInfo","res","pass","fail","pass_rate","xAxis_data","max_fail","max_pass","echarts.init","onUnmounted"],"mappings":"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"}