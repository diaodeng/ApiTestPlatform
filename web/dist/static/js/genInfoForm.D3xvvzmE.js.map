{"version":3,"file":"genInfoForm.D3xvvzmE.js","sources":["../../../src/views/tool/gen/genInfoForm.vue"],"sourcesContent":["<template>\r\n  <el-form ref=\"genInfoForm\" :model=\"info\" :rules=\"rules\" label-width=\"150px\">\r\n    <el-row>\r\n      <el-col :span=\"12\">\r\n        <el-form-item prop=\"tplCategory\">\r\n          <template #label>生成模板</template>\r\n          <el-select v-model=\"info.tplCategory\" @change=\"tplSelectChange\">\r\n            <el-option label=\"单表（增删改查）\" value=\"crud\" />\r\n            <el-option label=\"树表（增删改查）\" value=\"tree\" />\r\n            <el-option label=\"主子表（增删改查）\" value=\"sub\" />\r\n          </el-select>\r\n        </el-form-item>\r\n      </el-col>\r\n\r\n      <el-col :span=\"12\">\r\n        <el-form-item prop=\"tplWebType\">\r\n          <template #label>前端类型</template>\r\n          <el-select v-model=\"info.tplWebType\">\r\n            <el-option label=\"Vue2 Element UI 模版\" value=\"element-ui\" />\r\n            <el-option label=\"Vue3 Element Plus 模版\" value=\"element-plus\" />\r\n          </el-select>\r\n        </el-form-item>\r\n      </el-col>\r\n\r\n      <el-col :span=\"12\">\r\n        <el-form-item prop=\"packageName\">\r\n          <template #label>\r\n            生成包路径\r\n            <el-tooltip content=\"生成在哪个java包下，例如 com.ruoyi.system\" placement=\"top\">\r\n              <el-icon><question-filled /></el-icon>\r\n            </el-tooltip>\r\n          </template>\r\n          <el-input v-model=\"info.packageName\" />\r\n        </el-form-item>\r\n      </el-col>\r\n\r\n      <el-col :span=\"12\">\r\n        <el-form-item prop=\"moduleName\">\r\n          <template #label>\r\n            生成模块名\r\n            <el-tooltip content=\"可理解为子系统名，例如 system\" placement=\"top\">\r\n              <el-icon><question-filled /></el-icon>\r\n            </el-tooltip>\r\n          </template>\r\n          <el-input v-model=\"info.moduleName\" />\r\n        </el-form-item>\r\n      </el-col>\r\n\r\n      <el-col :span=\"12\">\r\n        <el-form-item prop=\"businessName\">\r\n          <template #label>\r\n            生成业务名\r\n            <el-tooltip content=\"可理解为功能英文名，例如 user\" placement=\"top\">\r\n              <el-icon><question-filled /></el-icon>\r\n            </el-tooltip>\r\n          </template>\r\n          <el-input v-model=\"info.businessName\" />\r\n        </el-form-item>\r\n      </el-col>\r\n\r\n      <el-col :span=\"12\">\r\n        <el-form-item prop=\"functionName\">\r\n          <template #label>\r\n            生成功能名\r\n            <el-tooltip content=\"用作类描述，例如 用户\" placement=\"top\">\r\n              <el-icon><question-filled /></el-icon>\r\n            </el-tooltip>\r\n          </template>\r\n          <el-input v-model=\"info.functionName\" />\r\n        </el-form-item>\r\n      </el-col>\r\n\r\n      <el-col :span=\"12\">\r\n        <el-form-item prop=\"genType\">\r\n          <template #label>\r\n            生成代码方式\r\n            <el-tooltip content=\"默认为zip压缩包下载，也可以自定义生成路径\" placement=\"top\">\r\n              <el-icon><question-filled /></el-icon>\r\n            </el-tooltip>\r\n          </template>\r\n          <el-radio v-model=\"info.genType\" label=\"0\">zip压缩包</el-radio>\r\n          <el-radio v-model=\"info.genType\" label=\"1\">自定义路径</el-radio>\r\n        </el-form-item>\r\n      </el-col>\r\n\r\n      <el-col :span=\"12\">\r\n        <el-form-item>\r\n          <template #label>\r\n            上级菜单\r\n            <el-tooltip content=\"分配到指定菜单下，例如 系统管理\" placement=\"top\">\r\n              <el-icon><question-filled /></el-icon>\r\n            </el-tooltip>\r\n          </template>\r\n          <tree-select\r\n            v-model:value=\"info.parentMenuId\"\r\n            :options=\"menuOptions\"\r\n            :objMap=\"{ value: 'menuId', label: 'menuName', children: 'children' }\"\r\n            placeholder=\"请选择系统菜单\"\r\n          />\r\n        </el-form-item>\r\n      </el-col>\r\n\r\n      <el-col :span=\"24\" v-if=\"info.genType == '1'\">\r\n        <el-form-item prop=\"genPath\">\r\n          <template #label>\r\n            自定义路径\r\n            <el-tooltip content=\"填写磁盘绝对路径，若不填写，则生成到当前Web项目下\" placement=\"top\">\r\n              <el-icon><question-filled /></el-icon>\r\n            </el-tooltip>\r\n          </template>\r\n          <el-input v-model=\"info.genPath\">\r\n            <template #append>\r\n              <el-dropdown>\r\n                <el-button type=\"primary\">\r\n                  最近路径快速选择\r\n                  <i class=\"el-icon-arrow-down el-icon--right\"></i>\r\n                </el-button>\r\n                <template #dropdown>\r\n                  <el-dropdown-menu>\r\n                    <el-dropdown-item @click=\"info.genPath = '/'\">恢复默认的生成基础路径</el-dropdown-item>\r\n                  </el-dropdown-menu>\r\n                </template>\r\n              </el-dropdown>\r\n            </template>\r\n          </el-input>\r\n        </el-form-item>\r\n      </el-col>\r\n    </el-row>\r\n    \r\n    <template v-if=\"info.tplCategory == 'tree'\">\r\n      <h4 class=\"form-header\">其他信息</h4>\r\n      <el-row v-show=\"info.tplCategory == 'tree'\">\r\n        <el-col :span=\"12\">\r\n          <el-form-item>\r\n            <template #label>\r\n              树编码字段\r\n              <el-tooltip content=\"树显示的编码字段名， 如：dept_id\" placement=\"top\">\r\n                <el-icon><question-filled /></el-icon>\r\n              </el-tooltip>\r\n            </template>\r\n            <el-select v-model=\"info.treeCode\" placeholder=\"请选择\">\r\n              <el-option\r\n                v-for=\"(column, index) in info.columns\"\r\n                :key=\"index\"\r\n                :label=\"column.columnName + '：' + column.columnComment\"\r\n                :value=\"column.columnName\"\r\n              ></el-option>\r\n            </el-select>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"12\">\r\n          <el-form-item>\r\n            <template #label>\r\n              树父编码字段\r\n              <el-tooltip content=\"树显示的父编码字段名， 如：parent_Id\" placement=\"top\">\r\n                <el-icon><question-filled /></el-icon>\r\n              </el-tooltip>\r\n            </template>\r\n            <el-select v-model=\"info.treeParentCode\" placeholder=\"请选择\">\r\n              <el-option\r\n                v-for=\"(column, index) in info.columns\"\r\n                :key=\"index\"\r\n                :label=\"column.columnName + '：' + column.columnComment\"\r\n                :value=\"column.columnName\"\r\n              ></el-option>\r\n            </el-select>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"12\">\r\n          <el-form-item>\r\n            <template #label>\r\n              树名称字段\r\n              <el-tooltip content=\"树节点的显示名称字段名， 如：dept_name\" placement=\"top\">\r\n                <el-icon><question-filled /></el-icon>\r\n              </el-tooltip>\r\n            </template>\r\n            <el-select v-model=\"info.treeName\" placeholder=\"请选择\">\r\n              <el-option\r\n                v-for=\"(column, index) in info.columns\"\r\n                :key=\"index\"\r\n                :label=\"column.columnName + '：' + column.columnComment\"\r\n                :value=\"column.columnName\"\r\n              ></el-option>\r\n            </el-select>\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n    </template>\r\n\r\n    <template v-if=\"info.tplCategory == 'sub'\">\r\n      <h4 class=\"form-header\">关联信息</h4>\r\n      <el-row>\r\n        <el-col :span=\"12\">\r\n          <el-form-item>\r\n            <template #label>\r\n              关联子表的表名\r\n              <el-tooltip content=\"关联子表的表名， 如：sys_user\" placement=\"top\">\r\n                <el-icon><question-filled /></el-icon>\r\n              </el-tooltip>\r\n            </template>\r\n            <el-select v-model=\"info.subTableName\" placeholder=\"请选择\" @change=\"subSelectChange\">\r\n              <el-option\r\n                v-for=\"(table, index) in tables\"\r\n                :key=\"index\"\r\n                :label=\"table.tableName + '：' + table.tableComment\"\r\n                :value=\"table.tableName\"\r\n              ></el-option>\r\n            </el-select>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"12\">\r\n          <el-form-item>\r\n            <template #label>\r\n              子表关联的外键名\r\n              <el-tooltip content=\"子表关联的外键名， 如：user_id\" placement=\"top\">\r\n                <el-icon><question-filled /></el-icon>\r\n              </el-tooltip>\r\n            </template>\r\n            <el-select v-model=\"info.subTableFkName\" placeholder=\"请选择\">\r\n              <el-option\r\n                v-for=\"(column, index) in subColumns\"\r\n                :key=\"index\"\r\n                :label=\"column.columnName + '：' + column.columnComment\"\r\n                :value=\"column.columnName\"\r\n              ></el-option>\r\n            </el-select>\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n    </template>\r\n\r\n  </el-form>\r\n</template>\r\n\r\n<script setup>\r\nimport { listMenu } from \"@/api/system/menu\";\r\n\r\nconst subColumns = ref([]);\r\nconst menuOptions = ref([]);\r\nconst { proxy } = getCurrentInstance();\r\n\r\nconst props = defineProps({\r\n  info: {\r\n    type: Object,\r\n    default: null\r\n  },\r\n  tables: {\r\n    type: Array,\r\n    default: null\r\n  }\r\n});\r\n\r\n// 表单校验\r\nconst rules = ref({\r\n  tplCategory: [{ required: true, message: \"请选择生成模板\", trigger: \"blur\" }],\r\n  packageName: [{ required: true, message: \"请输入生成包路径\", trigger: \"blur\" }],\r\n  moduleName: [{ required: true, message: \"请输入生成模块名\", trigger: \"blur\" }],\r\n  businessName: [{ required: true, message: \"请输入生成业务名\", trigger: \"blur\" }],\r\n  functionName: [{ required: true, message: \"请输入生成功能名\", trigger: \"blur\" }]\r\n});\r\nfunction subSelectChange(value) {\r\n  props.info.subTableFkName = \"\";\r\n}\r\nfunction tplSelectChange(value) {\r\n  if (value !== \"sub\") {\r\n    props.info.subTableName = \"\";\r\n    props.info.subTableFkName = \"\";\r\n  }\r\n}\r\nfunction setSubTableColumns(value) {\r\n  for (var item in props.tables) {\r\n    const name = props.tables[item].tableName;\r\n    if (value === name) {\r\n      subColumns.value = props.tables[item].columns;\r\n      break;\r\n    }\r\n  }\r\n}\r\n/** 查询菜单下拉树结构 */\r\nfunction getMenuTreeselect() {\r\n  listMenu().then(response => {\r\n    menuOptions.value = proxy.handleTree(response.data, \"menuId\");\r\n  });\r\n}\r\n\r\nwatch(() => props.info.subTableName, val => {\r\n  setSubTableColumns(val);\r\n});\r\n\r\nwatch(() => props.info.tplWebType, val => {\r\n  if (val === '') {\r\n    props.info.tplWebType = \"element-plus\";\r\n  }\r\n});\r\n\r\ngetMenuTreeselect();\r\n</script>\r\n"],"names":["subColumns","ref","menuOptions","proxy","getCurrentInstance","props","__props","rules","subSelectChange","value","tplSelectChange","setSubTableColumns","item","name","getMenuTreeselect","listMenu","response","watch","val"],"mappings":"0SA6OA,MAAMA,EAAaC,EAAI,CAAA,CAAE,EACnBC,EAAcD,EAAI,CAAA,CAAE,EACpB,CAAE,MAAAE,CAAK,EAAKC,IAEZC,EAAQC,EAYRC,EAAQN,EAAI,CAChB,YAAa,CAAC,CAAE,SAAU,GAAM,QAAS,UAAW,QAAS,OAAQ,EACrE,YAAa,CAAC,CAAE,SAAU,GAAM,QAAS,WAAY,QAAS,OAAQ,EACtE,WAAY,CAAC,CAAE,SAAU,GAAM,QAAS,WAAY,QAAS,OAAQ,EACrE,aAAc,CAAC,CAAE,SAAU,GAAM,QAAS,WAAY,QAAS,OAAQ,EACvE,aAAc,CAAC,CAAE,SAAU,GAAM,QAAS,WAAY,QAAS,OAAQ,CACzE,CAAC,EACD,SAASO,EAAgBC,EAAO,CAC9BJ,EAAM,KAAK,eAAiB,EAC9B,CACA,SAASK,EAAgBD,EAAO,CAC1BA,IAAU,QACZJ,EAAM,KAAK,aAAe,GAC1BA,EAAM,KAAK,eAAiB,GAEhC,CACA,SAASM,EAAmBF,EAAO,CACjC,QAASG,KAAQP,EAAM,OAAQ,CAC7B,MAAMQ,EAAOR,EAAM,OAAOO,CAAI,EAAE,UAChC,GAAIH,IAAUI,EAAM,CAClBb,EAAW,MAAQK,EAAM,OAAOO,CAAI,EAAE,QACtC,KACD,CACF,CACH,CAEA,SAASE,GAAoB,CAC3BC,EAAU,EAAC,KAAKC,GAAY,CAC1Bd,EAAY,MAAQC,EAAM,WAAWa,EAAS,KAAM,QAAQ,CAChE,CAAG,CACH,CAEA,OAAAC,EAAM,IAAMZ,EAAM,KAAK,aAAca,GAAO,CAC1CP,EAAmBO,CAAG,CACxB,CAAC,EAEDD,EAAM,IAAMZ,EAAM,KAAK,WAAYa,GAAO,CACpCA,IAAQ,KACVb,EAAM,KAAK,WAAa,eAE5B,CAAC,EAEDS"}