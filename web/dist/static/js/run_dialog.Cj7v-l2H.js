import{_ as X,t as j}from"./env-selector.CY0X6zlK.js";import{b as q}from"./forward.Bd-7Bd9U.js";import{a as z}from"./agent.Dph-1RM_.js";import{av as G,A as x,r as i,w as J,C as K,d as u,H as Q,o as f,m as g,f as n,i as B,e as t,p as U,h as a,I as W,c as R,O as A,P as M,aX as Y,au as S}from"./index.DgyczuKs.js";const Z={style:{display:"flex","flex-direction":"row","flex-grow":"1"}},ee={class:"dialog-footer"},ne={__name:"run_dialog",props:G({runType:Number,showDialog:{type:Boolean,default:!1}},{dialogVisible:{},dialogVisibleModifiers:{},runIds:{},runIdsModifiers:{}}),emits:["update:dialogVisible","update:runIds"],setup(v){const d=x(v,"dialogVisible"),T=x(v,"runIds"),w=i([]),y=i([]),h=v,V=i(!1),m=i(!0),p=i(!1),o=i({ids:T,runType:h.runType,env:null,reportName:null,isAsync:!1,repeatNum:1,concurrent:1,push:!1,forwardConfig:{forward:!1,agentId:void 0,forwardRuleIds:void 0},runBySort:!1});function D(r){try{if(p.value=!0,m.value=!1,o.value.ids.length===0){S.error({message:"请选择要执行的数据",type:"error"}),m.value=!0,p.value=!1;return}V.value=!0,j(o.value).then(e=>{S.success({message:e.msg,type:"success"}),d.value=!1}).finally(()=>{V.value=!1,m.value=!0,p.value=!1})}catch(e){console.log(e)}finally{}}function E(){q().then(r=>{w.value=r.data})}function F(){z().then(r=>{y.value=r.rows})}function C(){m.value=!0,d.value=!1}function L(r){m?(r(),d.value=!1):(r(!1),d.value=!0)}return J(()=>o.value.runBySort,r=>{o.value.runBySort&&(o.value.concurrent=1)}),K(()=>{E(),F()}),(r,e)=>{const s=u("el-form-item"),$=u("el-input"),I=u("el-input-number"),c=u("el-option"),_=u("el-select"),b=u("el-checkbox"),N=u("el-col"),H=u("el-row"),O=u("el-form"),k=u("el-button"),P=Q("loading");return f(),g(a(Y),{modelValue:d.value,"onUpdate:modelValue":e[10]||(e[10]=l=>d.value=l),title:"测试确认",width:"500","append-to-body":"",onClose:C,"before-close":L,"close-on-click-modal":!1,"close-on-press-escape":!1},{footer:n(()=>[B("div",ee,[t(k,{onClick:C},{default:n(()=>e[11]||(e[11]=[U("取消")])),_:1}),t(k,{disabled:a(p),type:"primary",onClick:D},{default:n(()=>e[12]||(e[12]=[U(" 执行 ")])),_:1},8,["disabled"])])]),default:n(()=>[W((f(),g(O,{model:a(o)},{default:n(()=>[t(s,{label:"测试环境："},{default:n(()=>[t(X,{"selected-env":a(o).env,"onUpdate:selectedEnv":e[0]||(e[0]=l=>a(o).env=l),"selector-width":"100%"},null,8,["selected-env"])]),_:1}),t(s,{label:"报告名称："},{default:n(()=>[t($,{modelValue:a(o).reportName,"onUpdate:modelValue":e[1]||(e[1]=l=>a(o).reportName=l),autocomplete:"off",placeholder:"报告名称，默认为执行时间"},null,8,["modelValue"])]),_:1}),t(s,{label:"执行次数："},{default:n(()=>[t(I,{min:1,"controls-position":"right",modelValue:a(o).repeatNum,"onUpdate:modelValue":e[2]||(e[2]=l=>a(o).repeatNum=l)},null,8,["modelValue"])]),_:1}),t(s,{label:"同步执行："},{default:n(()=>[t(_,{modelValue:a(o).isAsync,"onUpdate:modelValue":e[3]||(e[3]=l=>a(o).isAsync=l),placeholder:"选择本次执行方式"},{default:n(()=>[t(c,{label:"同步",value:!1}),t(c,{label:"异步",value:!0})]),_:1},8,["modelValue"])]),_:1}),t(s,{label:"并发数量："},{default:n(()=>[t(I,{min:1,"controls-position":"right",modelValue:a(o).concurrent,"onUpdate:modelValue":e[4]||(e[4]=l=>a(o).concurrent=l),placeholder:"输入并发执行的用例数量",disabled:a(o).runBySort},null,8,["modelValue","disabled"])]),_:1}),t(s,{label:"转发配置："},{default:n(()=>[B("div",Z,[t(b,{modelValue:a(o).forwardConfig.forward,"onUpdate:modelValue":e[5]||(e[5]=l=>a(o).forwardConfig.forward=l),style:{"margin-right":"20px"}},null,8,["modelValue"]),t(H,{style:{"flex-grow":"1"},gutter:10},{default:n(()=>[t(N,{span:12},{default:n(()=>[t(_,{placeholder:"请选择客户机",modelValue:a(o).forwardConfig.agentId,"onUpdate:modelValue":e[6]||(e[6]=l=>a(o).forwardConfig.agentId=l)},{default:n(()=>[(f(!0),R(A,null,M(a(y),l=>(f(),g(c,{key:l.agentId,label:l.agentName,value:l.agentId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(N,{span:12},{default:n(()=>[t(_,{multiple:"",placeholder:"请选择转发规则",modelValue:a(o).forwardConfig.forwardRuleIds,"onUpdate:modelValue":e[7]||(e[7]=l=>a(o).forwardConfig.forwardRuleIds=l)},{default:n(()=>[(f(!0),R(A,null,M(a(w),l=>(f(),g(c,{key:l.ruleId,label:l.ruleName,value:l.ruleId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})])]),_:1}),t(s,{label:"顺序执行："},{default:n(()=>[t(b,{modelValue:a(o).runBySort,"onUpdate:modelValue":e[8]||(e[8]=l=>a(o).runBySort=l)},null,8,["modelValue"])]),_:1}),t(s,{label:"结果通知："},{default:n(()=>[t(b,{modelValue:a(o).push,"onUpdate:modelValue":e[9]||(e[9]=l=>a(o).push=l)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])),[[P,a(V),void 0,{fullscreen:!0,lock:!0}]])]),_:1},8,["modelValue"])}}};export{ne as _};
