{"version":3,"file":"index.DzW2zqW6.js","sources":["../../../src/api/system/config.js","../../../src/views/system/config/index.vue"],"sourcesContent":["import request from '@/utils/request'\r\n\r\n// 查询参数列表\r\nexport function listConfig(query) {\r\n  return request({\r\n    url: '/system/config/list',\r\n    method: 'get',\r\n    params: query\r\n  })\r\n}\r\n\r\n// 查询参数详细\r\nexport function getConfig(configId) {\r\n  return request({\r\n    url: '/system/config/' + configId,\r\n    method: 'get'\r\n  })\r\n}\r\n\r\n// 根据参数键名查询参数值\r\nexport function getConfigKey(configKey) {\r\n  return request({\r\n    url: '/system/config/configKey/' + configKey,\r\n    method: 'get'\r\n  })\r\n}\r\n\r\n// 新增参数配置\r\nexport function addConfig(data) {\r\n  return request({\r\n    url: '/system/config',\r\n    method: 'post',\r\n    data: data\r\n  })\r\n}\r\n\r\n// 修改参数配置\r\nexport function updateConfig(data) {\r\n  return request({\r\n    url: '/system/config',\r\n    method: 'put',\r\n    data: data\r\n  })\r\n}\r\n\r\n// 删除参数配置\r\nexport function delConfig(configId) {\r\n  return request({\r\n    url: '/system/config/' + configId,\r\n    method: 'delete'\r\n  })\r\n}\r\n\r\n// 刷新参数缓存\r\nexport function refreshCache() {\r\n  return request({\r\n    url: '/system/config/refreshCache',\r\n    method: 'delete'\r\n  })\r\n}\r\n","<template>\r\n   <div class=\"app-container\">\r\n      <el-form :model=\"queryParams\" ref=\"queryRef\" :inline=\"true\" v-show=\"showSearch\" label-width=\"68px\">\r\n         <el-form-item label=\"参数名称\" prop=\"configName\">\r\n            <el-input\r\n               v-model=\"queryParams.configName\"\r\n               placeholder=\"请输入参数名称\"\r\n               clearable\r\n               style=\"width: 240px\"\r\n               @keyup.enter=\"handleQuery\"\r\n            />\r\n         </el-form-item>\r\n         <el-form-item label=\"参数键名\" prop=\"configKey\">\r\n            <el-input\r\n               v-model=\"queryParams.configKey\"\r\n               placeholder=\"请输入参数键名\"\r\n               clearable\r\n               style=\"width: 240px\"\r\n               @keyup.enter=\"handleQuery\"\r\n            />\r\n         </el-form-item>\r\n         <el-form-item label=\"系统内置\" prop=\"configType\">\r\n            <el-select v-model=\"queryParams.configType\" placeholder=\"系统内置\" clearable>\r\n               <el-option\r\n                  v-for=\"dict in sys_yes_no\"\r\n                  :key=\"dict.value\"\r\n                  :label=\"dict.label\"\r\n                  :value=\"dict.value\"\r\n               />\r\n            </el-select>\r\n         </el-form-item>\r\n         <el-form-item label=\"创建时间\" style=\"width: 308px;\">\r\n            <el-date-picker\r\n               v-model=\"dateRange\"\r\n               value-format=\"YYYY-MM-DD\"\r\n               type=\"daterange\"\r\n               range-separator=\"-\"\r\n               start-placeholder=\"开始日期\"\r\n               end-placeholder=\"结束日期\"\r\n            ></el-date-picker>\r\n         </el-form-item>\r\n         <el-form-item>\r\n            <el-button type=\"primary\" icon=\"Search\" @click=\"handleQuery\">搜索</el-button>\r\n            <el-button icon=\"Refresh\" @click=\"resetQuery\">重置</el-button>\r\n         </el-form-item>\r\n      </el-form>\r\n\r\n      <el-row :gutter=\"10\" class=\"mb8\">\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"primary\"\r\n               plain\r\n               icon=\"Plus\"\r\n               @click=\"handleAdd\"\r\n               v-hasPermi=\"['system:config:add']\"\r\n            >新增</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"success\"\r\n               plain\r\n               icon=\"Edit\"\r\n               :disabled=\"single\"\r\n               @click=\"handleUpdate\"\r\n               v-hasPermi=\"['system:config:edit']\"\r\n            >修改</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"danger\"\r\n               plain\r\n               icon=\"Delete\"\r\n               :disabled=\"multiple\"\r\n               @click=\"handleDelete\"\r\n               v-hasPermi=\"['system:config:remove']\"\r\n            >删除</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"warning\"\r\n               plain\r\n               icon=\"Download\"\r\n               @click=\"handleExport\"\r\n               v-hasPermi=\"['system:config:export']\"\r\n            >导出</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"danger\"\r\n               plain\r\n               icon=\"Refresh\"\r\n               @click=\"handleRefreshCache\"\r\n               v-hasPermi=\"['system:config:remove']\"\r\n            >刷新缓存</el-button>\r\n         </el-col>\r\n         <right-toolbar v-model:showSearch=\"showSearch\" @queryTable=\"getList\"></right-toolbar>\r\n      </el-row>\r\n\r\n      <el-table v-loading=\"loading\" :data=\"configList\" @selection-change=\"handleSelectionChange\">\r\n         <el-table-column type=\"selection\" width=\"55\" align=\"center\" />\r\n         <el-table-column label=\"参数主键\" align=\"center\" prop=\"configId\" />\r\n         <el-table-column label=\"参数名称\" align=\"center\" prop=\"configName\" :show-overflow-tooltip=\"true\" />\r\n         <el-table-column label=\"参数键名\" align=\"center\" prop=\"configKey\" :show-overflow-tooltip=\"true\" />\r\n         <el-table-column label=\"参数键值\" align=\"center\" prop=\"configValue\" :show-overflow-tooltip=\"true\" />\r\n         <el-table-column label=\"系统内置\" align=\"center\" prop=\"configType\">\r\n            <template #default=\"scope\">\r\n               <dict-tag :options=\"sys_yes_no\" :value=\"scope.row.configType\" />\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column label=\"备注\" align=\"center\" prop=\"remark\" :show-overflow-tooltip=\"true\" />\r\n         <el-table-column label=\"创建时间\" align=\"center\" prop=\"createTime\" width=\"180\">\r\n            <template #default=\"scope\">\r\n               <span>{{ parseTime(scope.row.createTime) }}</span>\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column label=\"操作\" align=\"center\" width=\"150\" class-name=\"small-padding fixed-width\">\r\n            <template #default=\"scope\">\r\n               <el-button link type=\"primary\" icon=\"Edit\" @click=\"handleUpdate(scope.row)\" v-hasPermi=\"['system:config:edit']\" >修改</el-button>\r\n               <el-button link type=\"primary\" icon=\"Delete\" @click=\"handleDelete(scope.row)\" v-hasPermi=\"['system:config:remove']\">删除</el-button>\r\n            </template>\r\n         </el-table-column>\r\n      </el-table>\r\n\r\n      <pagination\r\n         v-show=\"total > 0\"\r\n         :total=\"total\"\r\n         v-model:page=\"queryParams.pageNum\"\r\n         v-model:limit=\"queryParams.pageSize\"\r\n         @pagination=\"getList\"\r\n      />\r\n\r\n      <!-- 添加或修改参数配置对话框 -->\r\n      <el-dialog :title=\"title\" v-model=\"open\" width=\"500px\" append-to-body>\r\n         <el-form ref=\"configRef\" :model=\"form\" :rules=\"rules\" label-width=\"80px\">\r\n            <el-form-item label=\"参数名称\" prop=\"configName\">\r\n               <el-input v-model=\"form.configName\" placeholder=\"请输入参数名称\" />\r\n            </el-form-item>\r\n            <el-form-item label=\"参数键名\" prop=\"configKey\">\r\n               <el-input v-model=\"form.configKey\" placeholder=\"请输入参数键名\" />\r\n            </el-form-item>\r\n            <el-form-item label=\"参数键值\" prop=\"configValue\">\r\n               <el-input v-model=\"form.configValue\" placeholder=\"请输入参数键值\" />\r\n            </el-form-item>\r\n            <el-form-item label=\"系统内置\" prop=\"configType\">\r\n               <el-radio-group v-model=\"form.configType\">\r\n                  <el-radio\r\n                     v-for=\"dict in sys_yes_no\"\r\n                     :key=\"dict.value\"\r\n                     :label=\"dict.value\"\r\n                  >{{ dict.label }}</el-radio>\r\n               </el-radio-group>\r\n            </el-form-item>\r\n            <el-form-item label=\"备注\" prop=\"remark\">\r\n               <el-input v-model=\"form.remark\" type=\"textarea\" placeholder=\"请输入内容\" />\r\n            </el-form-item>\r\n         </el-form>\r\n         <template #footer>\r\n            <div class=\"dialog-footer\">\r\n               <el-button type=\"primary\" @click=\"submitForm\">确 定</el-button>\r\n               <el-button @click=\"cancel\">取 消</el-button>\r\n            </div>\r\n         </template>\r\n      </el-dialog>\r\n   </div>\r\n</template>\r\n\r\n<script setup name=\"Config\">\r\nimport { listConfig, getConfig, delConfig, addConfig, updateConfig, refreshCache } from \"@/api/system/config\";\r\n\r\nconst { proxy } = getCurrentInstance();\r\nconst { sys_yes_no } = proxy.useDict(\"sys_yes_no\");\r\n\r\nconst configList = ref([]);\r\nconst open = ref(false);\r\nconst loading = ref(true);\r\nconst showSearch = ref(true);\r\nconst ids = ref([]);\r\nconst single = ref(true);\r\nconst multiple = ref(true);\r\nconst total = ref(0);\r\nconst title = ref(\"\");\r\nconst dateRange = ref([]);\r\n\r\nconst data = reactive({\r\n  form: {},\r\n  queryParams: {\r\n    pageNum: 1,\r\n    pageSize: 10,\r\n    configName: undefined,\r\n    configKey: undefined,\r\n    configType: undefined\r\n  },\r\n  rules: {\r\n    configName: [{ required: true, message: \"参数名称不能为空\", trigger: \"blur\" }],\r\n    configKey: [{ required: true, message: \"参数键名不能为空\", trigger: \"blur\" }],\r\n    configValue: [{ required: true, message: \"参数键值不能为空\", trigger: \"blur\" }]\r\n  }\r\n});\r\n\r\nconst { queryParams, form, rules } = toRefs(data);\r\n\r\n/** 查询参数列表 */\r\nfunction getList() {\r\n  loading.value = true;\r\n  listConfig(proxy.addDateRange(queryParams.value, dateRange.value)).then(response => {\r\n    configList.value = response.rows;\r\n    total.value = response.total;\r\n    loading.value = false;\r\n  });\r\n}\r\n/** 取消按钮 */\r\nfunction cancel() {\r\n  open.value = false;\r\n  reset();\r\n}\r\n/** 表单重置 */\r\nfunction reset() {\r\n  form.value = {\r\n    configId: undefined,\r\n    configName: undefined,\r\n    configKey: undefined,\r\n    configValue: undefined,\r\n    configType: \"Y\",\r\n    remark: undefined\r\n  };\r\n  proxy.resetForm(\"configRef\");\r\n}\r\n/** 搜索按钮操作 */\r\nfunction handleQuery() {\r\n  queryParams.value.pageNum = 1;\r\n  getList();\r\n}\r\n/** 重置按钮操作 */\r\nfunction resetQuery() {\r\n  dateRange.value = [];\r\n  proxy.resetForm(\"queryRef\");\r\n  handleQuery();\r\n}\r\n/** 多选框选中数据 */\r\nfunction handleSelectionChange(selection) {\r\n  ids.value = selection.map(item => item.configId);\r\n  single.value = selection.length != 1;\r\n  multiple.value = !selection.length;\r\n}\r\n/** 新增按钮操作 */\r\nfunction handleAdd() {\r\n  reset();\r\n  open.value = true;\r\n  title.value = \"添加参数\";\r\n}\r\n/** 修改按钮操作 */\r\nfunction handleUpdate(row) {\r\n  reset();\r\n  const configId = row.configId || ids.value;\r\n  getConfig(configId).then(response => {\r\n    form.value = response.data;\r\n    open.value = true;\r\n    title.value = \"修改参数\";\r\n  });\r\n}\r\n/** 提交按钮 */\r\nfunction submitForm() {\r\n  proxy.$refs[\"configRef\"].validate(valid => {\r\n    if (valid) {\r\n      if (form.value.configId != undefined) {\r\n        updateConfig(form.value).then(response => {\r\n          proxy.$modal.msgSuccess(\"修改成功\");\r\n          open.value = false;\r\n          getList();\r\n        });\r\n      } else {\r\n        addConfig(form.value).then(response => {\r\n          proxy.$modal.msgSuccess(\"新增成功\");\r\n          open.value = false;\r\n          getList();\r\n        });\r\n      }\r\n    }\r\n  });\r\n}\r\n/** 删除按钮操作 */\r\nfunction handleDelete(row) {\r\n  const configIds = row.configId || ids.value;\r\n  proxy.$modal.confirm('是否确认删除参数编号为\"' + configIds + '\"的数据项？').then(function () {\r\n    return delConfig(configIds);\r\n  }).then(() => {\r\n    getList();\r\n    proxy.$modal.msgSuccess(\"删除成功\");\r\n  }).catch(() => {});\r\n}\r\n/** 导出按钮操作 */\r\nfunction handleExport() {\r\n  proxy.download(\"system/config/export\", {\r\n    ...queryParams.value\r\n  }, `config_${new Date().getTime()}.xlsx`);\r\n}\r\n/** 刷新缓存按钮操作 */\r\nfunction handleRefreshCache() {\r\n  refreshCache().then(() => {\r\n    proxy.$modal.msgSuccess(\"刷新缓存成功\");\r\n  });\r\n}\r\n\r\ngetList();\r\n</script>\r\n"],"names":["listConfig","query","request","getConfig","configId","addConfig","data","updateConfig","delConfig","refreshCache","proxy","getCurrentInstance","sys_yes_no","configList","ref","open","loading","showSearch","ids","single","multiple","total","title","dateRange","reactive","queryParams","form","rules","toRefs","getList","response","cancel","reset","handleQuery","resetQuery","handleSelectionChange","selection","item","handleAdd","handleUpdate","row","submitForm","valid","handleDelete","configIds","handleExport","handleRefreshCache"],"mappings":"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"}