{"version":3,"file":"index.CvJjSMz9.js","sources":["../../../src/views/monitor/cache/index.vue"],"sourcesContent":["<template>\r\n  <div class=\"app-container\">\r\n    <el-row>\r\n      <el-col :span=\"24\" class=\"card-box\">\r\n        <el-card>\r\n          <template #header><Monitor style=\"width: 1em; height: 1em; vertical-align: middle;\" /> <span style=\"vertical-align: middle;\">基本信息</span></template>\r\n          <div class=\"el-table el-table--enable-row-hover el-table--medium\">\r\n            <table cellspacing=\"0\" style=\"width: 100%\">\r\n              <tbody>\r\n                <tr>\r\n                  <td class=\"el-table__cell is-leaf\"><div class=\"cell\">Redis版本</div></td>\r\n                  <td class=\"el-table__cell is-leaf\"><div class=\"cell\" v-if=\"cache.info\">{{ cache.info.redis_version }}</div></td>\r\n                  <td class=\"el-table__cell is-leaf\"><div class=\"cell\">运行模式</div></td>\r\n                  <td class=\"el-table__cell is-leaf\"><div class=\"cell\" v-if=\"cache.info\">{{ cache.info.redis_mode == \"standalone\" ? \"单机\" : \"集群\" }}</div></td>\r\n                  <td class=\"el-table__cell is-leaf\"><div class=\"cell\">端口</div></td>\r\n                  <td class=\"el-table__cell is-leaf\"><div class=\"cell\" v-if=\"cache.info\">{{ cache.info.tcp_port }}</div></td>\r\n                  <td class=\"el-table__cell is-leaf\"><div class=\"cell\">客户端数</div></td>\r\n                  <td class=\"el-table__cell is-leaf\"><div class=\"cell\" v-if=\"cache.info\">{{ cache.info.connected_clients }}</div></td>\r\n                </tr>\r\n                <tr>\r\n                  <td class=\"el-table__cell is-leaf\"><div class=\"cell\">运行时间(天)</div></td>\r\n                  <td class=\"el-table__cell is-leaf\"><div class=\"cell\" v-if=\"cache.info\">{{ cache.info.uptime_in_days }}</div></td>\r\n                  <td class=\"el-table__cell is-leaf\"><div class=\"cell\">使用内存</div></td>\r\n                  <td class=\"el-table__cell is-leaf\"><div class=\"cell\" v-if=\"cache.info\">{{ cache.info.used_memory_human }}</div></td>\r\n                  <td class=\"el-table__cell is-leaf\"><div class=\"cell\">使用CPU</div></td>\r\n                  <td class=\"el-table__cell is-leaf\"><div class=\"cell\" v-if=\"cache.info\">{{ parseFloat(cache.info.used_cpu_user_children).toFixed(2) }}</div></td>\r\n                  <td class=\"el-table__cell is-leaf\"><div class=\"cell\">内存配置</div></td>\r\n                  <td class=\"el-table__cell is-leaf\"><div class=\"cell\" v-if=\"cache.info\">{{ cache.info.maxmemory_human }}</div></td>\r\n                </tr>\r\n                <tr>\r\n                  <td class=\"el-table__cell is-leaf\"><div class=\"cell\">AOF是否开启</div></td>\r\n                  <td class=\"el-table__cell is-leaf\"><div class=\"cell\" v-if=\"cache.info\">{{ cache.info.aof_enabled == \"0\" ? \"否\" : \"是\" }}</div></td>\r\n                  <td class=\"el-table__cell is-leaf\"><div class=\"cell\">RDB是否成功</div></td>\r\n                  <td class=\"el-table__cell is-leaf\"><div class=\"cell\" v-if=\"cache.info\">{{ cache.info.rdb_last_bgsave_status }}</div></td>\r\n                  <td class=\"el-table__cell is-leaf\"><div class=\"cell\">Key数量</div></td>\r\n                  <td class=\"el-table__cell is-leaf\"><div class=\"cell\" v-if=\"cache.dbSize\">{{ cache.dbSize }} </div></td>\r\n                  <td class=\"el-table__cell is-leaf\"><div class=\"cell\">网络入口/出口</div></td>\r\n                  <td class=\"el-table__cell is-leaf\"><div class=\"cell\" v-if=\"cache.info\">{{ cache.info.instantaneous_input_kbps }}kps/{{cache.info.instantaneous_output_kbps}}kps</div></td>\r\n                </tr>\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </el-card>\r\n      </el-col>\r\n\r\n      <el-col :span=\"12\" class=\"card-box\">\r\n        <el-card>\r\n          <template #header><PieChart style=\"width: 1em; height: 1em; vertical-align: middle;\" /> <span style=\"vertical-align: middle;\">命令统计</span></template>\r\n          <div class=\"el-table el-table--enable-row-hover el-table--medium\">\r\n            <div ref=\"commandstats\" style=\"height: 420px\" />\r\n          </div>\r\n        </el-card>\r\n      </el-col>\r\n\r\n      <el-col :span=\"12\" class=\"card-box\">\r\n        <el-card>\r\n          <template #header><Odometer style=\"width: 1em; height: 1em; vertical-align: middle;\" /> <span style=\"vertical-align: middle;\">内存信息</span></template>\r\n          <div class=\"el-table el-table--enable-row-hover el-table--medium\">\r\n            <div ref=\"usedmemory\" style=\"height: 420px\" />\r\n          </div>\r\n        </el-card>\r\n      </el-col>\r\n    </el-row>\r\n  </div>\r\n</template>\r\n\r\n<script setup name=\"Cache\">\r\nimport { getCache } from '@/api/monitor/cache';\r\nimport * as echarts from 'echarts';\r\n\r\nconst cache = ref([]);\r\nconst commandstats = ref(null);\r\nconst usedmemory = ref(null);\r\nconst { proxy } = getCurrentInstance();\r\n\r\nfunction getList() {\r\n  proxy.$modal.loading(\"正在加载缓存监控数据，请稍候！\");\r\n  getCache().then(response => {\r\n    proxy.$modal.closeLoading();\r\n    cache.value = response.data;\r\n\r\n    const commandstatsIntance = echarts.init(commandstats.value, \"macarons\");\r\n    commandstatsIntance.setOption({\r\n      tooltip: {\r\n        trigger: \"item\",\r\n        formatter: \"{a} <br/>{b} : {c} ({d}%)\"\r\n      },\r\n      series: [\r\n        {\r\n          name: \"命令\",\r\n          type: \"pie\",\r\n          roseType: \"radius\",\r\n          radius: [15, 95],\r\n          center: [\"50%\", \"38%\"],\r\n          data: response.data.commandStats,\r\n          animationEasing: \"cubicInOut\",\r\n          animationDuration: 1000\r\n        }\r\n      ]\r\n    });\r\n    const usedmemoryInstance = echarts.init(usedmemory.value, \"macarons\");\r\n    usedmemoryInstance.setOption({\r\n      tooltip: {\r\n        formatter: \"{b} <br/>{a} : \" + cache.value.info.used_memory_human\r\n      },\r\n      series: [\r\n        {\r\n          name: \"峰值\",\r\n          type: \"gauge\",\r\n          min: 0,\r\n          max: 1000,\r\n          detail: {\r\n            formatter: cache.value.info.used_memory_human\r\n          },\r\n          data: [\r\n            {\r\n              value: parseFloat(cache.value.info.used_memory_human),\r\n              name: \"内存消耗\"\r\n            }\r\n          ]\r\n        }\r\n      ]\r\n    })\r\n    window.addEventListener(\"resize\", () => {\r\n      commandstatsIntance.resize();\r\n      usedmemoryInstance.resize();\r\n    });\r\n  })\r\n}\r\n\r\ngetList();\r\n</script>\r\n"],"names":["cache","ref","commandstats","usedmemory","proxy","getCurrentInstance","getList","getCache","response","commandstatsIntance","echarts.init","usedmemoryInstance"],"mappings":"ksCAsEA,MAAMA,EAAQC,EAAI,CAAA,CAAE,EACdC,EAAeD,EAAI,IAAI,EACvBE,EAAaF,EAAI,IAAI,EACrB,CAAE,MAAAG,CAAK,EAAKC,IAElB,SAASC,GAAU,CACjBF,EAAM,OAAO,QAAQ,iBAAiB,EACtCG,EAAU,EAAC,KAAKC,GAAY,CAC1BJ,EAAM,OAAO,eACbJ,EAAM,MAAQQ,EAAS,KAEvB,MAAMC,EAAsBC,EAAaR,EAAa,MAAO,UAAU,EACvEO,EAAoB,UAAU,CAC5B,QAAS,CACP,QAAS,OACT,UAAW,2BACZ,EACD,OAAQ,CACN,CACE,KAAM,KACN,KAAM,MACN,SAAU,SACV,OAAQ,CAAC,GAAI,EAAE,EACf,OAAQ,CAAC,MAAO,KAAK,EACrB,KAAMD,EAAS,KAAK,aACpB,gBAAiB,aACjB,kBAAmB,GACpB,CACF,CACP,CAAK,EACD,MAAMG,EAAqBD,EAAaP,EAAW,MAAO,UAAU,EACpEQ,EAAmB,UAAU,CAC3B,QAAS,CACP,UAAW,kBAAoBX,EAAM,MAAM,KAAK,iBACjD,EACD,OAAQ,CACN,CACE,KAAM,KACN,KAAM,QACN,IAAK,EACL,IAAK,IACL,OAAQ,CACN,UAAWA,EAAM,MAAM,KAAK,iBAC7B,EACD,KAAM,CACJ,CACE,MAAO,WAAWA,EAAM,MAAM,KAAK,iBAAiB,EACpD,KAAM,MACP,CACF,CACF,CACF,CACP,CAAK,EACD,OAAO,iBAAiB,SAAU,IAAM,CACtCS,EAAoB,OAAM,EAC1BE,EAAmB,OAAM,CAC/B,CAAK,CACL,CAAG,CACH,CAEA,OAAAL"}