{"version":3,"file":"run-config.DU_xBo-W.js","sources":["../../../src/components/hrm/common/run/run-config.vue"],"sourcesContent":["<script setup>\r\nimport EnvSelector from \"@/components/hrm/common/env-selector.vue\";\r\nimport {all as getAllForwardRules} from \"@/api/hrm/forward\";\r\nimport {all as getAllAgent} from \"@/api/hrm/agent.js\";\r\nimport {initRunConfig} from \"@/components/hrm/data-template.js\";\r\n\r\nconst configData = defineModel('configData');\r\nconst emits = defineEmits(['update']);\r\nconst form = ref(JSON.parse(JSON.stringify(initRunConfig)));\r\n\r\nconst allForwardRules = ref([]);\r\nconst allAgent = ref([]);\r\n\r\nfunction getForwardRule() {\r\n  getAllForwardRules().then(response => {\r\n    allForwardRules.value = response.data;\r\n  });\r\n}\r\n\r\nfunction getAgent() {\r\n  getAllAgent().then(response => {\r\n    allAgent.value = response.rows;\r\n  });\r\n}\r\n\r\n// watch(() => form.value.runBySort, (newValue) => {\r\n//   if (form.value.runBySort) {\r\n//     form.value.concurrent = 1;\r\n//   }\r\n// });\r\n\r\nwatch(() => configData.value, (newValue) => {\r\n  form.value = configData.value;\r\n}, {deep: true});\r\n\r\n\r\nwatch(() => form.value, (newValue) => {\r\n  if (form.value.runBySort) {\r\n    form.value.concurrent = 1;\r\n  }\r\n  emits('update', form.value);\r\n}, {deep: true});\r\n\r\nonMounted(() => {\r\n  if (configData.value) {\r\n    form.value = configData.value;\r\n  }\r\n  nextTick(() => {\r\n    getForwardRule();\r\n    getAgent();\r\n  });\r\n\r\n});\r\n\r\nconst runConfigRules = ref({\r\n  env: [{required: true, message: \"运行环境不能为空\", trigger: 'blur'}],\r\n});\r\n\r\n</script>\r\n\r\n<template>\r\n  <el-form :model=\"form\" :rules=\"runConfigRules\">\r\n\r\n    <el-form-item label=\"测试环境\" prop=\"env\">\r\n      <EnvSelector v-model:selected-env=\"form.env\" selector-width=\"100%\"></EnvSelector>\r\n    </el-form-item>\r\n    <el-form-item label=\"报告名称\">\r\n      <el-input v-model=\"form.reportName\" autocomplete=\"off\" placeholder=\"报告名称，默认为执行时间\"/>\r\n    </el-form-item>\r\n\r\n    <el-form-item label=\"执行次数\">\r\n      <el-input-number :min=\"1\" controls-position=\"right\" v-model=\"form.repeatNum\"/>\r\n    </el-form-item>\r\n    <el-form-item label=\"同步执行\">\r\n      <el-select v-model=\"form.isAsync\" placeholder=\"选择本次执行方式\">\r\n        <el-option label=\"同步\" :value=\"false\"/>\r\n        <el-option label=\"异步\" :value=\"true\"/>\r\n      </el-select>\r\n    </el-form-item>\r\n    <el-form-item label=\"并发数量\">\r\n      <el-input-number :min=\"1\" controls-position=\"right\" v-model=\"form.concurrent\"\r\n                       placeholder=\"输入并发执行的用例数量\" :disabled=\"form.runBySort\"></el-input-number>\r\n    </el-form-item>\r\n\r\n    <el-form-item label=\"转发配置\">\r\n      <div style=\"display: flex;flex-direction: row;flex-grow: 1\">\r\n        <el-checkbox v-model=\"form.forwardConfig.forward\" style=\"margin-right: 20px\"></el-checkbox>\r\n        <el-row style=\"flex-grow: 1\" :gutter=\"10\">\r\n          <el-col :span=\"12\">\r\n            <el-select placeholder=\"请选择客户机\"\r\n                       v-model=\"form.forwardConfig.agentId\"\r\n                       clearable\r\n            >\r\n              <el-option\r\n                  v-for=\"item in allAgent\"\r\n                  :key=\"item.agentId\"\r\n                  :label=\"item.agentName\"\r\n                  :value=\"item.agentId\"\r\n              />\r\n            </el-select>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-select multiple\r\n                       placeholder=\"请选择转发规则\"\r\n                       v-model=\"form.forwardConfig.forwardRuleIds\"\r\n            >\r\n              <el-option\r\n                  v-for=\"item in allForwardRules\"\r\n                  :key=\"item.ruleId\"\r\n                  :label=\"item.ruleName\"\r\n                  :value=\"item.ruleId\"\r\n              />\r\n            </el-select>\r\n          </el-col>\r\n        </el-row>\r\n      </div>\r\n    </el-form-item>\r\n\r\n    <el-form-item label=\"顺序执行\">\r\n      <!--        <el-input v-model=\"form.push\" type=\"checkbox\"></el-input>-->\r\n      <el-checkbox v-model=\"form.runBySort\"></el-checkbox>\r\n    </el-form-item>\r\n    <el-form-item label=\"结果通知\">\r\n      <!--        <el-input v-model=\"form.push\" type=\"checkbox\"></el-input>-->\r\n      <el-checkbox v-model=\"form.push\"></el-checkbox>\r\n    </el-form-item>\r\n\r\n\r\n  </el-form>\r\n</template>\r\n\r\n<style scoped lang=\"scss\">\r\n\r\n</style>"],"names":["configData","_useModel","__props","emits","__emit","form","ref","initRunConfig","allForwardRules","allAgent","getForwardRule","getAllForwardRules","response","getAgent","getAllAgent","watch","newValue","onMounted","nextTick","runConfigRules"],"mappings":"sgBAMA,MAAMA,EAAaC,EAAWC,EAAC,YAAY,EACrCC,EAAQC,EACRC,EAAOC,EAAI,KAAK,MAAM,KAAK,UAAUC,CAAa,CAAC,CAAC,EAEpDC,EAAkBF,EAAI,CAAA,CAAE,EACxBG,EAAWH,EAAI,CAAA,CAAE,EAEvB,SAASI,GAAiB,CACxBC,EAAoB,EAAC,KAAKC,GAAY,CACpCJ,EAAgB,MAAQI,EAAS,IACrC,CAAG,CACH,CAEA,SAASC,GAAW,CAClBC,EAAa,EAAC,KAAKF,GAAY,CAC7BH,EAAS,MAAQG,EAAS,IAC9B,CAAG,CACH,CAQAG,EAAM,IAAMf,EAAW,MAAQgB,GAAa,CAC1CX,EAAK,MAAQL,EAAW,KAC1B,EAAG,CAAC,KAAM,EAAI,CAAC,EAGfe,EAAM,IAAMV,EAAK,MAAQW,GAAa,CAChCX,EAAK,MAAM,YACbA,EAAK,MAAM,WAAa,GAE1BF,EAAM,SAAUE,EAAK,KAAK,CAC5B,EAAG,CAAC,KAAM,EAAI,CAAC,EAEfY,EAAU,IAAM,CACVjB,EAAW,QACbK,EAAK,MAAQL,EAAW,OAE1BkB,EAAS,IAAM,CACbR,IACAG,GACJ,CAAG,CAEH,CAAC,EAED,MAAMM,EAAiBb,EAAI,CACzB,IAAK,CAAC,CAAC,SAAU,GAAM,QAAS,WAAY,QAAS,MAAM,CAAC,CAC9D,CAAC"}