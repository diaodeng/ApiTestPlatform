{"version":3,"file":"list.yRqWmp3X.js","sources":["../../../src/views/monitor/cache/list.vue"],"sourcesContent":["<template>\r\n  <div class=\"app-container\">\r\n    <el-row :gutter=\"10\">\r\n      <el-col :span=\"8\">\r\n        <el-card style=\"height: calc(100vh - 125px)\">\r\n          <template #header>\r\n            <Collection style=\"width: 1em; height: 1em; vertical-align: middle;\" /> <span style=\"vertical-align: middle;\">缓存列表</span>\r\n            <el-button\r\n              style=\"float: right; padding: 3px 0\"\r\n              link\r\n              type=\"primary\"\r\n              icon=\"Refresh\"\r\n              @click=\"refreshCacheNames()\"\r\n            ></el-button>\r\n          </template>\r\n          <el-table\r\n            v-loading=\"loading\"\r\n            :data=\"cacheNames\"\r\n            :height=\"tableHeight\"\r\n            highlight-current-row\r\n            @row-click=\"getCacheKeys\"\r\n            style=\"width: 100%\"\r\n          >\r\n            <el-table-column\r\n              label=\"序号\"\r\n              width=\"60\"\r\n              type=\"index\"\r\n            ></el-table-column>\r\n\r\n            <el-table-column\r\n              label=\"缓存名称\"\r\n              align=\"center\"\r\n              prop=\"cacheName\"\r\n              :show-overflow-tooltip=\"true\"\r\n              :formatter=\"nameFormatter\"\r\n            ></el-table-column>\r\n\r\n            <el-table-column\r\n              label=\"备注\"\r\n              align=\"center\"\r\n              prop=\"remark\"\r\n              :show-overflow-tooltip=\"true\"\r\n            />\r\n            <el-table-column\r\n              label=\"操作\"\r\n              width=\"60\"\r\n              align=\"center\"\r\n              class-name=\"small-padding fixed-width\"\r\n            >\r\n              <template #default=\"scope\">\r\n                <el-button\r\n                  link\r\n                  type=\"primary\"\r\n                  icon=\"Delete\"\r\n                  @click=\"handleClearCacheName(scope.row)\"\r\n                ></el-button>\r\n              </template>\r\n            </el-table-column>\r\n          </el-table>\r\n        </el-card>\r\n      </el-col>\r\n\r\n      <el-col :span=\"8\">\r\n        <el-card style=\"height: calc(100vh - 125px)\">\r\n          <template #header>\r\n            <Key style=\"width: 1em; height: 1em; vertical-align: middle;\" /> <span style=\"vertical-align: middle;\">键名列表</span>\r\n            <el-button\r\n              style=\"float: right; padding: 3px 0\"\r\n              link\r\n              type=\"primary\"\r\n              icon=\"Refresh\"\r\n              @click=\"refreshCacheKeys()\"\r\n            ></el-button>\r\n          </template>\r\n          <el-table\r\n            v-loading=\"subLoading\"\r\n            :data=\"cacheKeys\"\r\n            :height=\"tableHeight\"\r\n            highlight-current-row\r\n            @row-click=\"handleCacheValue\"\r\n            style=\"width: 100%\"\r\n          >\r\n            <el-table-column\r\n              label=\"序号\"\r\n              width=\"60\"\r\n              type=\"index\"\r\n            ></el-table-column>\r\n            <el-table-column\r\n              label=\"缓存键名\"\r\n              align=\"center\"\r\n              :show-overflow-tooltip=\"true\"\r\n              :formatter=\"keyFormatter\"\r\n            >\r\n            </el-table-column>\r\n            <el-table-column\r\n              label=\"操作\"\r\n              width=\"60\"\r\n              align=\"center\"\r\n              class-name=\"small-padding fixed-width\"\r\n            >\r\n              <template #default=\"scope\">\r\n                <el-button\r\n                  link\r\n                  type=\"primary\"\r\n                  icon=\"Delete\"\r\n                  @click=\"handleClearCacheKey(scope.row)\"\r\n                ></el-button>\r\n              </template>\r\n            </el-table-column>\r\n          </el-table>\r\n        </el-card>\r\n      </el-col>\r\n\r\n      <el-col :span=\"8\">\r\n        <el-card :bordered=\"false\" style=\"height: calc(100vh - 125px)\">\r\n          <template #header>\r\n            <Document style=\"width: 1em; height: 1em; vertical-align: middle;\" /> <span style=\"vertical-align: middle;\">缓存内容</span>\r\n            <el-button\r\n              style=\"float: right; padding: 3px 0\"\r\n              link\r\n              type=\"primary\"\r\n              icon=\"Refresh\"\r\n              @click=\"handleClearCacheAll()\"\r\n              >清理全部</el-button\r\n            >\r\n          </template>\r\n          <el-form :model=\"cacheForm\">\r\n            <el-row :gutter=\"32\">\r\n              <el-col :offset=\"1\" :span=\"22\">\r\n                <el-form-item label=\"缓存名称:\" prop=\"cacheName\">\r\n                  <el-input v-model=\"cacheForm.cacheName\" :readOnly=\"true\" />\r\n                </el-form-item>\r\n              </el-col>\r\n              <el-col :offset=\"1\" :span=\"22\">\r\n                <el-form-item label=\"缓存键名:\" prop=\"cacheKey\">\r\n                  <el-input v-model=\"cacheForm.cacheKey\" :readOnly=\"true\" />\r\n                </el-form-item>\r\n              </el-col>\r\n              <el-col :offset=\"1\" :span=\"22\">\r\n                <el-form-item label=\"缓存内容:\" prop=\"cacheValue\">\r\n                  <el-input\r\n                    v-model=\"cacheForm.cacheValue\"\r\n                    type=\"textarea\"\r\n                    :rows=\"8\"\r\n                    :readOnly=\"true\"\r\n                  />\r\n                </el-form-item>\r\n              </el-col>\r\n            </el-row>\r\n          </el-form>\r\n        </el-card>\r\n      </el-col>\r\n    </el-row>\r\n  </div>\r\n</template>\r\n\r\n<script setup name=\"CacheList\">\r\nimport { listCacheName, listCacheKey, getCacheValue, clearCacheName, clearCacheKey, clearCacheAll } from \"@/api/monitor/cache\";\r\n\r\nconst { proxy } = getCurrentInstance();\r\n\r\nconst cacheNames = ref([]);\r\nconst cacheKeys = ref([]);\r\nconst cacheForm = ref({});\r\nconst loading = ref(true);\r\nconst subLoading = ref(false);\r\nconst nowCacheName = ref(\"\");\r\nconst tableHeight = ref(window.innerHeight - 200);\r\n\r\n/** 查询缓存名称列表 */\r\nfunction getCacheNames() {\r\n  loading.value = true;\r\n  listCacheName().then(response => {\r\n    cacheNames.value = response.data;\r\n    loading.value = false;\r\n  });\r\n}\r\n\r\n/** 刷新缓存名称列表 */\r\nfunction refreshCacheNames() {\r\n  getCacheNames();\r\n  proxy.$modal.msgSuccess(\"刷新缓存列表成功\");\r\n}\r\n\r\n/** 清理指定名称缓存 */\r\nfunction handleClearCacheName(row) {\r\n  clearCacheName(row.cacheName).then(response => {\r\n    proxy.$modal.msgSuccess(\"清理缓存名称[\" + row.cacheName + \"]成功\");\r\n    getCacheKeys();\r\n  });\r\n}\r\n\r\n/** 查询缓存键名列表 */\r\nfunction getCacheKeys(row) {\r\n  const cacheName = row !== undefined ? row.cacheName : nowCacheName.value;\r\n  if (cacheName === \"\") {\r\n    return;\r\n  }\r\n  subLoading.value = true;\r\n  listCacheKey(cacheName).then(response => {\r\n    cacheKeys.value = response.data;\r\n    subLoading.value = false;\r\n    nowCacheName.value = cacheName;\r\n  });\r\n}\r\n\r\n/** 刷新缓存键名列表 */\r\nfunction refreshCacheKeys() {\r\n  getCacheKeys();\r\n  proxy.$modal.msgSuccess(\"刷新键名列表成功\");\r\n}\r\n\r\n/** 清理指定键名缓存 */\r\nfunction handleClearCacheKey(cacheKey) {\r\n  clearCacheKey(cacheKey).then(response => {\r\n    proxy.$modal.msgSuccess(\"清理缓存键名[\" + cacheKey + \"]成功\");\r\n    getCacheKeys();\r\n  });\r\n}\r\n\r\n/** 列表前缀去除 */\r\nfunction nameFormatter(row) {\r\n  return row.cacheName.replace(\":\", \"\");\r\n}\r\n\r\n/** 键名前缀去除 */\r\nfunction keyFormatter(cacheKey) {\r\n  return cacheKey.replace(nowCacheName.value, \"\");\r\n}\r\n\r\n/** 查询缓存内容详细 */\r\nfunction handleCacheValue(cacheKey) {\r\n  getCacheValue(nowCacheName.value, cacheKey).then(response => {\r\n    cacheForm.value = response.data;\r\n  });\r\n}\r\n\r\n/** 清理全部缓存 */\r\nfunction handleClearCacheAll() {\r\n  clearCacheAll().then(response => {\r\n    proxy.$modal.msgSuccess(\"清理全部缓存成功\");\r\n  });\r\n}\r\n\r\ngetCacheNames();\r\n</script>\r\n"],"names":["proxy","getCurrentInstance","cacheNames","ref","cacheKeys","cacheForm","loading","subLoading","nowCacheName","tableHeight","getCacheNames","listCacheName","response","refreshCacheNames","handleClearCacheName","row","clearCacheName","getCacheKeys","cacheName","listCacheKey","refreshCacheKeys","handleClearCacheKey","cacheKey","clearCacheKey","nameFormatter","keyFormatter","handleCacheValue","getCacheValue","handleClearCacheAll","clearCacheAll"],"mappings":"wSA+JA,KAAM,CAAE,MAAAA,CAAK,EAAKC,KAEZC,EAAaC,EAAI,CAAA,CAAE,EACnBC,EAAYD,EAAI,CAAA,CAAE,EAClBE,EAAYF,EAAI,CAAA,CAAE,EAClBG,EAAUH,EAAI,EAAI,EAClBI,EAAaJ,EAAI,EAAK,EACtBK,EAAeL,EAAI,EAAE,EACrBM,EAAcN,EAAI,OAAO,YAAc,GAAG,EAGhD,SAASO,GAAgB,CACvBJ,EAAQ,MAAQ,GAChBK,EAAe,EAAC,KAAKC,GAAY,CAC/BV,EAAW,MAAQU,EAAS,KAC5BN,EAAQ,MAAQ,EACpB,CAAG,CACH,CAGA,SAASO,GAAoB,CAC3BH,IACAV,EAAM,OAAO,WAAW,UAAU,CACpC,CAGA,SAASc,EAAqBC,EAAK,CACjCC,EAAeD,EAAI,SAAS,EAAE,KAAKH,GAAY,CAC7CZ,EAAM,OAAO,WAAW,UAAYe,EAAI,UAAY,KAAK,EACzDE,GACJ,CAAG,CACH,CAGA,SAASA,EAAaF,EAAK,CACzB,MAAMG,EAAYH,IAAQ,OAAYA,EAAI,UAAYP,EAAa,MAC/DU,IAAc,KAGlBX,EAAW,MAAQ,GACnBY,EAAaD,CAAS,EAAE,KAAKN,GAAY,CACvCR,EAAU,MAAQQ,EAAS,KAC3BL,EAAW,MAAQ,GACnBC,EAAa,MAAQU,CACzB,CAAG,EACH,CAGA,SAASE,GAAmB,CAC1BH,IACAjB,EAAM,OAAO,WAAW,UAAU,CACpC,CAGA,SAASqB,EAAoBC,EAAU,CACrCC,EAAcD,CAAQ,EAAE,KAAKV,GAAY,CACvCZ,EAAM,OAAO,WAAW,UAAYsB,EAAW,KAAK,EACpDL,GACJ,CAAG,CACH,CAGA,SAASO,EAAcT,EAAK,CAC1B,OAAOA,EAAI,UAAU,QAAQ,IAAK,EAAE,CACtC,CAGA,SAASU,EAAaH,EAAU,CAC9B,OAAOA,EAAS,QAAQd,EAAa,MAAO,EAAE,CAChD,CAGA,SAASkB,EAAiBJ,EAAU,CAClCK,EAAcnB,EAAa,MAAOc,CAAQ,EAAE,KAAKV,GAAY,CAC3DP,EAAU,MAAQO,EAAS,IAC/B,CAAG,CACH,CAGA,SAASgB,GAAsB,CAC7BC,EAAe,EAAC,KAAKjB,GAAY,CAC/BZ,EAAM,OAAO,WAAW,UAAU,CACtC,CAAG,CACH,CAEA,OAAAU"}