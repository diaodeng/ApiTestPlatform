import{u as E,r as i,L as F,d as s,H as O,o as y,c as z,i as c,e as t,f as a,h as l,I as h,m as H,y as C,M as L,K as V,p as S,F as M,s as P}from"./index.DgyczuKs.js";import{a as q,u as G}from"./user.C7Uwl8K_.js";const J={class:"app-container"},Q={style:{"text-align":"center","margin-left":"-120px","margin-top":"30px"}},W=M({name:"AuthRole"}),ee=Object.assign(W,{setup(X){const b=E(),{proxy:f}=P(),g=i(!0),v=i(0),u=i(1),d=i(10),w=i([]),_=i([]),r=i({nickName:void 0,userName:void 0,userId:void 0});function $(o){f.$refs.roleRef.toggleRowSelection(o)}function T(o){w.value=o.map(e=>e.roleId)}function B(o){return o.roleId}function I(){const o={path:"/system/user"};f.$tab.closeOpenPage(o)}function U(){const o=r.value.userId,e=w.value.join(",");G({userId:o,roleIds:e}).then(p=>{f.$modal.msgSuccess("授权成功"),I()})}return(()=>{const o=b.params&&b.params.userId;o&&(g.value=!0,q(o).then(e=>{r.value=e.user,_.value=e.roles,v.value=_.value.length,F(()=>{_.value.forEach(p=>{p.flag&&f.$refs.roleRef.toggleRowSelection(p)})}),g.value=!1}))})(),(o,e)=>{const p=s("el-input"),k=s("el-form-item"),N=s("el-col"),j=s("el-row"),R=s("el-form"),m=s("el-table-column"),A=s("el-table"),D=s("pagination"),x=s("el-button"),K=O("loading");return y(),z("div",J,[e[8]||(e[8]=c("h4",{class:"form-header h4"},"基本信息",-1)),t(R,{model:l(r),"label-width":"80px"},{default:a(()=>[t(j,null,{default:a(()=>[t(N,{span:8,offset:2},{default:a(()=>[t(k,{label:"用户昵称",prop:"nickName"},{default:a(()=>[t(p,{modelValue:l(r).nickName,"onUpdate:modelValue":e[0]||(e[0]=n=>l(r).nickName=n),disabled:""},null,8,["modelValue"])]),_:1})]),_:1}),t(N,{span:8,offset:2},{default:a(()=>[t(k,{label:"登录账号",prop:"userName"},{default:a(()=>[t(p,{modelValue:l(r).userName,"onUpdate:modelValue":e[1]||(e[1]=n=>l(r).userName=n),disabled:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),e[9]||(e[9]=c("h4",{class:"form-header h4"},"角色信息",-1)),h((y(),H(A,{"row-key":B,onRowClick:$,ref:"roleRef",onSelectionChange:T,data:l(_).slice((l(u)-1)*l(d),l(u)*l(d))},{default:a(()=>[t(m,{label:"序号",width:"55",type:"index",align:"center"},{default:a(n=>[c("span",null,C((l(u)-1)*l(d)+n.$index+1),1)]),_:1}),t(m,{type:"selection","reserve-selection":!0,width:"55"}),t(m,{label:"角色编号",align:"center",prop:"roleId"}),t(m,{label:"角色名称",align:"center",prop:"roleName"}),t(m,{label:"权限字符",align:"center",prop:"roleKey"}),t(m,{label:"创建时间",align:"center",prop:"createTime",width:"180"},{default:a(n=>[c("span",null,C(o.parseTime(n.row.createTime)),1)]),_:1})]),_:1},8,["data"])),[[K,l(g)]]),h(t(D,{total:l(v),page:l(u),"onUpdate:page":e[2]||(e[2]=n=>V(u)?u.value=n:null),limit:l(d),"onUpdate:limit":e[3]||(e[3]=n=>V(d)?d.value=n:null)},null,8,["total","page","limit"]),[[L,l(v)>0]]),t(R,{"label-width":"100px"},{default:a(()=>[c("div",Q,[t(x,{type:"primary",onClick:e[4]||(e[4]=n=>U())},{default:a(()=>e[6]||(e[6]=[S("提交")])),_:1}),t(x,{onClick:e[5]||(e[5]=n=>I())},{default:a(()=>e[7]||(e[7]=[S("返回")])),_:1})])]),_:1})])}}});export{ee as default};
