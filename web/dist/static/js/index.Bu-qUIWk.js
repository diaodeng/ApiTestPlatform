import{a6 as be,r as f,J as ye,N as he,d as o,H as Q,o as i,c as U,I as b,M as A,h as a,e,f as n,l as we,O as P,P as q,m as h,p as v,K as G,i as D,y as z,n as ke,F as Ve,s as Ne,av as xe}from"./index.B-ki0wTK.js";import{l as Ce,g as Ue,u as De,a as Se,d as Ee}from"./env.BXDgmL9O.js";import{_ as $e}from"./table-variables.9YKN3mfF.js";import{_ as Ie}from"./edit-label-text.D8J3EPOo.js";import"./tools.CngWgkPu.js";const Re={class:"app-container"},Te={style:{"padding-bottom":"10px"}},Pe={class:"dialog-footer"},qe=Ve({name:"Env"}),Ae=Object.assign(qe,{setup(ze){const{proxy:p}=Ne(),{sys_normal_disable:S}=p.useDict("sys_normal_disable"),{hrm_data_type:M}=p.useDict("hrm_data_type");be("hrm_data_type",M);const F=f([]),c=f(!1),E=f(!0),V=f(!0),$=f(""),O=f(!0),j=f(!0),I=f(0),H=ye({queryParams:{pageNum:1,pageSize:10,envName:void 0,status:void 0},rules:{envName:[{required:!0,message:"环境名称不能为空",trigger:"blur"}],orderNum:[{required:!0,message:"显示排序不能为空",trigger:"blur"}],envUrl:[{required:!0,message:"环境地址不能为空",trigger:"blur"}]}}),{queryParams:s,rules:J}=he(H),u=f({envConfig:{variables:[{key:"default",value:[]}]},envName:"",envUrl:"",orderNum:0,simpleDesc:""});function W(){u.value.envConfig.variables.push({key:"default",desc:"",value:[]})}function X(d){u.value.envConfig.variables.splice(d,1)}function y(){E.value=!0,Ce(s.value).then(d=>{F.value=d.rows,I.value=d.total,E.value=!1})}function Y(){c.value=!1,R()}function R(){u.value={envId:void 0,envName:void 0,orderNum:0,envUrl:void 0,simpleDesc:void 0,status:"0",envConfig:{variables:[{value:[],key:"default"}]}},p.resetForm("envRef")}function T(){y()}function Z(){p.resetForm("queryRef"),T()}function ee(d){R(),c.value=!0,$.value="添加环境"}function le(d){R(),Ue(d.envId).then(l=>{u.value=l.data,c.value=!0,$.value=l.data.envId+"  >>  "+l.data.envName})}function te(){p.$refs.envRef.validate(d=>{d&&(u.value.envId!=null?De(u.value).then(l=>{p.$modal.msgSuccess("修改成功"),c.value=!1,y()}):Se(u.value).then(l=>{p.$modal.msgSuccess("新增成功"),c.value=!1,y()}))})}function ne(d){p.$modal.confirm('是否确认删除名称为"'+d.envName+'"的数据项?').then(function(){return Ee(d.envId)}).then(()=>{y(),p.$modal.msgSuccess("删除成功")}).catch(()=>{})}function ae(d){xe.warning("暂未实现复制功能")}return y(),(d,l)=>{const N=o("el-input"),m=o("el-form-item"),oe=o("el-option"),ue=o("el-select"),de=o("el-checkbox"),r=o("el-button"),L=o("el-form"),_=o("el-col"),se=o("right-toolbar"),x=o("el-row"),g=o("el-table-column"),re=o("dict-tag"),ie=o("el-table"),pe=o("pagination"),me=o("el-input-number"),fe=o("el-radio"),ve=o("el-radio-group"),B=o("el-text"),K=o("el-tooltip"),ce=o("el-affix"),_e=o("el-dialog"),w=Q("hasPermi"),ge=Q("loading");return i(),U("div",Re,[b(e(L,{model:a(s),ref:"queryRef",inline:!0},{default:n(()=>[e(m,{label:"环境名称",prop:"envName"},{default:n(()=>[e(N,{modelValue:a(s).envName,"onUpdate:modelValue":l[0]||(l[0]=t=>a(s).envName=t),placeholder:"请输入环境名称",clearable:"",style:{width:"200px"},onKeyup:we(T,["enter"])},null,8,["modelValue"])]),_:1}),e(m,{label:"状态",prop:"status"},{default:n(()=>[e(ue,{modelValue:a(s).status,"onUpdate:modelValue":l[1]||(l[1]=t=>a(s).status=t),placeholder:"环境状态",clearable:"",style:{width:"200px"}},{default:n(()=>[(i(!0),U(P,null,q(a(S),t=>(i(),h(oe,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(m,null,{default:n(()=>[e(de,null,{default:n(()=>l[11]||(l[11]=[v("仅自己的数据")])),_:1})]),_:1}),e(m,null,{default:n(()=>[e(r,{type:"primary",icon:"Search",onClick:T},{default:n(()=>l[12]||(l[12]=[v("搜索")])),_:1}),e(r,{icon:"Refresh",onClick:Z},{default:n(()=>l[13]||(l[13]=[v("重置")])),_:1})]),_:1})]),_:1},8,["model"]),[[A,a(V)]]),e(x,{gutter:10,class:"mb8"},{default:n(()=>[e(_,{span:1.5},{default:n(()=>[b((i(),h(r,{type:"primary",plain:"",icon:"Plus",onClick:ee},{default:n(()=>l[14]||(l[14]=[v("新增 ")])),_:1})),[[w,["hrm:env:add"]]])]),_:1}),e(se,{showSearch:a(V),"onUpdate:showSearch":l[2]||(l[2]=t=>G(V)?V.value=t:null),onQueryTable:y},null,8,["showSearch"])]),_:1}),a(j)?b((i(),h(ie,{key:0,border:"",data:a(F),"row-key":"envId","default-expand-all":a(O),"table-layout":"fixed","max-height":"calc(100vh - 280px)"},{default:n(()=>[e(g,{prop:"envId",label:"ID",width:"160"}),e(g,{prop:"envName",label:"环境名称"}),e(g,{prop:"envUrl",label:"环境URL"}),e(g,{prop:"orderNum",label:"排序",width:"70"}),e(g,{prop:"status",label:"状态",width:"70"},{default:n(t=>[e(re,{options:a(S),value:t.row.status},null,8,["options","value"])]),_:1}),e(g,{label:"创建时间",align:"center",prop:"createTime","class-name":"small-padding fixed-width",width:"150"},{default:n(t=>[D("span",null,z(d.parseTime(t.row.createTime)),1)]),_:1}),e(g,{label:"更新时间",align:"center",prop:"updateTime","class-name":"small-padding fixed-width",width:"150"},{default:n(t=>[D("span",null,z(d.parseTime(t.row.updateTime)),1)]),_:1}),e(g,{label:"操作",align:"center","class-name":"small-padding fixed-width",width:"110px",fixed:"right"},{default:n(t=>[b(e(r,{link:"",type:"primary",icon:"Edit",onClick:k=>le(t.row)},null,8,["onClick"]),[[w,["hrm:env:edit","hrm:env:detail"]]]),b(e(r,{link:"",type:"warning",icon:"CopyDocument",onClick:k=>ae(t.row)},null,8,["onClick"]),[[w,["hrm:env:copy"]]]),b(e(r,{link:"",type:"danger",icon:"Delete",onClick:k=>ne(t.row)},null,8,["onClick"]),[[w,["hrm:env:remove"]]])]),_:1})]),_:1},8,["data","default-expand-all"])),[[ge,a(E)]]):ke("",!0),b(e(pe,{total:a(I),page:a(s).pageNum,"onUpdate:page":l[3]||(l[3]=t=>a(s).pageNum=t),limit:a(s).pageSize,"onUpdate:limit":l[4]||(l[4]=t=>a(s).pageSize=t),onPagination:y},null,8,["total","page","limit"]),[[A,a(I)>0]]),e(_e,{title:a($),modelValue:a(c),"onUpdate:modelValue":l[10]||(l[10]=t=>G(c)?c.value=t:null),width:"70%","append-to-body":""},{footer:n(()=>[e(ce,{position:"bottom",offset:20},{default:n(()=>[D("div",Pe,[b((i(),h(r,{type:"primary",onClick:te},{default:n(()=>l[17]||(l[17]=[v("确 定")])),_:1})),[[w,["hrm:env:edit"]]]),e(r,{onClick:Y},{default:n(()=>l[18]||(l[18]=[v("取 消")])),_:1})])]),_:1})]),default:n(()=>[e(L,{ref:"envRef",model:a(u),rules:a(J),"label-width":"80px"},{default:n(()=>[e(x,null,{default:n(()=>[e(_,{span:12},{default:n(()=>[e(m,{label:"环境名称",prop:"envName"},{default:n(()=>[e(N,{modelValue:a(u).envName,"onUpdate:modelValue":l[5]||(l[5]=t=>a(u).envName=t),placeholder:"请输入环境名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(_,{span:12},{default:n(()=>[e(m,{label:"显示排序",prop:"orderNum"},{default:n(()=>[e(me,{modelValue:a(u).orderNum,"onUpdate:modelValue":l[6]||(l[6]=t=>a(u).orderNum=t),"controls-position":"right",min:0},null,8,["modelValue"])]),_:1})]),_:1}),e(_,{span:12},{default:n(()=>[e(m,{label:"环境地址",prop:"envUrl"},{default:n(()=>[e(N,{modelValue:a(u).envUrl,"onUpdate:modelValue":l[7]||(l[7]=t=>a(u).envUrl=t),placeholder:"请输入URL地址",maxlength:"200"},null,8,["modelValue"])]),_:1})]),_:1}),e(_,{span:12},{default:n(()=>[e(m,{label:"环境描述",prop:"simpleDesc"},{default:n(()=>[e(N,{modelValue:a(u).simpleDesc,"onUpdate:modelValue":l[8]||(l[8]=t=>a(u).simpleDesc=t),placeholder:"请输入描述",maxlength:"400"},null,8,["modelValue"])]),_:1})]),_:1}),e(_,{span:12},{default:n(()=>[e(m,{label:"环境状态"},{default:n(()=>[e(ve,{modelValue:a(u).status,"onUpdate:modelValue":l[9]||(l[9]=t=>a(u).status=t)},{default:n(()=>[(i(!0),U(P,null,q(a(S),t=>(i(),h(fe,{key:t.value,value:t.value},{default:n(()=>[v(z(t.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(x,{style:{"padding-bottom":"20px"}},{default:n(()=>[e(_,null,{default:n(()=>[e(B,null,{default:n(()=>l[15]||(l[15]=[v("添加环境分组：")])),_:1}),e(K,{content:"添加环境变量分组",placement:"top-start"},{default:n(()=>[e(r,{size:"small",type:"success",icon:"Plus",onClick:W})]),_:1})]),_:1})]),_:1}),e(x,null,{default:n(()=>[(i(!0),U(P,null,q(a(u).envConfig.variables,(t,k)=>(i(),h(_,{key:k,style:{"padding-bottom":"20px"}},{default:n(()=>[D("div",Te,[e(B,null,{default:n(()=>l[16]||(l[16]=[v("分组名称：")])),_:1}),e(Ie,{content:t.key,"onUpdate:content":C=>t.key=C},null,8,["content","onUpdate:content"]),e(K,{content:"删除环境变量分组",placement:"top-start"},{default:n(()=>[e(r,{size:"small",type:"danger",icon:"Delete",onClick:C=>X(k)},null,8,["onClick"])]),_:2},1024)]),e($e,{modelValue:t.value,"onUpdate:modelValue":C=>t.value=C},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024))),128))]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}});export{Ae as default};
