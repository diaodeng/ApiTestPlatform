{"version":3,"file":"index.CkAl7Gqs.js","sources":["../../../src/views/system/user/index.vue"],"sourcesContent":["<template>\r\n   <div class=\"app-container\">\r\n      <el-row :gutter=\"20\">\r\n         <!--部门数据-->\r\n         <el-col :span=\"4\" :xs=\"24\">\r\n            <div class=\"head-container\">\r\n               <el-input\r\n                  v-model=\"deptName\"\r\n                  placeholder=\"请输入部门名称\"\r\n                  clearable\r\n                  prefix-icon=\"Search\"\r\n                  style=\"margin-bottom: 20px\"\r\n               />\r\n            </div>\r\n            <div class=\"head-container\">\r\n               <el-tree\r\n                  :data=\"deptOptions\"\r\n                  :props=\"{ label: 'label', children: 'children' }\"\r\n                  :expand-on-click-node=\"false\"\r\n                  :filter-node-method=\"filterNode\"\r\n                  ref=\"deptTreeRef\"\r\n                  node-key=\"id\"\r\n                  highlight-current\r\n                  default-expand-all\r\n                  @node-click=\"handleNodeClick\"\r\n               />\r\n            </div>\r\n         </el-col>\r\n         <!--用户数据-->\r\n         <el-col :span=\"20\" :xs=\"24\">\r\n            <el-form :model=\"queryParams\" ref=\"queryRef\" :inline=\"true\" v-show=\"showSearch\" label-width=\"68px\">\r\n               <el-form-item label=\"用户名称\" prop=\"userName\">\r\n                  <el-input\r\n                     v-model=\"queryParams.userName\"\r\n                     placeholder=\"请输入用户名称\"\r\n                     clearable\r\n                     style=\"width: 240px\"\r\n                     @keyup.enter=\"handleQuery\"\r\n                  />\r\n               </el-form-item>\r\n               <el-form-item label=\"手机号码\" prop=\"phonenumber\">\r\n                  <el-input\r\n                     v-model=\"queryParams.phonenumber\"\r\n                     placeholder=\"请输入手机号码\"\r\n                     clearable\r\n                     style=\"width: 240px\"\r\n                     @keyup.enter=\"handleQuery\"\r\n                  />\r\n               </el-form-item>\r\n               <el-form-item label=\"状态\" prop=\"status\">\r\n                  <el-select\r\n                     v-model=\"queryParams.status\"\r\n                     placeholder=\"用户状态\"\r\n                     clearable\r\n                     style=\"width: 240px\"\r\n                  >\r\n                     <el-option\r\n                        v-for=\"dict in sys_normal_disable\"\r\n                        :key=\"dict.value\"\r\n                        :label=\"dict.label\"\r\n                        :value=\"dict.value\"\r\n                     />\r\n                  </el-select>\r\n               </el-form-item>\r\n               <el-form-item label=\"创建时间\" style=\"width: 308px;\">\r\n                  <el-date-picker\r\n                     v-model=\"dateRange\"\r\n                     value-format=\"YYYY-MM-DD\"\r\n                     type=\"daterange\"\r\n                     range-separator=\"-\"\r\n                     start-placeholder=\"开始日期\"\r\n                     end-placeholder=\"结束日期\"\r\n                  ></el-date-picker>\r\n               </el-form-item>\r\n               <el-form-item>\r\n                  <el-button type=\"primary\" icon=\"Search\" @click=\"handleQuery\">搜索</el-button>\r\n                  <el-button icon=\"Refresh\" @click=\"resetQuery\">重置</el-button>\r\n               </el-form-item>\r\n            </el-form>\r\n\r\n            <el-row :gutter=\"10\" class=\"mb8\">\r\n               <el-col :span=\"1.5\">\r\n                  <el-button\r\n                     type=\"primary\"\r\n                     plain\r\n                     icon=\"Plus\"\r\n                     @click=\"handleAdd\"\r\n                     v-hasPermi=\"['system:user:add']\"\r\n                  >新增</el-button>\r\n               </el-col>\r\n               <el-col :span=\"1.5\">\r\n                  <el-button\r\n                     type=\"success\"\r\n                     plain\r\n                     icon=\"Edit\"\r\n                     :disabled=\"single\"\r\n                     @click=\"handleUpdate\"\r\n                     v-hasPermi=\"['system:user:edit']\"\r\n                  >修改</el-button>\r\n               </el-col>\r\n               <el-col :span=\"1.5\">\r\n                  <el-button\r\n                     type=\"danger\"\r\n                     plain\r\n                     icon=\"Delete\"\r\n                     :disabled=\"multiple\"\r\n                     @click=\"handleDelete\"\r\n                     v-hasPermi=\"['system:user:remove']\"\r\n                  >删除</el-button>\r\n               </el-col>\r\n               <el-col :span=\"1.5\">\r\n                  <el-button\r\n                     type=\"info\"\r\n                     plain\r\n                     icon=\"Upload\"\r\n                     @click=\"handleImport\"\r\n                     v-hasPermi=\"['system:user:import']\"\r\n                  >导入</el-button>\r\n               </el-col>\r\n               <el-col :span=\"1.5\">\r\n                  <el-button\r\n                     type=\"warning\"\r\n                     plain\r\n                     icon=\"Download\"\r\n                     @click=\"handleExport\"\r\n                     v-hasPermi=\"['system:user:export']\"\r\n                  >导出</el-button>\r\n               </el-col>\r\n               <right-toolbar v-model:showSearch=\"showSearch\" @queryTable=\"getList\" :columns=\"columns\"></right-toolbar>\r\n            </el-row>\r\n\r\n            <el-table v-loading=\"loading\" :data=\"userList\" @selection-change=\"handleSelectionChange\">\r\n               <el-table-column type=\"selection\" width=\"50\" align=\"center\" />\r\n               <el-table-column label=\"用户编号\" align=\"center\" key=\"userId\" prop=\"userId\" v-if=\"columns[0].visible\" />\r\n               <el-table-column label=\"用户名称\" align=\"center\" key=\"userName\" prop=\"userName\" v-if=\"columns[1].visible\" :show-overflow-tooltip=\"true\" />\r\n               <el-table-column label=\"用户昵称\" align=\"center\" key=\"nickName\" prop=\"nickName\" v-if=\"columns[2].visible\" :show-overflow-tooltip=\"true\" />\r\n               <el-table-column label=\"部门\" align=\"center\" key=\"deptName\" prop=\"dept.deptName\" v-if=\"columns[3].visible\" :show-overflow-tooltip=\"true\" />\r\n               <el-table-column label=\"手机号码\" align=\"center\" key=\"phonenumber\" prop=\"phonenumber\" v-if=\"columns[4].visible\" width=\"120\" />\r\n               <el-table-column label=\"状态\" align=\"center\" key=\"status\" v-if=\"columns[5].visible\">\r\n                  <template #default=\"scope\">\r\n                     <el-switch\r\n                        v-model=\"scope.row.status\"\r\n                        active-value=\"0\"\r\n                        inactive-value=\"1\"\r\n                        @change=\"handleStatusChange(scope.row)\"\r\n                     ></el-switch>\r\n                  </template>\r\n               </el-table-column>\r\n               <el-table-column label=\"创建时间\" align=\"center\" prop=\"createTime\" v-if=\"columns[6].visible\" width=\"160\">\r\n                  <template #default=\"scope\">\r\n                     <span>{{ parseTime(scope.row.createTime) }}</span>\r\n                  </template>\r\n               </el-table-column>\r\n               <el-table-column label=\"操作\" align=\"center\" width=\"150\" class-name=\"small-padding fixed-width\">\r\n                  <template #default=\"scope\">\r\n                     <el-tooltip content=\"修改\" placement=\"top\" v-if=\"scope.row.userId !== 1\">\r\n                        <el-button link type=\"primary\" icon=\"Edit\" @click=\"handleUpdate(scope.row)\" v-hasPermi=\"['system:user:edit']\"></el-button>\r\n                     </el-tooltip>\r\n                     <el-tooltip content=\"删除\" placement=\"top\" v-if=\"scope.row.userId !== 1\">\r\n                        <el-button link type=\"primary\" icon=\"Delete\" @click=\"handleDelete(scope.row)\" v-hasPermi=\"['system:user:remove']\"></el-button>\r\n                     </el-tooltip>\r\n                     <el-tooltip content=\"重置密码\" placement=\"top\" v-if=\"scope.row.userId !== 1\">\r\n                         <el-button link type=\"primary\" icon=\"Key\" @click=\"handleResetPwd(scope.row)\" v-hasPermi=\"['system:user:resetPwd']\"></el-button>\r\n                     </el-tooltip>\r\n                     <el-tooltip content=\"分配角色\" placement=\"top\" v-if=\"scope.row.userId !== 1\">\r\n                        <el-button link type=\"primary\" icon=\"CircleCheck\" @click=\"handleAuthRole(scope.row)\" v-hasPermi=\"['system:user:edit']\"></el-button>\r\n                     </el-tooltip>\r\n                  </template>\r\n               </el-table-column>\r\n            </el-table>\r\n            <pagination\r\n               v-show=\"total > 0\"\r\n               :total=\"total\"\r\n               v-model:page=\"queryParams.pageNum\"\r\n               v-model:limit=\"queryParams.pageSize\"\r\n               @pagination=\"getList\"\r\n            />\r\n         </el-col>\r\n      </el-row>\r\n\r\n      <!-- 添加或修改用户配置对话框 -->\r\n      <el-dialog :title=\"title\" v-model=\"open\" width=\"600px\" append-to-body>\r\n         <el-form :model=\"form\" :rules=\"rules\" ref=\"userRef\" label-width=\"80px\">\r\n            <el-row>\r\n               <el-col :span=\"12\">\r\n                  <el-form-item label=\"用户昵称\" prop=\"nickName\">\r\n                     <el-input v-model=\"form.nickName\" placeholder=\"请输入用户昵称\" maxlength=\"30\" />\r\n                  </el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"12\">\r\n                  <el-form-item label=\"归属部门\" prop=\"deptId\">\r\n                     <el-tree-select\r\n                        v-model=\"form.deptId\"\r\n                        :data=\"deptOptions\"\r\n                        :props=\"{ value: 'id', label: 'label', children: 'children' }\"\r\n                        value-key=\"id\"\r\n                        placeholder=\"请选择归属部门\"\r\n                        check-strictly\r\n                     />\r\n                  </el-form-item>\r\n               </el-col>\r\n            </el-row>\r\n            <el-row>\r\n               <el-col :span=\"12\">\r\n                  <el-form-item label=\"手机号码\" prop=\"phonenumber\">\r\n                     <el-input v-model=\"form.phonenumber\" placeholder=\"请输入手机号码\" maxlength=\"11\" />\r\n                  </el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"12\">\r\n                  <el-form-item label=\"邮箱\" prop=\"email\">\r\n                     <el-input v-model=\"form.email\" placeholder=\"请输入邮箱\" maxlength=\"50\" />\r\n                  </el-form-item>\r\n               </el-col>\r\n            </el-row>\r\n            <el-row>\r\n               <el-col :span=\"12\">\r\n                  <el-form-item v-if=\"form.userId == undefined\" label=\"用户名称\" prop=\"userName\">\r\n                     <el-input v-model=\"form.userName\" placeholder=\"请输入用户名称\" maxlength=\"30\" />\r\n                  </el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"12\">\r\n                  <el-form-item v-if=\"form.userId == undefined\" label=\"用户密码\" prop=\"password\">\r\n                     <el-input v-model=\"form.password\" placeholder=\"请输入用户密码\" type=\"password\" maxlength=\"20\" show-password />\r\n                  </el-form-item>\r\n               </el-col>\r\n            </el-row>\r\n            <el-row>\r\n               <el-col :span=\"12\">\r\n                  <el-form-item label=\"用户性别\">\r\n                     <el-select v-model=\"form.sex\" placeholder=\"请选择\">\r\n                        <el-option\r\n                           v-for=\"dict in sys_user_sex\"\r\n                           :key=\"dict.value\"\r\n                           :label=\"dict.label\"\r\n                           :value=\"dict.value\"\r\n                        ></el-option>\r\n                     </el-select>\r\n                  </el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"12\">\r\n                  <el-form-item label=\"状态\">\r\n                     <el-radio-group v-model=\"form.status\">\r\n                        <el-radio\r\n                           v-for=\"dict in sys_normal_disable\"\r\n                           :key=\"dict.value\"\r\n                           :label=\"dict.value\"\r\n                        >{{ dict.label }}</el-radio>\r\n                     </el-radio-group>\r\n                  </el-form-item>\r\n               </el-col>\r\n            </el-row>\r\n            <el-row>\r\n               <el-col :span=\"12\">\r\n                  <el-form-item label=\"岗位\">\r\n                     <el-select v-model=\"form.postIds\" multiple placeholder=\"请选择\">\r\n                        <el-option\r\n                           v-for=\"item in postOptions\"\r\n                           :key=\"item.postId\"\r\n                           :label=\"item.postName\"\r\n                           :value=\"item.postId\"\r\n                           :disabled=\"item.status == 1\"\r\n                        ></el-option>\r\n                     </el-select>\r\n                  </el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"12\">\r\n                  <el-form-item label=\"角色\">\r\n                     <el-select v-model=\"form.roleIds\" multiple placeholder=\"请选择\">\r\n                        <el-option\r\n                           v-for=\"item in roleOptions\"\r\n                           :key=\"item.roleId\"\r\n                           :label=\"item.roleName\"\r\n                           :value=\"item.roleId\"\r\n                           :disabled=\"item.status == 1\"\r\n                        ></el-option>\r\n                     </el-select>\r\n                  </el-form-item>\r\n               </el-col>\r\n            </el-row>\r\n            <el-row>\r\n               <el-col :span=\"24\">\r\n                  <el-form-item label=\"备注\">\r\n                     <el-input v-model=\"form.remark\" type=\"textarea\" placeholder=\"请输入内容\"></el-input>\r\n                  </el-form-item>\r\n               </el-col>\r\n            </el-row>\r\n         </el-form>\r\n         <template #footer>\r\n            <div class=\"dialog-footer\">\r\n               <el-button type=\"primary\" @click=\"submitForm\">确 定</el-button>\r\n               <el-button @click=\"cancel\">取 消</el-button>\r\n            </div>\r\n         </template>\r\n      </el-dialog>\r\n\r\n      <!-- 用户导入对话框 -->\r\n      <el-dialog :title=\"upload.title\" v-model=\"upload.open\" width=\"400px\" append-to-body>\r\n         <el-upload\r\n            ref=\"uploadRef\"\r\n            :limit=\"1\"\r\n            accept=\".xlsx, .xls\"\r\n            :headers=\"upload.headers\"\r\n            :action=\"upload.url + '?updateSupport=' + upload.updateSupport\"\r\n            :disabled=\"upload.isUploading\"\r\n            :on-progress=\"handleFileUploadProgress\"\r\n            :on-success=\"handleFileSuccess\"\r\n            :auto-upload=\"false\"\r\n            drag\r\n         >\r\n            <el-icon class=\"el-icon--upload\"><upload-filled /></el-icon>\r\n            <div class=\"el-upload__text\">将文件拖到此处，或<em>点击上传</em></div>\r\n            <template #tip>\r\n               <div class=\"el-upload__tip text-center\">\r\n                  <div class=\"el-upload__tip\">\r\n                     <el-checkbox v-model=\"upload.updateSupport\" />是否更新已经存在的用户数据\r\n                  </div>\r\n                  <span>仅允许导入xls、xlsx格式文件。</span>\r\n                  <el-link type=\"primary\" :underline=\"false\" style=\"font-size:12px;vertical-align: baseline;\" @click=\"importTemplate\">下载模板</el-link>\r\n               </div>\r\n            </template>\r\n         </el-upload>\r\n         <template #footer>\r\n            <div class=\"dialog-footer\">\r\n               <el-button type=\"primary\" @click=\"submitFileForm\">确 定</el-button>\r\n               <el-button @click=\"upload.open = false\">取 消</el-button>\r\n            </div>\r\n         </template>\r\n      </el-dialog>\r\n   </div>\r\n</template>\r\n\r\n<script setup name=\"User\">\r\nimport { getToken } from \"@/utils/auth\";\r\nimport { changeUserStatus, listUser, resetUserPwd, delUser, getUser, updateUser, addUser, deptTreeSelect } from \"@/api/system/user\";\r\n\r\nconst router = useRouter();\r\nconst { proxy } = getCurrentInstance();\r\nconst { sys_normal_disable, sys_user_sex } = proxy.useDict(\"sys_normal_disable\", \"sys_user_sex\");\r\n\r\nconst userList = ref([]);\r\nconst open = ref(false);\r\nconst loading = ref(true);\r\nconst showSearch = ref(true);\r\nconst ids = ref([]);\r\nconst single = ref(true);\r\nconst multiple = ref(true);\r\nconst total = ref(0);\r\nconst title = ref(\"\");\r\nconst dateRange = ref([]);\r\nconst deptName = ref(\"\");\r\nconst deptOptions = ref(undefined);\r\nconst initPassword = ref(undefined);\r\nconst postOptions = ref([]);\r\nconst roleOptions = ref([]);\r\n/*** 用户导入参数 */\r\nconst upload = reactive({\r\n  // 是否显示弹出层（用户导入）\r\n  open: false,\r\n  // 弹出层标题（用户导入）\r\n  title: \"\",\r\n  // 是否禁用上传\r\n  isUploading: false,\r\n  // 是否更新已经存在的用户数据\r\n  updateSupport: 0,\r\n  // 设置上传的请求头部\r\n  headers: { Authorization: \"Bearer \" + getToken() },\r\n  // 上传的地址\r\n  url: import.meta.env.VITE_APP_BASE_API + \"/system/user/importData\"\r\n});\r\n// 列显隐信息\r\nconst columns = ref([\r\n  { key: 0, label: `用户编号`, visible: true },\r\n  { key: 1, label: `用户名称`, visible: true },\r\n  { key: 2, label: `用户昵称`, visible: true },\r\n  { key: 3, label: `部门`, visible: true },\r\n  { key: 4, label: `手机号码`, visible: true },\r\n  { key: 5, label: `状态`, visible: true },\r\n  { key: 6, label: `创建时间`, visible: true }\r\n]);\r\n\r\nconst data = reactive({\r\n  form: {},\r\n  queryParams: {\r\n    pageNum: 1,\r\n    pageSize: 10,\r\n    userName: undefined,\r\n    phonenumber: undefined,\r\n    status: undefined,\r\n    deptId: undefined\r\n  },\r\n  rules: {\r\n    userName: [{ required: true, message: \"用户名称不能为空\", trigger: \"blur\" }, { min: 2, max: 20, message: \"用户名称长度必须介于 2 和 20 之间\", trigger: \"blur\" }],\r\n    nickName: [{ required: true, message: \"用户昵称不能为空\", trigger: \"blur\" }],\r\n    password: [{ required: true, message: \"用户密码不能为空\", trigger: \"blur\" }, { min: 5, max: 20, message: \"用户密码长度必须介于 5 和 20 之间\", trigger: \"blur\" }],\r\n    email: [{ type: \"email\", message: \"请输入正确的邮箱地址\", trigger: [\"blur\", \"change\"] }],\r\n    phonenumber: [{ pattern: /^1[3|4|5|6|7|8|9][0-9]\\d{8}$/, message: \"请输入正确的手机号码\", trigger: \"blur\" }]\r\n  }\r\n});\r\n\r\nconst { queryParams, form, rules } = toRefs(data);\r\n\r\n/** 通过条件过滤节点  */\r\nconst filterNode = (value, data) => {\r\n  if (!value) return true;\r\n  return data.label.indexOf(value) !== -1;\r\n};\r\n/** 根据名称筛选部门树 */\r\nwatch(deptName, val => {\r\n  proxy.$refs[\"deptTreeRef\"].filter(val);\r\n});\r\n/** 查询部门下拉树结构 */\r\nfunction getDeptTree() {\r\n  deptTreeSelect().then(response => {\r\n    deptOptions.value = response.data;\r\n  });\r\n};\r\n/** 查询用户列表 */\r\nfunction getList() {\r\n  loading.value = true;\r\n  listUser(proxy.addDateRange(queryParams.value, dateRange.value)).then(res => {\r\n    loading.value = false;\r\n    userList.value = res.rows;\r\n    total.value = res.total;\r\n  });\r\n};\r\n/** 节点单击事件 */\r\nfunction handleNodeClick(data) {\r\n  queryParams.value.deptId = data.id;\r\n  handleQuery();\r\n};\r\n/** 搜索按钮操作 */\r\nfunction handleQuery() {\r\n  queryParams.value.pageNum = 1;\r\n  getList();\r\n};\r\n/** 重置按钮操作 */\r\nfunction resetQuery() {\r\n  dateRange.value = [];\r\n  proxy.resetForm(\"queryRef\");\r\n  queryParams.value.deptId = undefined;\r\n  proxy.$refs.deptTreeRef.setCurrentKey(null);\r\n  handleQuery();\r\n};\r\n/** 删除按钮操作 */\r\nfunction handleDelete(row) {\r\n  const userIds = row.userId || ids.value;\r\n  proxy.$modal.confirm('是否确认删除用户编号为\"' + userIds + '\"的数据项？').then(function () {\r\n    return delUser(userIds);\r\n  }).then(() => {\r\n    getList();\r\n    proxy.$modal.msgSuccess(\"删除成功\");\r\n  }).catch(() => {});\r\n};\r\n/** 导出按钮操作 */\r\nfunction handleExport() {\r\n  proxy.download(\"system/user/export\", {\r\n    ...queryParams.value,\r\n  },`user_${new Date().getTime()}.xlsx`);\r\n};\r\n/** 用户状态修改  */\r\nfunction handleStatusChange(row) {\r\n  let text = row.status === \"0\" ? \"启用\" : \"停用\";\r\n  proxy.$modal.confirm('确认要\"' + text + '\"\"' + row.userName + '\"用户吗?').then(function () {\r\n    return changeUserStatus(row.userId, row.status);\r\n  }).then(() => {\r\n    proxy.$modal.msgSuccess(text + \"成功\");\r\n  }).catch(function () {\r\n    row.status = row.status === \"0\" ? \"1\" : \"0\";\r\n  });\r\n};\r\n/** 更多操作 */\r\nfunction handleCommand(command, row) {\r\n  switch (command) {\r\n    case \"handleResetPwd\":\r\n      handleResetPwd(row);\r\n      break;\r\n    case \"handleAuthRole\":\r\n      handleAuthRole(row);\r\n      break;\r\n    default:\r\n      break;\r\n  }\r\n};\r\n/** 跳转角色分配 */\r\nfunction handleAuthRole(row) {\r\n  const userId = row.userId;\r\n  router.push(\"/system/user-auth/role/\" + userId);\r\n};\r\n/** 重置密码按钮操作 */\r\nfunction handleResetPwd(row) {\r\n  proxy.$prompt('请输入\"' + row.userName + '\"的新密码', \"提示\", {\r\n    confirmButtonText: \"确定\",\r\n    cancelButtonText: \"取消\",\r\n    closeOnClickModal: false,\r\n    inputPattern: /^.{5,20}$/,\r\n    inputErrorMessage: \"用户密码长度必须介于 5 和 20 之间\",\r\n  }).then(({ value }) => {\r\n    resetUserPwd(row.userId, value).then(response => {\r\n      proxy.$modal.msgSuccess(\"修改成功，新密码是：\" + value);\r\n    });\r\n  }).catch(() => {});\r\n};\r\n/** 选择条数  */\r\nfunction handleSelectionChange(selection) {\r\n  ids.value = selection.map(item => item.userId);\r\n  single.value = selection.length != 1;\r\n  multiple.value = !selection.length;\r\n};\r\n/** 导入按钮操作 */\r\nfunction handleImport() {\r\n  upload.title = \"用户导入\";\r\n  upload.open = true;\r\n};\r\n/** 下载模板操作 */\r\nfunction importTemplate() {\r\n  proxy.download(\"system/user/importTemplate\", {\r\n  }, `user_template_${new Date().getTime()}.xlsx`);\r\n};\r\n/**文件上传中处理 */\r\nconst handleFileUploadProgress = (event, file, fileList) => {\r\n  upload.isUploading = true;\r\n};\r\n/** 文件上传成功处理 */\r\nconst handleFileSuccess = (response, file, fileList) => {\r\n  upload.open = false;\r\n  upload.isUploading = false;\r\n  proxy.$refs[\"uploadRef\"].handleRemove(file);\r\n  proxy.$alert(\"<div style='overflow: auto;overflow-x: hidden;max-height: 70vh;padding: 10px 20px 0;'>\" + response.msg + \"</div>\", \"导入结果\", { dangerouslyUseHTMLString: true });\r\n  getList();\r\n};\r\n/** 提交上传文件 */\r\nfunction submitFileForm() {\r\n  proxy.$refs[\"uploadRef\"].submit();\r\n};\r\n/** 重置操作表单 */\r\nfunction reset() {\r\n  form.value = {\r\n    userId: undefined,\r\n    deptId: undefined,\r\n    userName: undefined,\r\n    nickName: undefined,\r\n    password: undefined,\r\n    phonenumber: undefined,\r\n    email: undefined,\r\n    sex: undefined,\r\n    status: \"0\",\r\n    remark: undefined,\r\n    postIds: [],\r\n    roleIds: []\r\n  };\r\n  proxy.resetForm(\"userRef\");\r\n};\r\n/** 取消按钮 */\r\nfunction cancel() {\r\n  open.value = false;\r\n  reset();\r\n};\r\n/** 新增按钮操作 */\r\nfunction handleAdd() {\r\n  reset();\r\n  getUser().then(response => {\r\n    postOptions.value = response.posts;\r\n    roleOptions.value = response.roles;\r\n    open.value = true;\r\n    title.value = \"添加用户\";\r\n    form.value.password = initPassword.value;\r\n  });\r\n};\r\n/** 修改按钮操作 */\r\nfunction handleUpdate(row) {\r\n  reset();\r\n  const userId = row.userId || ids.value;\r\n  getUser(userId).then(response => {\r\n    form.value = response.data;\r\n    postOptions.value = response.posts;\r\n    roleOptions.value = response.roles;\r\n    form.value.postIds = response.postIds;\r\n    form.value.roleIds = response.roleIds;\r\n    open.value = true;\r\n    title.value = \"修改用户\";\r\n    form.password = \"\";\r\n  });\r\n};\r\n/** 提交按钮 */\r\nfunction submitForm() {\r\n  proxy.$refs[\"userRef\"].validate(valid => {\r\n    if (valid) {\r\n      if (form.value.userId != undefined) {\r\n        updateUser(form.value).then(response => {\r\n          proxy.$modal.msgSuccess(\"修改成功\");\r\n          open.value = false;\r\n          getList();\r\n        });\r\n      } else {\r\n        addUser(form.value).then(response => {\r\n          proxy.$modal.msgSuccess(\"新增成功\");\r\n          open.value = false;\r\n          getList();\r\n        });\r\n      }\r\n    }\r\n  });\r\n};\r\n\r\ngetDeptTree();\r\ngetList();\r\n</script>\r\n"],"names":["router","useRouter","proxy","getCurrentInstance","sys_normal_disable","sys_user_sex","userList","ref","open","loading","showSearch","ids","single","multiple","total","title","dateRange","deptName","deptOptions","initPassword","postOptions","roleOptions","upload","reactive","getToken","columns","data","queryParams","form","rules","toRefs","filterNode","value","watch","val","getDeptTree","deptTreeSelect","response","getList","listUser","res","handleNodeClick","handleQuery","resetQuery","handleDelete","row","userIds","delUser","handleExport","handleStatusChange","text","changeUserStatus","handleAuthRole","userId","handleResetPwd","resetUserPwd","handleSelectionChange","selection","item","handleImport","importTemplate","handleFileUploadProgress","event","file","fileList","handleFileSuccess","submitFileForm","reset","cancel","handleAdd","getUser","handleUpdate","submitForm","valid","updateUser","addUser"],"mappings":"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"}