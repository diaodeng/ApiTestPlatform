import{_ as be,r as k,a1 as je,d as s,o as y,l as U,f as t,m as J,aD as Ve,h as a,aE as De,at as Q,au as A,w as ve,Q as He,I as F,U as ae,c as O,P as B,a7 as te,z as oe,F as qe,af as Ae,y as me,e,$ as W,W as ke,aF as Fe,p as V,v as ge,E as Re,q as xe,n as G,aB as Xe,aG as Qe,D as Te,az as Ye,S as Ge,V as Ie,J as Ce,k as Ne,aC as $e,C as Ze}from"./index.CHnR_MAu.js";import{l as et,d as tt,a as lt}from"./run_detail.CgntWMNI.js";import{H as X,C as Z,E as H,R as at,l as Oe,r as we}from"./project.BpVuymad.js";import{g as Pe,u as nt,e as ot,d as ut}from"./case.CZLC1pq4.js";import{a as he,b as st,_ as _e}from"./table-variables.iSiz_YnM.js";import{b as Ee,c as ce,d as dt,i as Ke}from"./data-template.CF-ivY4r.js";import{J as ue,d as fe,r as ze,c as it}from"./tools.B8u06WSF.js";import{A as ie}from"./ace-editor.UAWmui2X.js";import{s as rt}from"./module.BMNy9Seo.js";import{l as pt}from"./env.jLYomLFD.js";const mt={style:{"align-items":"center",height:"auto",display:"flex","justify-content":"center",position:"relative","background-color":"#f1f3f6","border-radius":"5px"}},ct={__name:"split-window",props:{leftWidth:{type:[String,Number],default:"200px"},windowWidth:{type:[String,Number],default:"100%"},windowHeight:{type:[String,Number],default:"100%"}},setup(n){const c=n;let o=k(null),d=k(null),l=k(null),g=k(null),i=k(0),m=k(500),v=k(je(c.leftWidth));const b=k(!1),r=$=>{if(b.value){let j=$.pageX,q=m.value+(j-i.value),u=o.value.offsetWidth-l.value.offsetWidth-q;v.value=q+"px",g.value.style.width=u+"px"}};function R($){window.addEventListener("mousemove",r),window.addEventListener("mouseup",h),b.value=!0,l.value.background="#818181",m.value=d.value.offsetWidth,i.value=$.pageX}function h($){window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",h),b.value=!1,l.value.background="#d6d6d6"}function M($){let j=d.value.offsetWidth,q=o.value.offsetWidth-l.value.offsetWidth-j;q>=20&&(g.value.style.width=q+"px")}return($,j)=>{const q=s("el-container");return y(),U(q,null,{default:t(()=>[J("div",{class:"box",ref_key:"boxRef",ref:o,style:Ve({width:n.windowWidth,height:n.windowHeight}),onResize:M},[J("div",{class:"left",ref_key:"leftRef",ref:d,style:Ve([{width:a(v)},{height:"100%"}])},[De($.$slots,"left",{},void 0,!0)],4),J("div",mt,[J("div",{class:"resize",ref_key:"resizeRef",ref:l,onMousedown:R,style:{height:"auto"}},"⋮",544)]),J("div",{class:"right",ref_key:"rightRef",ref:g},[De($.$slots,"right",{},void 0,!0)],512)],36)]),_:3})}}},Je=be(ct,[["__scopeId","data-v-f5d42170"]]),ft={mounted(n,c){n.clickOutsideEvent=function(o){n===o.target||n.contains(o.target)||c.value()},document.addEventListener("click",n.clickOutsideEvent)},unmounted(n){document.removeEventListener("click",n.clickOutsideEvent)}},vt=["onClick"],_t={__name:"context-menu",props:Q({x:{type:Number,default:0},y:{type:Number,default:0},menus:{type:Array,default:[{title:"右键菜单"}]},evt:{type:Object,default:null}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:Q(["select"],["update:visible"]),setup(n,{emit:c}){const o=n,d=A(n,"visible"),l=k({x:0,y:0}),g=k(null);function i(){d.value=!1}function m(v,b){const{clientWidth:r,clientHeight:R}=document.body,{clientWidth:h,clientHeight:M}=g.value,$=v+h>r?v-h:v,j=b+M>R?b-M:b;l.value.x=$,l.value.y=j}return ve([()=>o.x,()=>o.y],([v,b],r)=>{He(()=>{m(v,b)})}),(v,b)=>F((y(),O("div",{style:Ve({left:a(l).x+"px",top:a(l).y+"px",display:d.value?"block":"none"}),class:"context-menu",ref_key:"menuRef",ref:g},[(y(!0),O(B,null,te(n.menus,(r,R)=>(y(),O("div",{key:R,class:"menu-item",onClick:h=>{d.value=!1,v.$emit("select",r)},style:{display:"flex","flex-direction":"column"}},oe(r.title),9,vt))),128))],4)),[[ae,d.value],[a(ft),i]])}},yt=be(_t,[["__scopeId","data-v-14d581d8"]]),bt={__name:"env-selector",props:Q({disable:{type:Boolean,default:!1}},{selectedEnv:{},selectedEnvModifiers:{}}),emits:["update:selectedEnv"],setup(n){const c=A(n,"selectedEnv"),o=k([]);function d(){pt().then(l=>{o.value=l.data})}return qe(()=>{d()}),(l,g)=>{const i=s("el-option"),m=s("el-select");return y(),U(m,{placeholder:"选择环境",modelValue:c.value,"onUpdate:modelValue":g[0]||(g[0]=v=>c.value=v),style:{width:"115px"},disabled:n.disable},{default:t(()=>[(y(!0),O(B,null,te(a(o),v=>(y(),U(i,{key:v.envId,label:v.envName,value:v.envId},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])}}};function We(n){return Ae({url:"/hrm/config/list",method:"get",params:n})}const Le={__name:"debug_result",props:Q({editHeight:{default:"calc(100vh - 160px)"}},{activeTab:{required:!0,default:"response"},activeTabModifiers:{},stepDetailData:{required:!0},stepDetailDataModifiers:{}}),emits:["update:activeTab","update:stepDetailData"],setup(n){const c=A(n,"activeTab"),o=A(n,"stepDetailData"),d=me({get(){if(o.value.result&&o.value.result.response){let i=o.value.result.response;typeof i=="string"&&(i=ue.parse(fe(i)),o.value.result.response=i);const m=i.body||i.text||"";try{return ue.beautifulJson(m)}catch{return m}}else return""},set(i){o.value.result.response.body=i}}),l=me(()=>{if(o.value.result&&o.value.result.logs){let i=o.value.result.logs;return typeof i=="string"&&(i=ue.parse(fe(i))),(i.before_request||"")+`
`+(i.after_response||"")+`
`+(i.error||"")}else return""}),g=me(()=>{if(o.value.result&&o.value.result.logs){let i=o.value.result.logs;return typeof i=="string"&&(i=ue.parse(fe(i))),i.error||""}else return""});return(i,m)=>{const v=s("el-tab-pane"),b=s("el-tabs");return y(),U(b,{modelValue:c.value,"onUpdate:modelValue":m[3]||(m[3]=r=>c.value=r),class:"request-detail"},{default:t(()=>[e(v,{label:"响应",name:"response"},{default:t(()=>[e(ie,{content:a(d),"onUpdate:content":m[0]||(m[0]=r=>W(d)?d.value=r:null),"can-set":"true","can-search":"true",height:n.editHeight},null,8,["content","height"])]),_:1}),e(v,{label:"日志",name:"logs"},{default:t(()=>[e(ie,{content:a(l),"onUpdate:content":m[1]||(m[1]=r=>W(l)?l.value=r:null),"can-set":"true",height:n.editHeight},null,8,["content","height"])]),_:1}),e(v,{label:"异常",name:"errorLogs"},{default:t(()=>[e(ie,{content:a(g),"onUpdate:content":m[2]||(m[2]=r=>W(g)?g.value=r:null),"can-set":"true",height:n.editHeight},null,8,["content","height"])]),_:1})]),_:1},8,["modelValue"])}}},Se={__name:"table-headers",props:Q({showInclude:{type:Boolean,default:!1}},{selfData:{},selfDataModifiers:{},include:{},includeModifiers:{}}),emits:["update:selfData","update:include"],setup(n){const c=A(n,"selfData"),o=A(n,"include"),d=[{name:"启用",prop:"enable",width:60,type:"switch"},{name:"key",prop:"key",width:300},{name:"value",prop:"value",width:300},{name:"desc",prop:"desc",width:""}],l=ke("hrm_case_config_list");return(g,i)=>{const m=s("el-option"),v=s("el-select"),b=s("el-checkbox");return y(),U(he,{cols:d,modelValue:c.value,"onUpdate:modelValue":i[2]||(i[2]=r=>c.value=r)},Fe({_:2},[n.showInclude?{name:"tableHeader",fn:t(()=>[e(v,{style:{"flex-grow":"1","padding-right":"5px","padding-left":"5px"},placeholder:"请选择配置",modelValue:o.value.config.id,"onUpdate:modelValue":i[0]||(i[0]=r=>o.value.config.id=r)},{default:t(()=>[(y(!0),O(B,null,te(a(l),r=>(y(),U(m,{key:r.caseId,label:r.caseName,value:r.caseId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),e(b,{modelValue:o.value.config.allow_extend,"onUpdate:modelValue":i[1]||(i[1]=r=>o.value.config.allow_extend=r)},{default:t(()=>[V("允许扩展")]),_:1},8,["modelValue"])]),key:"0"}:void 0]),1032,["modelValue"])}}},gt={style:{"flex-grow":"1","padding-left":"5px"}},ht={class:"el-dropdown-link"},wt={__name:"step-request",props:Q(["editHeight"],{stepDetailData:{required:!0},stepDetailDataModifiers:{}}),emits:["update:stepDetailData"],setup(n){const{proxy:c}=ge(),{sys_request_method:o}=c.useDict("sys_request_method"),d=A(n,"stepDetailData"),l=k("requestHeader"),g=k("response");return(i,m)=>{const v=s("arrow-down"),b=s("el-icon"),r=s("el-dropdown-item"),R=s("el-dropdown-menu"),h=s("el-dropdown"),M=s("el-input"),$=s("el-col"),j=s("el-row"),q=s("el-tab-pane"),u=s("el-tabs");return y(),O(B,null,[e(j,{gutter:10,type:"flex",class:"row-bg"},{default:t(()=>[e($,{style:{display:"flex"}},{default:t(()=>[e(st,{"options-dict":a(o),modelValue:d.value.request.method,"onUpdate:modelValue":m[0]||(m[0]=x=>d.value.request.method=x),style:{width:"110px"}},null,8,["options-dict","modelValue"]),J("div",gt,[e(M,{modelValue:d.value.request.url,"onUpdate:modelValue":m[1]||(m[1]=x=>d.value.request.url=x),placeholder:"Please input"},{prepend:t(()=>[V("URL")]),append:t(()=>[e(h,null,{dropdown:t(()=>[e(R,null,{default:t(()=>[e(r,{disabled:""},{default:t(()=>[V("111")]),_:1}),e(r,{disabled:""},{default:t(()=>[V("222")]),_:1})]),_:1})]),default:t(()=>[J("span",ht,[e(b,{class:"el-icon--right"},{default:t(()=>[e(v)]),_:1})])]),_:1})]),_:1},8,["modelValue"])])]),_:1})]),_:1}),e(j,{type:"flex",class:"row-bg",justify:"start",style:{"flex-grow":"1"}},{default:t(()=>[e(Je,{"left-width":"50%"},{left:t(()=>[e(u,{modelValue:a(l),"onUpdate:modelValue":m[7]||(m[7]=x=>W(l)?l.value=x:null),style:{width:"100%"},class:"request-detail"},{default:t(()=>[e(q,{label:"header",name:"requestHeader"},{default:t(()=>[e(Se,{"self-data":d.value.request.headers,"onUpdate:selfData":m[2]||(m[2]=x=>d.value.request.headers=x),include:d.value.include,"onUpdate:include":m[3]||(m[3]=x=>d.value.include=x),"show-include":!0},null,8,["self-data","include"])]),_:1}),e(q,{label:"json",name:"requestJson"},{default:t(()=>[e(ie,{content:d.value.request.json,"onUpdate:content":m[4]||(m[4]=x=>d.value.request.json=x),"can-set":"true",height:n.editHeight},null,8,["content","height"])]),_:1}),e(q,{label:"data",name:"requestData"},{default:t(()=>[e(_e,{modelValue:d.value.request.data,"onUpdate:modelValue":m[5]||(m[5]=x=>d.value.request.data=x)},null,8,["modelValue"])]),_:1}),e(q,{label:"param",name:"requestParam"},{default:t(()=>[e(_e,{modelValue:d.value.request.params,"onUpdate:modelValue":m[6]||(m[6]=x=>d.value.request.params=x)},null,8,["modelValue"])]),_:1})]),_:1},8,["modelValue"])]),right:t(()=>[e(Le,{"active-tab":a(g),"onUpdate:activeTab":m[8]||(m[8]=x=>W(g)?g.value=x:null),"step-detail-data":d.value,"onUpdate:stepDetailData":m[9]||(m[9]=x=>d.value=x),"edit-height":n.editHeight},null,8,["active-tab","step-detail-data","edit-height"])]),_:1})]),_:1})],64)}}},Vt=be(wt,[["__scopeId","data-v-5db133cf"]]),Dt={class:"el-dropdown-link"},kt={style:{width:"100%"}},xt={__name:"step-websocket",props:Q({editHeight:{default:"calc(100vh-160px)"}},{stepDetailData:{required:!0},stepDetailDataModifiers:{}}),emits:["update:stepDetailData"],setup(n){const{proxy:c}=ge();c.useDict("sys_normal_disable"),c.useDict("hrm_data_type"),c.useDict("sys_request_method");const o=A(n,"stepDetailData"),d=k("requestHeader"),l=k("response");return(g,i)=>{const m=s("arrow-down"),v=s("el-icon"),b=s("el-dropdown-item"),r=s("el-dropdown-menu"),R=s("el-dropdown"),h=s("el-input"),M=s("el-col"),$=s("el-row"),j=s("el-tab-pane"),q=s("el-tabs");return y(),O(B,null,[e($,{gutter:10,type:"flex",class:"row-bg"},{default:t(()=>[e(M,{span:24},{default:t(()=>[J("div",null,[e(h,{modelValue:o.value.request.url,"onUpdate:modelValue":i[0]||(i[0]=u=>o.value.request.url=u),placeholder:"Please input"},{prepend:t(()=>[V("URL")]),append:t(()=>[e(R,null,{dropdown:t(()=>[e(r,null,{default:t(()=>[e(b,{disabled:""},{default:t(()=>[V("111")]),_:1}),e(b,{disabled:""},{default:t(()=>[V("222")]),_:1})]),_:1})]),default:t(()=>[J("span",Dt,[e(v,{class:"el-icon--right"},{default:t(()=>[e(m)]),_:1})])]),_:1})]),_:1},8,["modelValue"])])]),_:1})]),_:1}),e($,{type:"flex",class:"row-bg",justify:"start",style:{"flex-grow":"1"}},{default:t(()=>[e(q,{modelValue:a(d),"onUpdate:modelValue":i[6]||(i[6]=u=>W(d)?d.value=u:null),style:{width:"100%"}},{default:t(()=>[e(Je,{"left-width":"50%"},{left:t(()=>[e(j,{label:"header",name:"requestHeader"},{default:t(()=>[V("header "),e(Se,{"self-data":o.value.request.headers,"onUpdate:selfData":i[1]||(i[1]=u=>o.value.request.headers=u),include:o.value.include,"onUpdate:include":i[2]||(i[2]=u=>o.value.include=u)},null,8,["self-data","include"])]),_:1}),e(j,{label:"data",name:"requestJson"},{default:t(()=>[J("div",kt,[e(ie,{content:o.value.request.data,"onUpdate:content":i[3]||(i[3]=u=>o.value.request.data=u),"can-set":"true",height:"calc(100vh - 323px)"},null,8,["content"])])]),_:1})]),right:t(()=>[e(Le,{"active-tab":a(l),"onUpdate:activeTab":i[4]||(i[4]=u=>W(l)?l.value=u:null),"step-detail-data":o.value,"onUpdate:stepDetailData":i[5]||(i[5]=u=>o.value=u),"edit-height":n.editHeight},null,8,["active-tab","step-detail-data","edit-height"])]),_:1})]),_:1},8,["modelValue"])]),_:1})],64)}}},It=be(xt,[["__scopeId","data-v-b61f2bb4"]]);function Ue(n){if(!n){Re.alert("参数错误","错误提示",{type:"error"});return}if(n!==Z.http&&n!==Z.websocket){Re.alert("不支持的测试步骤类型","错误提示",{type:"error"});return}let c=ce;if(n===Z.http)c=JSON.parse(JSON.stringify(ce));else if(n===Z.websocket){let o=JSON.parse(JSON.stringify(ce));o.request=dt,c=o}else return{};return c.step_id=ze(10),c.step_type=n,c}function Xt(n){let c=Ee;return c=JSON.parse(JSON.stringify(Ee)),c.requestInfo.teststeps[0]=Ue(n),c.type=X.api,c.apiType=n,c}const Ct={__name:"table-extract",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(n){const c=A(n,"modelValue"),o=[{name:"key",prop:"key",width:300},{name:"value",prop:"value",width:300},{name:"desc",prop:"desc",width:""}];return(d,l)=>(y(),U(he,{cols:o,modelValue:c.value,"onUpdate:modelValue":l[0]||(l[0]=g=>c.value=g)},null,8,["modelValue"]))}},Ut={__name:"request-type-dropdown",props:["indexKey"],emits:["typeSelected"],setup(n){return(c,o)=>{const d=s("CirclePlus"),l=s("el-icon"),g=s("el-button"),i=s("el-dropdown-item"),m=s("el-dropdown-menu"),v=s("el-dropdown");return y(),U(v,{trigger:"click"},{default:t(()=>[De(c.$slots,"default",{},()=>[e(l,{size:15,color:"green"},{default:t(()=>[e(d)]),_:1})])]),dropdown:t(()=>[e(m,null,{default:t(()=>[e(i,null,{default:t(()=>[e(g,{size:"small",type:"primary",onClick:o[0]||(o[0]=xe(b=>c.$emit("typeSelected",n.indexKey,a(Z).http,a(Ue)(a(Z).http)),["stop"]))},{default:t(()=>[V(" request ")]),_:1})]),_:1}),e(i,null,{default:t(()=>[e(g,{size:"small",type:"warning",onClick:o[1]||(o[1]=xe(b=>c.$emit("typeSelected",n.indexKey,a(Z).websocket,a(Ue)(a(Z).websocket)),["stop"]))},{default:t(()=>[V(" websocket ")]),_:1})]),_:1}),e(i,{disabled:""},{default:t(()=>[e(g,{size:"small",type:"info",disabled:""},{default:t(()=>[V("webUI")]),_:1})]),_:1}),e(i,{disabled:""},{default:t(()=>[e(g,{size:"small",type:"info",disabled:""},{default:t(()=>[V("import API")]),_:1})]),_:1}),e(i,{disabled:""},{default:t(()=>[e(g,{size:"small",type:"info",disabled:""},{default:t(()=>[V("import CASE")]),_:1})]),_:1})]),_:1})]),_:3})}}},qt={class:"custom-tabs-label"},St={__name:"edite-label",props:Q(["indexKey","type"],{modelValue:{},modelModifiers:{}}),emits:Q(["editElement"],["update:modelValue"]),setup(n,{emit:c}){const o=A(n,"modelValue"),d=c,l=k(!1);function g(i,m,v){d("editElement","add",i,m,v)}return(i,m)=>{const v=s("el-button"),b=s("el-input"),r=s("el-icon"),R=s("Select"),h=s("el-space");return y(),O("span",qt,[e(h,{wrap:"",size:3},{default:t(()=>[n.type===a(Z).http?(y(),U(v,{key:0,type:"success",link:""},{default:t(()=>[V("RQ")]),_:1})):n.type===a(Z).websocket?(y(),U(v,{key:1,type:"primary",link:""},{default:t(()=>[V("WS")]),_:1})):G("",!0),F(J("span",null,oe(o.value),513),[[ae,!a(l)]]),F(e(b,{style:{width:"80px"},modelValue:o.value,"onUpdate:modelValue":m[0]||(m[0]=M=>o.value=M)},null,8,["modelValue"]),[[ae,a(l)]]),F(e(r,{size:15,color:"blue",onClick:m[1]||(m[1]=()=>{l.value=!0})},{default:t(()=>[e(a(Xe))]),_:1},512),[[ae,!a(l)]]),F(e(r,{size:15,onClick:m[2]||(m[2]=()=>{l.value=!1})},{default:t(()=>[e(R)]),_:1},512),[[ae,a(l)]]),e(Ut,{"index-key":n.indexKey,onTypeSelected:g},null,8,["index-key"]),e(r,{size:15,color:"red",onClick:m[3]||(m[3]=xe(M=>i.$emit("editElement","remove",n.indexKey),["stop"]))},{default:t(()=>[e(a(Qe))]),_:1})]),_:1})])}}},ye={__name:"table-hooks",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(n){const c=A(n,"modelValue"),o=[{name:"key",prop:"key",width:300},{name:"desc",prop:"desc",width:""}];return(d,l)=>(y(),U(he,{cols:o,modelValue:c.value,"onUpdate:modelValue":l[0]||(l[0]=g=>c.value=g)},null,8,["modelValue"]))}},Rt={__name:"table-validate",props:Q(["data"],{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const c=A(n,"modelValue"),o=[{name:"check",prop:"check",width:300},{name:"Comparator",prop:"assert",type:"compaList",width:100},{name:"Type",prop:"type",width:115,type:"select"},{name:"Expected",prop:"expect",width:""},{name:"msg",prop:"msg",width:""}];return(d,l)=>(y(),U(he,{cols:o,modelValue:c.value,"onUpdate:modelValue":l[0]||(l[0]=g=>c.value=g)},null,8,["modelValue"]))}},Tt={__name:"step",props:{testStepsData:{required:!0},testStepsDataModifiers:{}},emits:["update:testStepsData"],setup(n){const c=k("stepRequest"),o=k(0),d=A(n,"testStepsData");function l(g,i,m,v){if(g==="remove"){const b=o.value,r=i!==void 0?i:o.value;if(d.value.splice(r,1),d.value.length<=0){let R=JSON.parse(JSON.stringify(ce));R.step_id=ze(10),d.value.push(R),o.value=0;return}if(b>=r){if(b===0){o.value=0;return}o.value=b-1}}else if(g==="add"){let b=i!==void 0?i+1:o.value+1;d.value.splice(b,0,v),o.value=b}else console.log("other")}return(g,i)=>{const m=s("el-tab-pane"),v=s("el-input"),b=s("el-tabs");return y(),U(b,{"tab-position":"left",class:"demo-tabs",modelValue:a(o),"onUpdate:modelValue":i[1]||(i[1]=r=>W(o)?o.value=r:null),style:{height:"100%"}},{default:t(()=>[(y(!0),O(B,null,te(d.value,(r,R)=>(y(),U(m,{key:r.step_id,name:R},{label:t(()=>[e(St,{modelValue:r.name,"onUpdate:modelValue":h=>r.name=h,"index-key":R,type:r.step_type,onEditElement:l},null,8,["modelValue","onUpdate:modelValue","index-key","type"])]),default:t(()=>[e(b,{type:"",modelValue:a(c),"onUpdate:modelValue":i[0]||(i[0]=h=>W(c)?c.value=h:null)},{default:t(()=>[e(m,{label:"request",name:"stepRequest"},{default:t(()=>[r.step_type===a(Z).http?(y(),U(Vt,{key:0,"step-detail-data":d.value[R],"onUpdate:stepDetailData":h=>d.value[R]=h,"edit-height":"calc(100vh - 420px)"},null,8,["step-detail-data","onUpdate:stepDetailData"])):G("",!0),r.step_type===a(Z).websocket?(y(),U(It,{key:1,"step-detail-data":d.value[R],"onUpdate:stepDetailData":h=>d.value[R]=h,"edit-height":"calc(100vh - 473px)"},null,8,["step-detail-data","onUpdate:stepDetailData"])):G("",!0)]),_:2},1024),e(m,{label:"extract/validate",name:"stepEv"},{default:t(()=>[V(" extract "),e(Ct,{modelValue:r.extract,"onUpdate:modelValue":h=>r.extract=h},null,8,["modelValue","onUpdate:modelValue"]),V(" validate "),e(Rt,{modelValue:r.validate,"onUpdate:modelValue":h=>r.validate=h},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(m,{label:"variables/hooks",name:"stepVh"},{default:t(()=>[V(" variables "),e(_e,{modelValue:r.variables,"onUpdate:modelValue":h=>r.variables=h},null,8,["modelValue","onUpdate:modelValue"]),V(" setup_hooks "),e(ye,{modelValue:r.setup_hooks,"onUpdate:modelValue":h=>r.setup_hooks=h},null,8,["modelValue","onUpdate:modelValue"]),V(" teardown_hooks "),e(ye,{modelValue:r.teardown_hooks,"onUpdate:modelValue":h=>r.teardown_hooks=h},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(m,{label:"thinktime",name:"stepThinktime"},{default:t(()=>[J("div",null,[e(v,{modelValue:r.think_time.limit,"onUpdate:modelValue":h=>r.think_time.limit=h,style:{"max-width":"600px"},placeholder:"Please input"},{prepend:t(()=>[V("thinktime")]),_:2},1032,["modelValue","onUpdate:modelValue"])])]),_:2},1024)]),_:2},1032,["modelValue"])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])}}},Nt=J("span",{style:{"flex-grow":"1"}},null,-1),$t={class:"dialog-footer"},Et={__name:"edite-table",props:Q({tableTitle:{type:String,default:"表格"}},{columnsRef:{},columnsRefModifiers:{},tableDatasRef:{},tableDatasRefModifiers:{}}),emits:Q(["submit"],["update:columnsRef","update:tableDatasRef"]),setup(n,{emit:c}){const o={switch:1,input:2,select:3},d=A(n,"columnsRef"),l=A(n,"tableDatasRef"),g=[{title:"编辑",menuType:H.editCell,icon:"Menu",divided:!0},{title:"删除行",menuType:H.DeleteRow,icon:"Menu",divided:!0},{title:"向上新增一行",menuType:H.InsertRowBefore,icon:"Menu"},{title:"向下新增一行",menuType:H.InsertRowAfter,icon:"Menu",divided:!0},{title:"删除列",menuType:H.DeleteColumn,icon:"Menu",divided:!0},{title:"向前新增一列",menuType:H.InsertColumnBefore,icon:"Menu",divided:!0},{title:"向后新增一列",menuType:H.InsertColumnAfter,icon:"Menu",divided:!0}],i=[{title:"编辑",menuType:H.editHeader,icon:"Menu",divided:!0},{title:"隐藏",menuType:H.HideColumn,icon:"Menu",divided:!0},{title:"删除列",menuType:H.DeleteColumn,icon:"Menu",divided:!0},{title:"向前新增一列",menuType:H.InsertColumnBefore,icon:"Menu",divided:!0},{title:"向后新增一列",menuType:H.InsertColumnAfter,icon:"Menu",divided:!0}],m={label:"启用",prop:"__enable",show:!0,enable:!0,type:o.switch},v=k({row:null,column:null,cell:null,e:null}),b=Te({show:!1,x:0,y:0,data:g,onSelect:_=>{I(_.menuType)}}),r=Te({row:1,column:1}),R=k(!1),h=k({desc:null,key:null,oldKey:null}),M=k([]);function $(_,p,w,D){_[p.rawColumnKey].edit=!0;const T=w.querySelector("textarea");T&&He(()=>{T.focus()})}function j(_,p){const w=_,D=d.value.findIndex(K=>K.prop===w.columnKey);if(!D)return;const T=d.value[D];h.value.desc=T.label,h.value.key=T.prop,h.value.oldKey=T.prop,R.value=!0}function q(_,p){v.value.column=_,v.value.e=p,b.data=i,b.x=p.clientX,b.y=p.clientY,b.show=!0,p.preventDefault()}function u(_,p,w){}function x(_,p,w,D){v.value.row=_,v.value.column=p,v.value.cell=w,v.value.e=D,b.data=g,b.x=D.clientX,b.y=D.clientY,b.show=!0,D.preventDefault()}function I(_){if(_===H.InsertRowBefore||_===H.InsertRowAfter){const p=v.value.row;let w=l.value.indexOf(p);N(void 0,1,_,w)}else if(_===H.editHeader){const p=v.value.column,w=d.value.findIndex(T=>T.prop===p.columnKey);if(!w)return;const D=d.value[w];h.value.desc=D.label,h.value.key=D.prop,h.value.oldKey=D.prop,R.value=!0}else if(_===H.InsertColumnBefore||_===H.InsertColumnAfter){const p=v.value.column,w=d.value.findIndex(D=>D.prop===p.columnKey);N(1,void 0,_,w)}else if(_===H.DeleteRow){const p=v.value.row;let w=l.value.indexOf(p);l.value.splice(w,1)}else if(_===H.HideColumn){const p=v.value.column,w=d.value.findIndex(D=>D.prop===p.columnKey);d.value[w].show=!d.value[w].show}else if(_===H.DeleteColumn){const p=v.value.column,w=d.value.findIndex(D=>D.prop===p.columnKey);d.value.splice(w,1)}}function N(_,p,w,D){const T=p,K=_;if(K){if(d.value.length<=0){let z=JSON.parse(JSON.stringify(m));z.width="70px",d.value.push(z)}for(let z=0;z<K;z++){let f=JSON.parse(JSON.stringify(m)),L=d.value.length;f.label="新增列"+L,f.prop="new"+L,f.show=!0,f.type=o.input;let Y=D||d.value.length-1;d.value.splice(w===H.InsertColumnBefore?Y:Y+1,0,f),l.value.forEach(se=>{se[f.prop]=JSON.parse(JSON.stringify({content:"",edit:!1}))})}}if(T)for(let z=0;z<T;z++){let f={};for(let Y of d.value)Y.prop==="__enable"?f[Y.prop]={content:!0,edit:!1}:f[Y.prop]={content:"",edit:!1};let L=D||l.value.length-1;l.value.splice(w===H.InsertRowBefore?L:L+1,0,f)}}function P(){const _=r.row,p=r.column;N(p,_)}function le(){const _=h.value.oldKey,p=h.value.key,w=h.value.desc;l.value=l.value.map(D=>{const{[_]:T,...K}=D;return{[p]:T,...K}}),console.log(l.value),d.value.forEach(D=>{D.prop===_&&(D.prop=p,D.label=w)}),R.value=!1}function ee(_){let p=[];_.forEach(w=>{const D=l.value.indexOf(w);p.push(D)}),p.sort((w,D)=>D-w),M.value=p}function ne(_){M.value.forEach(p=>{l.value.splice(p,1)})}function E(_){M.value.forEach(p=>{let w=ue.parse(JSON.stringify(Ye(je(l.value[p]))));l.value.splice(p+1,0,w)})}return(_,p)=>{const w=s("el-button"),D=s("el-text"),T=s("el-input-number"),K=s("el-row"),z=s("el-popover"),f=s("el-table-column"),L=s("el-switch"),Y=s("el-input"),se=s("el-table"),de=s("el-dialog");return y(),O(B,null,[e(K,{style:{"padding-bottom":"5px"}},{default:t(()=>[e(z,{placement:"right",width:400,trigger:"click"},{reference:t(()=>[e(w,{style:{"margin-right":"16px"}},{default:t(()=>[V("新增数据")]),_:1})]),default:t(()=>[e(K,null,{default:t(()=>[e(D,null,{default:t(()=>[V("行数：")]),_:1}),e(T,{modelValue:a(r).row,"onUpdate:modelValue":p[0]||(p[0]=S=>a(r).row=S),min:0},null,8,["modelValue"])]),_:1}),e(K,{style:{"margin-top":"16px"}},{default:t(()=>[e(D,null,{default:t(()=>[V("列数：")]),_:1}),e(T,{modelValue:a(r).column,"onUpdate:modelValue":p[1]||(p[1]=S=>a(r).column=S),min:0},null,8,["modelValue"])]),_:1}),e(K,null,{default:t(()=>[e(w,{type:"primary",onClick:P},{default:t(()=>[V("确定")]),_:1})]),_:1})]),_:1}),e(w,{onClick:p[2]||(p[2]=S=>{N(1)}),type:"success"},{default:t(()=>[V("新增列")]),_:1}),e(w,{onClick:p[3]||(p[3]=S=>{N(void 0,1)}),type:"info"},{default:t(()=>[V("新增行")]),_:1}),e(w,{onClick:E,type:"warning"},{default:t(()=>[V("复制选中行")]),_:1}),e(w,{onClick:ne,type:"danger"},{default:t(()=>[V("删除选中行")]),_:1}),Nt,e(w,{type:"primary",onClick:p[4]||(p[4]=S=>_.$emit("submit",d.value,l.value))},{default:t(()=>[V("保存")]),_:1})]),_:1}),e(se,{data:l.value,"onUpdate:data":p[5]||(p[5]=S=>l.value=S),border:"",style:{width:"100%"},onCellDblclick:$,onHeaderContextmenu:q,onRowContextmenu:u,onCellContextmenu:x,onSelectionChange:ee,"max-height":"calc(100vh - 172px)"},{default:t(()=>[e(f,{type:"selection"}),(y(!0),O(B,null,te(d.value,S=>(y(),O(B,null,[S.show?(y(),U(f,{key:S.prop,"column-key":S.prop,width:S.width},{header:t(({column:C,$index:re})=>[e(D,{onDblclick:Be=>j(C,re)},{default:t(()=>[V(oe(S.label)+"["+oe(S.prop)+"]",1)]),_:2},1032,["onDblclick"])]),default:t(({row:C,column:re,$index:Be})=>[S.type===o.switch?(y(),U(L,{key:0,modelValue:C[S.prop].content,"onUpdate:modelValue":pe=>C[S.prop].content=pe},null,8,["modelValue","onUpdate:modelValue"])):(y(),O(B,{key:1},[F(J("p",{style:{width:"100%","white-space":"nowrap"}},oe(C[S.prop].content),513),[[ae,!C[S.prop].edit]]),F(e(Y,{type:"textarea",size:"small",modelValue:C[S.prop].content,"onUpdate:modelValue":pe=>C[S.prop].content=pe,onBlur:pe=>C[S.prop].edit=!1,autofocus:!0,style:{"flex-grow":"1"}},null,8,["modelValue","onUpdate:modelValue","onBlur"]),[[ae,C[S.prop].edit]])],64))]),_:2},1032,["column-key","width"])):G("",!0)],64))),256))]),_:1},8,["data"]),e(yt,{visible:a(b).show,"onUpdate:visible":p[6]||(p[6]=S=>a(b).show=S),x:a(b).x,y:a(b).y,onSelect:a(b).onSelect,menus:a(b).data},null,8,["visible","x","y","onSelect","menus"]),e(de,{modelValue:a(R),"onUpdate:modelValue":p[11]||(p[11]=S=>W(R)?R.value=S:null),title:"修改列信息",width:"500"},{footer:t(()=>[J("div",$t,[e(w,{onClick:p[10]||(p[10]=S=>R.value=!1)},{default:t(()=>[V("取消")]),_:1}),e(w,{type:"primary",onClick:le},{default:t(()=>[V(" 确认 ")]),_:1})])]),default:t(()=>[e(K,null,{default:t(()=>[e(D,null,{default:t(()=>[V("描述：")]),_:1}),e(Y,{modelValue:a(h).desc,"onUpdate:modelValue":p[7]||(p[7]=S=>a(h).desc=S)},null,8,["modelValue"])]),_:1}),e(K,null,{default:t(()=>[e(D,null,{default:t(()=>[V("oldKey：")]),_:1}),e(Y,{modelValue:a(h).key,"onUpdate:modelValue":p[8]||(p[8]=S=>a(h).key=S)},null,8,["modelValue"])]),_:1}),F(e(K,null,{default:t(()=>[e(D,null,{default:t(()=>[V("newKey：")]),_:1}),e(Y,{modelValue:a(h).oldKey,"onUpdate:modelValue":p[9]||(p[9]=S=>a(h).oldKey=S)},null,8,["modelValue"])]),_:1},512),[[ae,!1]])]),_:1},8,["modelValue"])],64)}}},Me={__name:"case-config",props:Q({projectOptions:{type:Object,default:()=>[]},dataName:{type:String,default:"用例"},dataType:{type:Number,default:X.case}},{formData:{required:!0},formDataModifiers:{}}),emits:["update:formData"],setup(n){const c=ke("sys_normal_disable"),o=n,d=k([]),l=A(n,"formData"),g=k("caseMessages"),i=k([]),m=ke("hrm_comparator_dict"),v=k(!1),b=k({tableHeaders:[],tableDatas:[]});function r(){rt(l.value).then(q=>{i.value=q.data})}function R(){if(o.dataType===X.case){let q={projectId:l.value.projectId,moduleId:l.value.moduleId,type:X.config};We(q).then(u=>{d.value=u.rows})}}function h(){l.value.moduleId=void 0,l.value.request.config.include.configId=null,r();let q="";l.value&&l.value.projectId&&(q=l.value.projectId),Pe({projectId:q}).then(u=>{m.value=u.data})}function M(){l.value.request.config.include.configId=null,R()}function $(){let q=l.value.request.config.parameters.value,u=q?ue.parse(fe(q)):{};b.value.tableHeaders=u.tableHeaders||[],b.value.tableDatas=u.tableDatas||[],v.value=!0}function j(q,u){let x={tableHeaders:b.value.tableHeaders,tableDatas:b.value.tableDatas};l.value.request.config.parameters.value=it(JSON.stringify(x)),v.value=!1}return qe(()=>{r(),R()}),(q,u)=>{const x=s("el-input"),I=s("el-form-item"),N=s("el-option"),P=s("el-select"),le=s("el-input-number"),ee=s("el-radio"),ne=s("el-radio-group"),E=s("el-tab-pane"),_=s("el-button"),p=s("el-row"),w=s("el-text"),D=s("el-tabs"),T=s("el-main"),K=s("el-container"),z=s("el-dialog");return y(),O(B,null,[e(D,{type:"",modelValue:a(g),"onUpdate:modelValue":u[14]||(u[14]=f=>W(g)?g.value=f:null)},{default:t(()=>[e(E,{label:"messages",name:"caseMessages"},{default:t(()=>[e(I,{label:n.dataName+"名称",prop:"caseName"},{default:t(()=>[e(x,{modelValue:l.value.caseName,"onUpdate:modelValue":u[0]||(u[0]=f=>l.value.caseName=f),placeholder:"请输入用例名称",clearable:""},null,8,["modelValue"])]),_:1},8,["label"]),e(I,{label:"所属项目",prop:"projectId"},{default:t(()=>[e(P,{modelValue:l.value.projectId,"onUpdate:modelValue":u[1]||(u[1]=f=>l.value.projectId=f),placeholder:"请选择",onChange:h},{default:t(()=>[(y(!0),O(B,null,te(n.projectOptions,f=>(y(),U(N,{key:f.projectId,label:f.projectName,value:f.projectId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(I,{label:"所属模块",prop:"moduleId"},{default:t(()=>[e(P,{modelValue:l.value.moduleId,"onUpdate:modelValue":u[2]||(u[2]=f=>l.value.moduleId=f),placeholder:"请选择",onChange:M},{default:t(()=>[(y(!0),O(B,null,te(a(i),f=>(y(),U(N,{key:f.moduleId,label:f.moduleName,value:f.moduleId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),n.dataType===a(X).case?(y(),U(I,{key:0,label:"可选配置"},{default:t(()=>[e(P,{modelValue:l.value.request.config.include.config.id,"onUpdate:modelValue":u[3]||(u[3]=f=>l.value.request.config.include.config.id=f),placeholder:"请选择",clearable:""},{default:t(()=>[(y(!0),O(B,null,te(a(d),f=>(y(),U(N,{key:f.caseId,label:f.caseName,value:f.caseId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):G("",!0),e(I,{label:"注释",prop:"notes"},{default:t(()=>[e(x,{modelValue:l.value.notes,"onUpdate:modelValue":u[4]||(u[4]=f=>l.value.notes=f),placeholder:"注释"},null,8,["modelValue"])]),_:1}),e(I,{label:"用例顺序",prop:"sort"},{default:t(()=>[e(le,{modelValue:l.value.sort,"onUpdate:modelValue":u[5]||(u[5]=f=>l.value.sort=f),"controls-position":"right",min:0},null,8,["modelValue"])]),_:1}),e(I,{label:"用例状态",prop:"status"},{default:t(()=>[e(ne,{modelValue:l.value.status,"onUpdate:modelValue":u[6]||(u[6]=f=>l.value.status=f)},{default:t(()=>[(y(!0),O(B,null,te(a(c),f=>(y(),U(ee,{key:f.value,label:f.label,value:f.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(I,{label:"备注",prop:"remark"},{default:t(()=>[e(x,{modelValue:l.value.remark,"onUpdate:modelValue":u[7]||(u[7]=f=>l.value.remark=f),type:"textarea",placeholder:"请输入内容"},null,8,["modelValue"])]),_:1})]),_:1}),e(E,{label:"headers",name:"caseHeaders"},{default:t(()=>[e(Se,{modelValue:l.value.request.config.headers,"onUpdate:modelValue":u[8]||(u[8]=f=>l.value.request.config.headers=f)},null,8,["modelValue"])]),_:1}),e(E,{label:"variables/parameters/hooks",name:"caseVph"},{default:t(()=>[V(" variables "),e(_e,{modelValue:l.value.request.config.variables,"onUpdate:modelValue":u[9]||(u[9]=f=>l.value.request.config.variables=f)},null,8,["modelValue"]),V(" parameters "),e(p,null,{default:t(()=>[e(P,{placeholder:"请选择",style:{width:"120px"},modelValue:l.value.request.config.parameters.type,"onUpdate:modelValue":u[10]||(u[10]=f=>l.value.request.config.parameters.type=f)},{default:t(()=>[(y(),U(N,{value:3,key:3,label:"本地表格"})),(y(),U(N,{value:4,key:4,label:"本地数据",disabled:""})),(y(),U(N,{value:1,key:1,label:"文件",disabled:""})),(y(),U(N,{value:2,key:2,label:"数据库",disabled:""}))]),_:1},8,["modelValue"]),e(_,{onClick:$,style:{"padding-left":"5px"}},{default:t(()=>[V("设置")]),_:1})]),_:1}),e(p,{style:{"padding-bottom":"10px"}},{default:t(()=>[l.value.request.config.parameters?(y(),U(w,{key:0},{default:t(()=>[V("点击设置数据")]),_:1})):(y(),U(w,{key:1},{default:t(()=>[V("暂无数据")]),_:1}))]),_:1}),V(" setup_hooks "),e(ye,{modelValue:l.value.request.config.setup_hooks,"onUpdate:modelValue":u[11]||(u[11]=f=>l.value.request.config.setup_hooks=f)},null,8,["modelValue"]),V(" teardown_hooks "),e(ye,{modelValue:l.value.request.config.teardown_hooks,"onUpdate:modelValue":u[12]||(u[12]=f=>l.value.request.config.teardown_hooks=f)},null,8,["modelValue"])]),_:1}),e(E,{label:"thinktime",name:"caseThinktime"},{default:t(()=>[J("div",null,[e(x,{modelValue:l.value.request.config.think_time.limit,"onUpdate:modelValue":u[13]||(u[13]=f=>l.value.request.config.think_time.limit=f),style:{"max-width":"600px"},placeholder:"Please input"},{prepend:t(()=>[V("thinktime")]),_:1},8,["modelValue"])])]),_:1})]),_:1},8,["modelValue"]),e(z,{fullscreen:"",title:"参数化配置【"+l.value.caseName+"】",modelValue:a(v),"onUpdate:modelValue":u[17]||(u[17]=f=>W(v)?v.value=f:null),"append-to-body":"","destroy-on-close":""},{default:t(()=>[e(K,{style:{height:"100%"}},{default:t(()=>[e(T,{style:{"max-height":"calc(100vh - 95px)"}},{default:t(()=>[e(Et,{"columns-ref":a(b).tableHeaders,"onUpdate:columnsRef":u[15]||(u[15]=f=>a(b).tableHeaders=f),"table-datas-ref":a(b).tableDatas,"onUpdate:tableDatasRef":u[16]||(u[16]=f=>a(b).tableDatas=f),onSubmit:j},null,8,["columns-ref","table-datas-ref"])]),_:1})]),_:1})]),_:1},8,["title","modelValue"])],64)}}},Mt={__name:"case-edit-dialog",props:Q({dataType:{type:Number,default:X.case},formRules:{type:Object,default:{}},formDatas:{type:Object,default:Ke},openCaseEditDialog:{type:Boolean,default:!1},title:{type:String,default:"编辑页面"}},{openCaseEditDialog:{},openCaseEditDialogModifiers:{}}),emits:["update:openCaseEditDialog"],setup(n){const{proxy:c}=ge(),o=n,d=A(n,"openCaseEditDialog"),l=Ge(o.formDatas),g=k(""),i=k([]),m=k("caseConfig");k("");const v=k({}),b=k([]),r=k({save:!1,debug:!1}),R=me(()=>o.dataType===X.case?"用例":"配置");Ie("hrm_comparator_dict",v),Ie("hrm_case_config_list",b),ve(()=>o.formDatas,()=>{l.value=o.formDatas,m.value="caseConfig",q()});function h(){c.$refs.postRef.validate(x=>{if(x){r.value.save=!0;const I=l.value;I.request.config.name=I.caseName,I.request.config.result={},I.type=o.dataType;for(let N of I.request.teststeps)N.result={};I.caseId!==void 0?nt(I).then(N=>{c.$modal.msgSuccess("修改成功"),d.value=!1}).finally(()=>{r.value.save=!1}):ot(I).then(N=>{c.$modal.msgSuccess("新增成功"),d.value=!1}).finally(()=>{r.value.save=!1})}})}function M(){c.$refs.postRef.validate(x=>{if(x){r.value.debug=!0;const I=l.value;I.request.config.name=I.caseName,I.request.config.result=null;for(let P=0;P<I.request.teststeps.length;P++)I.request.teststeps[P].result=null;const N={env:g.value,runType:at.case_debug,caseData:I};ut(N).then(P=>{c.$modal.msgSuccess(P.msg);for(const le in P.data)l.value.request.teststeps.find(ee=>ee.step_id===le).result=P.data[le]}).finally(()=>{r.value.debug=!1})}})}function $(){Oe(null).then(x=>{i.value=x.data})}function j(){m.value="caseConfig",c.resetForm("postRef")}function q(){let x="";l.value&&l.value.caseId&&(x=l.value.caseId),Pe({caseId:x}).then(I=>{v.value=I.data})}function u(){if(o.dataType===X.case){let x={projectId:l.value.projectId,moduleId:l.value.moduleId,type:X.config};We(x).then(I=>{b.value=I.rows})}}return qe(()=>{j(),$(),u()}),(x,I)=>{const N=s("el-button"),P=s("el-button-group"),le=s("el-header"),ee=s("el-tab-pane"),ne=s("el-main"),E=s("el-container"),_=s("el-tabs"),p=s("el-form"),w=s("el-dialog"),D=Ce("hasPermi");return y(),U(w,{fullscreen:"",title:n.title,modelValue:d.value,"onUpdate:modelValue":I[5]||(I[5]=T=>d.value=T),"append-to-body":"","destroy-on-close":""},{default:t(()=>[e(p,{ref:"postRef",model:a(l),rules:n.formRules,"label-width":"100px",style:{height:"100%"}},{default:t(()=>[e(E,{style:{height:"100%","overflow-y":"hidden"}},{default:t(()=>[e(le,{height:"20px",border:"2px",style:{"border-bottom-color":"#97a8be","text-align":"right"}},{default:t(()=>[e(P,null,{default:t(()=>[n.dataType!==a(X).run_detail?F((y(),U(N,{key:0,type:"primary",onClick:h,loading:a(r).save},{default:t(()=>[V("保存 ")]),_:1},8,["loading"])),[[D,["hrm:case:edit"]]]):G("",!0),n.dataType!==a(X).config?F((y(),U(N,{key:1,type:"primary",onClick:M,loading:a(r).debug},{default:t(()=>[V("调试 ")]),_:1},8,["loading"])),[[D,["hrm:case:debug"]]]):G("",!0),n.dataType!==a(X).config?(y(),U(bt,{key:2,"selected-env":a(g),"onUpdate:selectedEnv":I[0]||(I[0]=T=>W(g)?g.value=T:null)},null,8,["selected-env"])):G("",!0)]),_:1})]),_:1}),e(ne,{style:{"max-height":"calc(100vh - 95px)"}},{default:t(()=>[n.dataType===a(X).config?(y(),U(Me,{key:0,"form-data":a(l),"onUpdate:formData":I[1]||(I[1]=T=>W(l)?l.value=T:null),"project-options":a(i),"data-type":n.dataType,"data-name":a(R)},null,8,["form-data","project-options","data-type","data-name"])):n.dataType!==a(X).config?(y(),U(_,{key:1,type:"border-card",modelValue:a(m),"onUpdate:modelValue":I[4]||(I[4]=T=>W(m)?m.value=T:null),style:{height:"100%"}},{default:t(()=>[e(ee,{label:"config",name:"caseConfig"},{default:t(()=>[e(Me,{"form-data":a(l),"onUpdate:formData":I[2]||(I[2]=T=>W(l)?l.value=T:null),"project-options":a(i),"data-type":n.dataType},null,8,["form-data","project-options","data-type"])]),_:1}),e(ee,{label:"teststeps",name:"caseSteps"},{default:t(()=>[e(E,{style:{"max-height":"calc(100vh - 207px)"}},{default:t(()=>[e(ne,null,{default:t(()=>[e(Tt,{"test-steps-data":a(l).request.teststeps,"onUpdate:testStepsData":I[3]||(I[3]=T=>a(l).request.teststeps=T)},null,8,["test-steps-data"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])):G("",!0)]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])}}},jt={class:"app-container"},Ht=Ze({name:"RunDetail"}),Qt=Object.assign(Ht,{props:["runId","viewType","reportId"],setup(n){const{proxy:c}=ge();c.useDict("sys_normal_disable");const{hrm_run_status:o}=c.useDict("hrm_run_status"),{hrm_run_way:d}=c.useDict("hrm_run_way");c.useDict("sys_request_method");const{hrm_data_type:l}=c.useDict("hrm_data_type"),g=n;Ie("hrm_data_type",l);const i=k([]),m=k([]);k(!1);const v=k(!0),b=k(!0),r=k([]),R=k(!0),h=k(!0),M=k(0),$=k(!0),j=k(!1),q=k(JSON.parse(JSON.stringify(Ke))),u=k({pageNum:1,pageSize:10,runId:g.runId,reportId:g.reportId,runName:void 0,projectId:void 0,moduleId:void 0,status:void 0,onlySelf:$,runType:null});ve(()=>g.runId,()=>{u.value.runId=g.runId,N()}),ve(()=>g.reportId,()=>{u.value.reportId=g.reportId,N()});function x(){v.value=!0,u.value.runId=g.runId,u.value.reportId=g.reportId,et(u.value).then(E=>{i.value=E.rows,M.value=E.total,v.value=!1})}function I(){Oe(null).then(E=>{m.value=E.data})}function N(){u.value.pageNum=1,x()}function P(){c.resetForm("queryRef"),N()}function le(E){r.value=E.map(_=>_.detailId),R.value=E.length!=1,h.value=!E.length}function ee(E){let _=[];E.detailId?_=[E.detailId]:_=r.value,c.$modal.confirm('是否确认删除ID为"'+_+'"的数据项？').then(function(){return tt({detailIds:_})}).then(()=>{x(),c.$modal.msgSuccess("删除成功")}).catch(()=>{})}function ne(E){let _=E.detailId;lt(_).then(p=>{console.log(p),q.value.request=p.data.request,q.value.projectId=p.data.projectId,q.value.moduleId=p.data.moduleId,q.value.caseId=p.data.caseId,q.value.caseName=p.data.caseName,j.value=!0})}return I(),N(),x(),(E,_)=>{const p=s("el-input"),w=s("el-form-item"),D=s("el-option"),T=s("el-select"),K=s("el-checkbox"),z=s("el-button"),f=s("el-form"),L=s("el-table-column"),Y=s("el-table"),se=s("pagination"),de=Ce("hasPermi"),S=Ce("loading");return y(),O("div",jt,[F(e(f,{model:a(u),ref:"queryRef",inline:!0},{default:t(()=>[n.viewType===a(we).report?(y(),U(w,{key:0,label:"执行ID",prop:"runId"},{default:t(()=>[e(p,{modelValue:a(u).runId,"onUpdate:modelValue":_[0]||(_[0]=C=>a(u).runId=C),placeholder:"请输入用例ID",clearable:"",style:{width:"200px"},onKeyup:Ne(N,["enter"])},null,8,["modelValue"])]),_:1})):G("",!0),n.viewType===a(we).report?(y(),U(w,{key:1,label:"用例名称",prop:"runName"},{default:t(()=>[e(p,{modelValue:a(u).runName,"onUpdate:modelValue":_[1]||(_[1]=C=>a(u).runName=C),placeholder:"请输入用例名称",clearable:"",style:{width:"200px"},onKeyup:Ne(N,["enter"])},null,8,["modelValue"])]),_:1})):G("",!0),n.viewType===a(we).case?(y(),U(w,{key:2,label:"执行方式",prop:"runType"},{default:t(()=>[e(T,{modelValue:a(u).runType,"onUpdate:modelValue":_[2]||(_[2]=C=>a(u).runType=C),placeholder:"执行方式",clearable:"",style:{width:"100px"}},{default:t(()=>[(y(!0),O(B,null,te(a(d),C=>(y(),U(D,{key:C.value,label:C.label,value:C.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):G("",!0),e(w,{label:"状态",prop:"status"},{default:t(()=>[e(T,{modelValue:a(u).status,"onUpdate:modelValue":_[3]||(_[3]=C=>a(u).status=C),placeholder:"用例状态",clearable:"",style:{width:"100px"}},{default:t(()=>[(y(!0),O(B,null,te(a(o),C=>(y(),U(D,{key:C.value,label:C.label,value:C.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(w,null,{default:t(()=>[e(K,{modelValue:a($),"onUpdate:modelValue":_[4]||(_[4]=C=>W($)?$.value=C:null)},{default:t(()=>[V("仅自己的数据")]),_:1},8,["modelValue"])]),_:1}),e(w,null,{default:t(()=>[e(z,{type:"primary",icon:"Search",onClick:N},{default:t(()=>[V("搜索")]),_:1}),e(z,{type:"default",icon:"Refresh",onClick:P},{default:t(()=>[V("重置")]),_:1}),F((y(),U(z,{type:"danger",icon:"Refresh",onClick:ee},{default:t(()=>[V("删除 ")]),_:1})),[[de,["hrm:history:delete"]]])]),_:1})]),_:1},8,["model"]),[[ae,a(b)]]),F((y(),U(Y,{data:a(i),onSelectionChange:le,border:""},{default:t(()=>[e(L,{type:"selection",width:"55",align:"center"}),e(L,{label:"ID",align:"center",prop:"detailId",width:"150px"}),e(L,{label:"执行ID",align:"center",prop:"runId",width:"150px"}),e(L,{label:"名称",align:"left",prop:"runName"}),e(L,{label:"状态",align:"center",prop:"status",width:"70px"},{default:t(C=>[e($e,{options:a(o),value:C.row.status},null,8,["options","value"])]),_:1}),e(L,{label:"执行方式",align:"center",prop:"runType",width:"110px"},{default:t(C=>[e($e,{options:a(d),value:C.row.runType},null,8,["options","value"])]),_:1}),e(L,{label:"执行开始时间",align:"center",prop:"createTime","class-name":"small-padding fixed-width",width:"150px"},{default:t(C=>[J("span",null,oe(E.parseTime(C.row.runStartTime)),1)]),_:1}),e(L,{label:"执行时长(S)",align:"center",prop:"createTime","class-name":"small-padding fixed-width",width:"80px"},{default:t(C=>[J("span",null,oe(C.row.runDuration),1)]),_:1}),e(L,{label:"操作",width:"80",align:"center","class-name":"small-padding fixed-width"},{default:t(C=>[F(e(z,{link:"",type:"primary",icon:"View",onClick:re=>ne(C.row),title:"查看"},null,8,["onClick"]),[[de,["hrm:history:detail"]]]),F(e(z,{link:"",type:"danger",icon:"Delete",onClick:re=>ee(C.row),title:"删除"},null,8,["onClick"]),[[de,["hrm:history:delete"]]])]),_:1})]),_:1},8,["data"])),[[S,a(v)]]),F(e(se,{total:a(M),page:a(u).pageNum,"onUpdate:page":_[5]||(_[5]=C=>a(u).pageNum=C),limit:a(u).pageSize,"onUpdate:limit":_[6]||(_[6]=C=>a(u).pageSize=C),onPagination:x},null,8,["total","page","limit"]),[[ae,a(M)>0]]),e(Mt,{"open-case-edit-dialog":a(j),"onUpdate:openCaseEditDialog":_[7]||(_[7]=C=>W(j)?j.value=C:null),"form-datas":a(q),"data-type":a(X).run_detail},null,8,["open-case-edit-dialog","form-datas","data-type"])])}}});export{yt as C,Je as S,bt as _,Vt as a,It as b,Qt as c,Mt as d,Xt as g,We as l};
