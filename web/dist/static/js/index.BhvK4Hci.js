import{X as ie,r as d,A as me,J as he,N as we,d as n,H as ce,o as p,c as A,I as q,M as se,h as t,e,f as l,l as ve,O as ae,P as oe,m as D,p as h,K as ne,i as G,y as W,n as Ve,F as ye,s as Ie,E as Se,au as qe,v as Te,a6 as je,a5 as $e,_ as Me}from"./index.B-ki0wTK.js";import{l as De,H as ke,R as Re}from"./project.CjUq6QCv.js";import{_ as Le}from"./run_dialog.hwjk6Wms.js";import{s as Ue,l as Oe,g as Qe,d as ze}from"./module.DGh92-sK.js";import{i as Fe}from"./data-template.D-VuWITS.js";import{l as Ee}from"./case.D3mpduVc.js";import"./run_detail.B7CDhMn4.js";import"./env.BXDgmL9O.js";import"./tools.CngWgkPu.js";function Ke(g){return ie({url:"/qtr/suite/list",method:"get",params:g})}function xe(g){return ie({url:"/qtr/suite/"+g,method:"get"})}function Be(g){return ie({url:"/qtr/suite",method:"post",data:g})}function Ae(g){return ie({url:"/qtr/suite",method:"put",data:g})}function He(g){return ie({url:"/qtr/suite/"+g,method:"delete"})}function Ge(g){return ie({url:"/qtr/suite/detailList",method:"get",params:g})}function Ce(g){return ie({url:"/qtr/suite/addSuiteDetail",method:"post",data:g})}function Je(g){return ie({url:"/qtr/suite/editSuiteDetail",method:"put",data:g})}function Xe(g){return ie({url:"/qtr/suite/getSuiteDetail/"+g,method:"get"})}const We={class:"app-container"},Ye=ye({name:"project"}),Ze=Object.assign(Ye,{props:{suiteId:{},suiteIdModifiers:{}},emits:["update:suiteId"],setup(g,{expose:L}){const{proxy:b}=Ie(),{qtr_data_status:O}=b.useDict("qtr_data_status"),T=d([]);d(!1);const N=d(!1),U=d(!0);d("");const w=d(!0),P=d(!0),j=d([]),$=me(g,"suiteId"),M=d([]),z=he({form:{},queryParams:{projectName:void 0,status:void 0,isPage:!1,suiteId:$,dataType:1},rules:{projectName:[{required:!0,message:"项目名称不能为空",trigger:"blur"}],orderNum:[{required:!0,message:"显示排序不能为空",trigger:"blur"}]}}),{queryParams:k,form:Q,rules:Y}=we(z);L({getList:R});function R(){N.value=!0,De(k.value).then(x=>{T.value=x.data,N.value=!1})}function m(x){j.value=x.map(v=>v.projectId),M.value=j.value,multiple.value=!x.length}function F(){R()}function y(){b.resetForm("queryRef"),F()}function c(x){if(x&&"projectId"in x&&x.projectId&&(M.value=[x.projectId]),!M.value||M.value.length===0){Se.alert("请选择项目","提示！",{type:"warning"});return}const v={suiteId:$.value,dataIds:M.value,dataType:1};Ce(v).then(Z=>{b.$modal.msgSuccess("新增成功"),openProjectCaseDialog.value=!1})}return(x,v)=>{const Z=n("el-input"),J=n("el-form-item"),ee=n("el-option"),X=n("el-select"),te=n("el-button"),H=n("el-form"),ue=n("el-col"),I=n("right-toolbar"),o=n("el-row"),a=n("el-table-column"),u=n("dict-tag"),S=n("el-table"),V=ce("loading");return p(),A("div",We,[q(e(H,{model:t(k),ref:"queryRef",inline:!0},{default:l(()=>[e(J,{label:"项目名称",prop:"projectName"},{default:l(()=>[e(Z,{modelValue:t(k).projectName,"onUpdate:modelValue":v[0]||(v[0]=C=>t(k).projectName=C),placeholder:"请输入项目名称",clearable:"",style:{width:"200px"},onKeyup:ve(F,["enter"])},null,8,["modelValue"])]),_:1}),e(J,{label:"状态",prop:"status"},{default:l(()=>[e(X,{modelValue:t(k).status,"onUpdate:modelValue":v[1]||(v[1]=C=>t(k).status=C),placeholder:"项目状态",clearable:"",style:{width:"200px"}},{default:l(()=>[(p(!0),A(ae,null,oe(t(O),C=>(p(),D(ee,{key:C.value*1,label:C.label,value:C.value*1},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(J,null,{default:l(()=>[e(te,{type:"primary",icon:"Search",onClick:F},{default:l(()=>v[3]||(v[3]=[h("搜索")])),_:1}),e(te,{icon:"Refresh",onClick:y},{default:l(()=>v[4]||(v[4]=[h("重置")])),_:1})]),_:1})]),_:1},8,["model"]),[[se,t(U)]]),e(o,{gutter:10,class:"mb8"},{default:l(()=>[e(ue,{span:1.5},{default:l(()=>[e(te,{type:"primary",onClick:c},{default:l(()=>v[5]||(v[5]=[h("保存")])),_:1})]),_:1}),e(I,{showSearch:t(U),"onUpdate:showSearch":v[2]||(v[2]=C=>ne(U)?U.value=C:null),onQueryTable:R},null,8,["showSearch"])]),_:1}),t(P)?q((p(),D(S,{key:0,border:"",data:t(T),style:{width:"100%"},height:"350","row-key":"projectId","default-expand-all":t(w),onSelectionChange:m},{default:l(()=>[e(a,{type:"selection",width:"55",align:"center"}),e(a,{prop:"projectId",label:"ID",width:"150"}),e(a,{prop:"projectName",align:"center",label:"项目名称",width:"200"}),e(a,{prop:"testUser",label:"测试负责人",align:"center",width:"120"}),e(a,{prop:"status",label:"状态",align:"center",width:"100"},{default:l(C=>[e(u,{options:t(O),value:C.row.status+""},null,8,["options","value"])]),_:1}),e(a,{label:"创建时间",align:"center",prop:"createTime","class-name":"small-padding fixed-width"},{default:l(C=>[G("span",null,W(x.parseTime(C.row.createTime)),1)]),_:1}),e(a,{label:"更新时间",align:"center",prop:"updateTime","class-name":"small-padding fixed-width"},{default:l(C=>[G("span",null,W(x.parseTime(C.row.updateTime)),1)]),_:1})]),_:1},8,["data","default-expand-all"])),[[V,t(N)]]):Ve("",!0)])}}}),et={class:"app-container"},tt={__name:"case-data",props:qe({dataType:{type:Number,default:ke.case},formRules:{type:Object,default:{caseName:[{required:!0,message:"用例名称不能为空",trigger:"blur"}],projectId:[{required:!0,message:"所属项目不能为空",trigger:"blur"}],moduleId:[{required:!0,message:"所属模块不能为空",trigger:"blur"}]}}},{suiteId:{},suiteIdModifiers:{},openProjectCaseDialog:{},openProjectCaseDialogModifiers:{}}),emits:["update:suiteId","update:openProjectCaseDialog"],setup(g,{expose:L}){const{proxy:b}=Ie();b.useDict("qtr_case_status");const{sys_normal_disable:O}=b.useDict("sys_normal_disable");b.useDict("sys_request_method");const{hrm_data_type:T}=b.useDict("hrm_data_type"),N=me(g,"suiteId");L({getList:v});const U=g,w=Te(()=>U.dataType===ke.case?"用例":"配置");je("hrm_data_type",T),je("sys_normal_disable",O);const P=me(g,"openProjectCaseDialog"),j=d([]),$=d([]),M=d([]);d(!1);const z=d(!1),k=d(!0),Q=d([]),Y=d(!0),R=d(!0),m=d(0);d("");const F=d(!0),y=d([]);d(!1);const c=$e({pageNum:1,pageSize:10,type:U.dataType,caseId:void 0,suiteId:N,dataType:3,caseName:void 0,projectId:void 0,moduleId:void 0,status:void 0,onlySelf:F});d(Fe);function x(I){return I||"全局"}function v(){z.value=!0,Ee(c.value).then(I=>{j.value=I.rows,m.value=I.total}).finally(()=>{z.value=!1})}function Z(){De(null).then(I=>{$.value=I.data})}function J(){Ue(c.value).then(I=>{M.value=I.data})}function ee(){c.value.moduleId=void 0,J()}function X(){c.value.pageNum=1,v()}function te(){b.resetForm("queryRef"),X()}function H(I){Q.value=I.map(o=>o.caseId),y.value=Q.value,Y.value=I.length!==1,R.value=!I.length}function ue(I){if(I&&"caseId"in I&&I.caseId&&(y.value=[I.caseId]),!y.value||y.value.length===0){Se.alert("请选择用例","提示！",{type:"warning"});return}const o={suiteId:N.value,dataIds:y.value,dataType:3};Ce(o).then(a=>{b.$modal.msgSuccess("新增成功"),P.value=!1})}return Z(),(I,o)=>{const a=n("el-option"),u=n("el-select"),S=n("el-form-item"),V=n("el-input"),C=n("el-checkbox"),E=n("el-button"),K=n("el-form"),re=n("el-col"),le=n("right-toolbar"),fe=n("el-row"),f=n("el-table-column"),B=n("dict-tag"),ge=n("el-table"),_e=n("pagination"),pe=ce("loading");return p(),A("div",et,[q(e(K,{model:t(c),ref:"queryRef",inline:!0},{default:l(()=>[e(S,{label:"所属项目",prop:"projectId"},{default:l(()=>[e(u,{modelValue:t(c).projectId,"onUpdate:modelValue":o[0]||(o[0]=i=>t(c).projectId=i),placeholder:"请选择",onChange:ee,clearable:"",style:{width:"150px"}},{default:l(()=>[(p(!0),A(ae,null,oe(t($),i=>(p(),D(a,{key:i.projectId,label:i.projectName,value:i.projectId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(S,{label:"所属模块",prop:"moduleId"},{default:l(()=>[e(u,{modelValue:t(c).moduleId,"onUpdate:modelValue":o[1]||(o[1]=i=>t(c).moduleId=i),placeholder:"请选择",clearable:"",style:{width:"150px"}},{default:l(()=>[(p(!0),A(ae,null,oe(t(M),i=>(p(),D(a,{key:i.moduleId,label:i.moduleName,value:i.moduleId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(S,{label:t(w)+"ID",prop:"caseId"},{default:l(()=>[e(V,{modelValue:t(c).caseId,"onUpdate:modelValue":o[2]||(o[2]=i=>t(c).caseId=i),placeholder:"请输入"+t(w)+"ID",clearable:"",style:{width:"200px"},onKeyup:ve(X,["enter"])},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(S,{label:t(w)+"名称",prop:"caseName"},{default:l(()=>[e(V,{modelValue:t(c).caseName,"onUpdate:modelValue":o[3]||(o[3]=i=>t(c).caseName=i),placeholder:"请输入"+t(w)+"名称",clearable:"",style:{width:"200px"},onKeyup:ve(X,["enter"])},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(S,{label:"状态",prop:"status"},{default:l(()=>[e(u,{modelValue:t(c).status,"onUpdate:modelValue":o[4]||(o[4]=i=>t(c).status=i),placeholder:t(w)+"状态",clearable:"",style:{width:"100px"}},{default:l(()=>[(p(!0),A(ae,null,oe(t(O),i=>(p(),D(a,{key:i.value*1,label:i.label,value:i.value*1},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1}),e(S,null,{default:l(()=>[e(C,{modelValue:t(F),"onUpdate:modelValue":o[5]||(o[5]=i=>ne(F)?F.value=i:null),onChange:X},{default:l(()=>o[9]||(o[9]=[h("仅自己的数据")])),_:1},8,["modelValue"])]),_:1}),e(S,null,{default:l(()=>[e(E,{type:"primary",icon:"Search",onClick:X},{default:l(()=>o[10]||(o[10]=[h("搜索")])),_:1}),e(E,{type:"default",icon:"Refresh",onClick:te},{default:l(()=>o[11]||(o[11]=[h("重置")])),_:1})]),_:1})]),_:1},8,["model"]),[[se,t(k)]]),e(fe,{gutter:10,class:"mb8"},{default:l(()=>[e(re,{span:1.5},{default:l(()=>[e(E,{type:"primary",onClick:ue},{default:l(()=>o[12]||(o[12]=[h("保存")])),_:1})]),_:1}),e(le,{showSearch:t(k),"onUpdate:showSearch":o[6]||(o[6]=i=>ne(k)?k.value=i:null),onQueryTable:v},null,8,["showSearch"])]),_:1}),q((p(),D(ge,{data:t(j),style:{width:"100%"},height:"350",onSelectionChange:H,border:"","table-layout":"fixed"},{default:l(()=>[e(f,{type:"selection",width:"55",align:"center"}),e(f,{label:t(w)+"ID",prop:"caseId",width:"150px"},null,8,["label"]),e(f,{label:t(w)+"名称",prop:"caseName",width:"auto"},null,8,["label"]),e(f,{label:"所属项目",prop:"projectName"},{default:l(i=>[G("span",null,W(x(i.row.projectName)),1)]),_:1}),e(f,{label:"所属模块",prop:"moduleName"},{default:l(i=>[G("span",null,W(x(i.row.moduleName)),1)]),_:1}),e(f,{label:"状态",align:"center",prop:"status",width:"70px"},{default:l(i=>[e(B,{options:t(O),value:i.row.status+""},null,8,["options","value"])]),_:1}),e(f,{label:"创建人",align:"center",prop:"createBy"}),e(f,{label:"创建时间",align:"center",prop:"createTime","class-name":"small-padding fixed-width",width:"150px"},{default:l(i=>[G("span",null,W(I.parseTime(i.row.createTime)),1)]),_:1}),e(f,{label:"更新时间",align:"center",prop:"createTime","class-name":"small-padding fixed-width",width:"150px"},{default:l(i=>[G("span",null,W(I.parseTime(i.row.updateTime)),1)]),_:1})]),_:1},8,["data"])),[[pe,t(z)]]),q(e(_e,{total:t(m),page:t(c).pageNum,"onUpdate:page":o[7]||(o[7]=i=>t(c).pageNum=i),limit:t(c).pageSize,"onUpdate:limit":o[8]||(o[8]=i=>t(c).pageSize=i),onPagination:v},null,8,["total","page","limit"]),[[se,t(m)>0]])])}}},lt={class:"app-container"},at=ye({name:"Module"}),ot=Object.assign(at,{props:{suiteId:{},suiteIdModifiers:{}},emits:["update:suiteId"],setup(g,{expose:L}){const{proxy:b}=Ie(),{qtr_data_status:O}=b.useDict("qtr_data_status"),T=d([]),N=d([]),U=d(!1),w=d(!1),P=d(!0),j=d([]),$=d(!0),M=d(!0),z=d(0),k=d("");d(!1),d([]);const Q=me(g,"suiteId"),Y=d([]),R=he({form:{testUser:void 0},queryParams:{pageNum:1,pageSize:10,suiteId:Q,dataType:2,projectId:void 0,moduleName:void 0,status:void 0},rules:{moduleName:[{required:!0,message:"模块名称不能为空",trigger:"blur"}],projectId:[{required:!0,message:"所属项目不能为空",trigger:"blur"}],testUser:[{required:!0,message:"测试负责人不能为空",trigger:"blur"}],sort:[{required:!0,message:"模块顺序不能为空",trigger:"blur"}]}}),{queryParams:m,form:F,rules:y}=we(R);L({getList:c});function c(){w.value=!0,Oe(m.value).then(o=>{T.value=o.rows,z.value=o.total,w.value=!1})}function x(){De({isPage:!1}).then(o=>{N.value=o.data})}function v(o,a,u){return Z(o.projectId)}function Z(o){for(const a of N.value)if(o===a.projectId)return a.projectName}function J(){F.value={moduleId:void 0,projectId:void 0,moduleName:void 0,sort:0,status:"0",remark:void 0},b.resetForm("postRef")}function ee(){m.value.pageNum=1,x(),c()}function X(){b.resetForm("queryRef"),ee()}function te(o){j.value=o.map(a=>a.moduleId),Y.value=j.value,$.value=o.length!=1,M.value=!o.length}function H(o){J();const a=o.moduleId||j.value;Qe(a).then(u=>{F.value=u.data,U.value=!0,k.value="修改模块"})}function ue(o){const a=o.moduleId||j.value;b.$modal.confirm('是否确认删除模块编号为"'+a+'"的数据项？').then(function(){return ze(a)}).then(()=>{c(),b.$modal.msgSuccess("删除成功")}).catch(()=>{})}function I(o){if(o&&"projectId"in o&&o.moduleId&&(Y.value=[o.moduleId]),!Y.value||Y.value.length===0){Se.alert("请选择模块","提示！",{type:"warning"});return}const a={suiteId:Q.value,dataIds:Y.value,dataType:2};Ce(a).then(u=>{b.$modal.msgSuccess("新增成功"),openProjectCaseDialog.value=!1})}return x(),(o,a)=>{const u=n("el-option"),S=n("el-select"),V=n("el-form-item"),C=n("el-input"),E=n("el-button"),K=n("el-form"),re=n("el-col"),le=n("right-toolbar"),fe=n("el-row"),f=n("el-table-column"),B=n("dict-tag"),ge=n("el-table"),_e=n("pagination"),pe=ce("hasPermi"),i=ce("loading");return p(),A("div",lt,[q(e(K,{model:t(m),ref:"queryRef",inline:!0},{default:l(()=>[e(V,{label:"项目",prop:"projectId"},{default:l(()=>[e(S,{modelValue:t(m).projectId,"onUpdate:modelValue":a[0]||(a[0]=_=>t(m).projectId=_),placeholder:"请选择",clearable:"",style:{width:"150px"}},{default:l(()=>[(p(!0),A(ae,null,oe(t(N),_=>(p(),D(u,{key:_.projectId,label:_.projectName,value:_.projectId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(V,{label:"模块名称",prop:"moduleName"},{default:l(()=>[e(C,{modelValue:t(m).moduleName,"onUpdate:modelValue":a[1]||(a[1]=_=>t(m).moduleName=_),placeholder:"请输入模块名称",clearable:"",style:{width:"200px"},onKeyup:ve(ee,["enter"])},null,8,["modelValue"])]),_:1}),e(V,{label:"状态",prop:"status"},{default:l(()=>[e(S,{modelValue:t(m).status,"onUpdate:modelValue":a[2]||(a[2]=_=>t(m).status=_),placeholder:"模块状态",clearable:"",style:{width:"200px"}},{default:l(()=>[(p(!0),A(ae,null,oe(t(O),_=>(p(),D(u,{key:_.value*1,label:_.label,value:_.value*1},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(V,null,{default:l(()=>[e(E,{type:"primary",icon:"Search",onClick:ee},{default:l(()=>a[6]||(a[6]=[h("搜索")])),_:1}),e(E,{icon:"Refresh",onClick:X},{default:l(()=>a[7]||(a[7]=[h("重置")])),_:1})]),_:1})]),_:1},8,["model"]),[[se,t(P)]]),e(fe,{gutter:10,class:"mb8"},{default:l(()=>[e(re,{span:1.5},{default:l(()=>[e(E,{type:"primary",onClick:I},{default:l(()=>a[8]||(a[8]=[h("保存")])),_:1})]),_:1}),e(le,{showSearch:t(P),"onUpdate:showSearch":a[3]||(a[3]=_=>ne(P)?P.value=_:null),onQueryTable:c},null,8,["showSearch"])]),_:1}),q((p(),D(ge,{border:"",data:t(T),style:{width:"100%"},height:"350",onSelectionChange:te},{default:l(()=>[e(f,{type:"selection",width:"55",align:"center"}),e(f,{label:"模块ID",align:"center",prop:"moduleId"}),e(f,{label:"模块名称",align:"center",prop:"moduleName"}),e(f,{label:"所属项目",align:"center",formatter:v}),e(f,{label:"测试人员",align:"center",prop:"testUser"}),e(f,{label:"模块排序",align:"center",prop:"sort"}),e(f,{label:"状态",align:"center",prop:"status"},{default:l(_=>[e(B,{options:t(O),value:_.row.status+""},null,8,["options","value"])]),_:1}),e(f,{label:"创建时间",align:"center",prop:"createTime","class-name":"small-padding fixed-width"},{default:l(_=>[G("span",null,W(o.parseTime(_.row.createTime)),1)]),_:1}),e(f,{label:"更新时间",align:"center",prop:"createTime","class-name":"small-padding fixed-width"},{default:l(_=>[G("span",null,W(o.parseTime(_.row.updateTime)),1)]),_:1}),e(f,{label:"操作",width:"180",align:"center","class-name":"small-padding fixed-width"},{default:l(_=>[q((p(),D(E,{link:"",type:"primary",icon:"Edit",onClick:be=>H(_.row)},{default:l(()=>a[9]||(a[9]=[h(" 修改 ")])),_:2},1032,["onClick"])),[[pe,["hrm:module:edit"]]]),q((p(),D(E,{link:"",type:"primary",icon:"Delete",onClick:be=>ue(_.row)},{default:l(()=>a[10]||(a[10]=[h("删除 ")])),_:2},1032,["onClick"])),[[pe,["hrm:module:remove"]]])]),_:1})]),_:1},8,["data"])),[[i,t(w)]]),q(e(_e,{total:t(z),page:t(m).pageNum,"onUpdate:page":a[4]||(a[4]=_=>t(m).pageNum=_),limit:t(m).pageSize,"onUpdate:limit":a[5]||(a[5]=_=>t(m).pageSize=_),onPagination:c},null,8,["total","page","limit"]),[[se,t(z)>0]])])}}}),nt=ye({__name:"config-suite-data-dialog",props:{openConfigSuiteDataDialog:{},openConfigSuiteDataDialogModifiers:{},suiteId:{},suiteIdModifiers:{}},emits:qe(["close-dialog"],["update:openConfigSuiteDataDialog","update:suiteId"]),setup(g,{emit:L}){const b=me(g,"openConfigSuiteDataDialog"),O=me(g,"suiteId"),T=d("Case"),N=d(null),U=d(null),w=d(null),P=(j,$)=>{j.props.name==="Case"?N.value.getList():j.props.name==="Module"?U.value.getList():j.props.name==="Project"&&w.value.getList()};return(j,$)=>{const M=n("el-tab-pane"),z=n("el-tabs"),k=n("el-dialog");return p(),D(k,{modelValue:b.value,"onUpdate:modelValue":$[1]||($[1]=Q=>b.value=Q),width:"1200",title:"套件数据配置","append-to-body":"","destroy-on-close":"",draggable:"",overflow:"","close-on-click-modal":!1,onClosed:$[2]||($[2]=Q=>j.$emit("close-dialog"))},{default:l(()=>[e(z,{modelValue:T.value,"onUpdate:modelValue":$[0]||($[0]=Q=>T.value=Q),class:"demo-tabs",onTabClick:P},{default:l(()=>[e(M,{label:"Case",name:"Case"},{default:l(()=>[e(tt,{suiteId:O.value,ref_key:"callCase",ref:N},null,8,["suiteId"])]),_:1}),e(M,{label:"Module",name:"Module"},{default:l(()=>[e(ot,{suiteId:O.value,ref_key:"callModule",ref:U},null,8,["suiteId"])]),_:1}),e(M,{label:"Project",name:"Project"},{default:l(()=>[e(Ze,{suiteId:O.value,ref_key:"callProject",ref:w},null,8,["suiteId"])]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])}}}),ut=Me(nt,[["__scopeId","data-v-c9945769"]]),dt={class:"app-container"},st=ye({name:"SuiteDetail"}),it=Object.assign(st,{props:{suiteId:{},suiteIdModifiers:{},openSuiteDetailDialog:{},openSuiteDetailDialogModifiers:{}},emits:["update:suiteId","update:openSuiteDetailDialog"],setup(g){const L=me(g,"suiteId"),{proxy:b}=Ie(),{qtr_case_status:O}=b.useDict("qtr_case_status"),{qtr_data_type:T}=b.useDict("qtr_data_type"),N=d(!0),U=d(!1),w=d(!1),P=d(!1),j=d(0),$=d(0),M=d([]);d([]);const z=d([]),k=d([]),Q=d(!0),Y=d(!0),R=d([]),m=he({form:{},queryParams:{dataName:void 0,projectId:void 0,suiteDetailId:void 0,suiteId:L,dataId:void 0,moduleId:void 0,pageNum:1,pageSize:10,status:void 0}}),F=me(g,"openSuiteDetailDialog"),{queryParams:y,form:c}=we(m);function x(o){R.value=o.map(a=>a.suiteDetailId)}function v(){H()}function Z(){b.resetForm("queryRef_detail"),v()}function J(){$.value=L.value,U.value=!0}function ee(){De(null).then(o=>{z.value=o.data})}function X(){Ue(y.value).then(o=>{k.value=o.data})}function te(){y.value.moduleId=void 0,X()}function H(){w.value=!0,Ge(y.value).then(o=>{M.value=o.rows,j.value=o.total}).finally(()=>{w.value=!1})}function ue(){M.value=[]}function I(o){P.value=!0,Xe(o.suiteDetailId).then(a=>{if(!a.data||Object.keys(a.data).length===0){alert("未查到对应数据！");return}a.data.status=o.status,Je(a.data).then(u=>{b.$modal.msgSuccess("修改成功")})}).finally(()=>{P.value=!1})}return ee(),H(),(o,a)=>{const u=n("el-option"),S=n("el-select"),V=n("el-form-item"),C=n("el-input"),E=n("el-button"),K=n("el-form"),re=n("el-col"),le=n("right-toolbar"),fe=n("el-row"),f=n("el-table-column"),B=n("dict-tag"),ge=n("el-switch"),_e=n("el-table"),pe=n("pagination"),i=n("el-dialog"),_=ce("hasPermi"),be=ce("loading");return p(),D(i,{fullscreen:"",suiteId:L.value,modelValue:F.value,"onUpdate:modelValue":a[9]||(a[9]=s=>F.value=s),"append-to-body":"","destroy-on-close":"",onClose:ue,onOpen:H},{default:l(()=>[G("div",dt,[q(e(K,{model:t(y),ref:"queryRef_detail",inline:!0},{default:l(()=>[e(V,{label:"所属项目",prop:"projectId"},{default:l(()=>[e(S,{modelValue:t(y).projectId,"onUpdate:modelValue":a[0]||(a[0]=s=>t(y).projectId=s),placeholder:"请选择",onChange:te,clearable:"",style:{width:"150px"}},{default:l(()=>[(p(!0),A(ae,null,oe(t(z),s=>(p(),D(u,{key:s.projectId,label:s.projectName,value:s.projectId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(V,{label:"所属模块",prop:"moduleId"},{default:l(()=>[e(S,{modelValue:t(y).moduleId,"onUpdate:modelValue":a[1]||(a[1]=s=>t(y).moduleId=s),placeholder:"请选择",clearable:"",style:{width:"150px"}},{default:l(()=>[(p(!0),A(ae,null,oe(t(k),s=>(p(),D(u,{key:s.moduleId,label:s.moduleName,value:s.moduleId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a[12]||(a[12]=h(" 、 ")),e(V,{label:"数据ID",prop:"dataId"},{default:l(()=>[e(C,{modelValue:t(y).dataId,"onUpdate:modelValue":a[2]||(a[2]=s=>t(y).dataId=s),placeholder:"请输入数据ID",clearable:"",style:{width:"200px"},onKeyup:ve(v,["enter"])},null,8,["modelValue"])]),_:1}),e(V,{label:"数据名称",prop:"dataName"},{default:l(()=>[e(C,{modelValue:t(y).dataName,"onUpdate:modelValue":a[3]||(a[3]=s=>t(y).dataName=s),placeholder:"请输入数据名称",clearable:"",style:{width:"200px"},onKeyup:ve(v,["enter"])},null,8,["modelValue"])]),_:1}),e(V,{label:"数据状态",prop:"status"},{default:l(()=>[e(S,{modelValue:t(y).status,"onUpdate:modelValue":a[4]||(a[4]=s=>t(y).status=s),placeholder:"数据状态",clearable:"",style:{width:"200px"}},{default:l(()=>[(p(!0),A(ae,null,oe(t(O),s=>(p(),D(u,{key:s.value*1,label:s.label,value:s.value*1},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(V,null,{default:l(()=>[e(E,{type:"primary",icon:"Search",onClick:v},{default:l(()=>a[10]||(a[10]=[h("搜索")])),_:1}),e(E,{type:"success",icon:"Refresh",onClick:Z},{default:l(()=>a[11]||(a[11]=[h("重置")])),_:1})]),_:1})]),_:1},8,["model"]),[[se,t(N)]]),e(fe,{gutter:10,class:"mb8"},{default:l(()=>[e(re,{span:1.5},{default:l(()=>[e(E,{type:"warning",icon:"Plus",onClick:J},{default:l(()=>a[13]||(a[13]=[h("选择数据")])),_:1})]),_:1}),e(le,{showSearch:t(N),"onUpdate:showSearch":a[5]||(a[5]=s=>ne(N)?N.value=s:null),onQueryTable:H},null,8,["showSearch"])]),_:1})]),t(Q)?q((p(),D(_e,{key:0,border:"",data:t(M),"row-key":"suiteDetailId","default-expand-all":t(Y),onSelectionChange:x},{default:l(()=>[e(f,{type:"selection",width:"55",align:"center"}),e(f,{prop:"suiteDetailId",label:"ID",width:"160",align:"center"}),e(f,{prop:"suiteId",label:"套件ID",width:"160",align:"center"}),e(f,{prop:"dataId",label:"数据ID",width:"160",align:"center"}),e(f,{prop:"dataType",label:"数据类型",width:"100",align:"center"},{default:l(s=>[e(B,{options:t(T),value:s.row.dataType+""},null,8,["options","value"])]),_:1}),e(f,{prop:"dataName",label:"数据名称"}),e(f,{prop:"dataStatus",label:"数据状态",width:"100",align:"center"},{default:l(s=>[e(B,{options:t(O),value:s.row.dataStatus+""},null,8,["options","value"])]),_:1}),e(f,{label:"创建时间",align:"center",prop:"createTime",width:"160","class-name":"small-padding fixed-width"},{default:l(s=>[G("span",null,W(o.parseTime(s.row.createTime)),1)]),_:1}),e(f,{label:"更新时间",align:"center",prop:"updateTime",width:"160","class-name":"small-padding fixed-width"},{default:l(s=>[G("span",null,W(o.parseTime(s.row.updateTime)),1)]),_:1}),e(f,{label:"操作",width:"170",align:"center","class-name":"small-padding fixed-width",fixed:"right"},{default:l(s=>[e(ge,{modelValue:s.row.status,"onUpdate:modelValue":de=>s.row.status=de,"active-value":2,"active-text":"启用","inactive-value":1,"inactive-text":"停用",onChange:de=>I(s.row),loading:t(P)},null,8,["modelValue","onUpdate:modelValue","onChange","loading"]),q(e(E,{link:"",type:"danger",icon:"Delete",onClick:de=>o.handleDelete(s.row),title:"删除"},null,8,["onClick"]),[[_,["qtr:suite:remove"]]])]),_:1})]),_:1},8,["data","default-expand-all"])),[[be,t(w)]]):Ve("",!0),q(e(pe,{total:t(j),page:t(y).pageNum,"onUpdate:page":a[6]||(a[6]=s=>t(y).pageNum=s),limit:t(y).pageSize,"onUpdate:limit":a[7]||(a[7]=s=>t(y).pageSize=s),onPagination:H},null,8,["total","page","limit"]),[[se,t(j)>0]]),e(ut,{"form-datas":t(c),suiteId:t($),onCloseDialog:H,"open-config-suite-data-dialog":t(U),"onUpdate:openConfigSuiteDataDialog":a[8]||(a[8]=s=>ne(U)?U.value=s:null)},null,8,["form-datas","suiteId","open-config-suite-data-dialog"])]),_:1},8,["suiteId","modelValue"])}}}),rt={class:"app-container"},pt={class:"dialog-footer"},mt=ye({name:"Suite"}),wt=Object.assign(mt,{setup(g){const{proxy:L}=Ie(),{qtr_data_status:b}=L.useDict("qtr_data_status"),O=d([]),T=d(!1),N=d(!1),U=d(!0),w=d(!0),P=d(""),j=d(0),$=d(!0),M=d(!0),z=d(0),k=d(!1),Q=d([]),Y=he({form:{},queryParams:{pageNum:1,pageSize:10,suiteName:void 0,status:void 0},rules:{suiteName:[{required:!0,message:"套件名称不能为空",trigger:"blur"}],orderNum:[{required:!0,message:"显示排序不能为空",trigger:"blur"}]}}),{queryParams:R,form:m,rules:F}=we(Y),y=Te(()=>P.value);function c(){U.value=!0,Ke(R.value).then(a=>{O.value=a.rows,z.value=a.total,U.value=!1})}function x(a){Q.value=a.map(u=>u.suiteId)}function v(){T.value=!1,Z()}function Z(){m.value={suiteId:void 0,suiteName:void 0,orderNum:0,simpleDesc:void 0,status:"0"},L.resetForm("suiteRef")}function J(){c()}function ee(){L.resetForm("queryRef"),J()}function X(a){Z(),T.value=!0,P.value="添加套件"}function te(a){const u=a.suiteId;xe(u).then(S=>{if(!S.data||Object.keys(S.data).length===0){alert("未查到对应数据！");return}m.value=S.data,N.value=!0,j.value=a.suiteId,P.value="配置套件【"+S.data.suiteName+"】"})}function H(a){Z(),xe(a.suiteId).then(u=>{if(!u.data||Object.keys(u.data).length===0){alert("未查到对应数据！");return}m.value=u.data,T.value=!0,P.value="修改套件"})}function ue(){L.$refs.suiteRef.validate(a=>{a&&(m.value.suiteId!=null?Ae(m.value).then(u=>{L.$modal.msgSuccess("修改成功"),T.value=!1,c()}):Be(m.value).then(u=>{L.$modal.msgSuccess("新增成功"),T.value=!1,c()}))})}function I(a){L.$modal.confirm('是否确认删除名称为"'+a.suiteName+'"的数据项?').then(function(){return He(a.suiteId)}).then(()=>{c(),L.$modal.msgSuccess("删除成功")}).catch(()=>{})}function o(a){if(a&&"suiteId"in a&&a.suiteId&&(Q.value=[a.suiteId]),!Q.value||Q.value.length===0){Se.alert("请选择要运行的套件","提示！",{type:"warning"});return}k.value=!0}return c(),(a,u)=>{const S=n("el-input"),V=n("el-form-item"),C=n("el-option"),E=n("el-select"),K=n("el-button"),re=n("el-form"),le=n("el-col"),fe=n("right-toolbar"),f=n("el-row"),B=n("el-table-column"),ge=n("dict-tag"),_e=n("el-table"),pe=n("pagination"),i=n("el-input-number"),_=n("el-radio"),be=n("el-radio-group"),s=n("el-dialog"),de=ce("hasPermi"),Pe=ce("loading");return p(),A("div",rt,[q(e(re,{model:t(R),ref:"queryRef",inline:!0},{default:l(()=>[e(V,{label:"套件名称",prop:"suiteName"},{default:l(()=>[e(S,{modelValue:t(R).suiteName,"onUpdate:modelValue":u[0]||(u[0]=r=>t(R).suiteName=r),placeholder:"请输入套件名称",clearable:"",style:{width:"200px"},onKeyup:ve(J,["enter"])},null,8,["modelValue"])]),_:1}),e(V,{label:"状态",prop:"status"},{default:l(()=>[e(E,{modelValue:t(R).status,"onUpdate:modelValue":u[1]||(u[1]=r=>t(R).status=r),placeholder:"套件状态",clearable:"",style:{width:"200px"}},{default:l(()=>[(p(!0),A(ae,null,oe(t(b),r=>(p(),D(C,{key:r.value*1,label:r.label,value:r.value*1},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(V,null,{default:l(()=>[e(K,{type:"primary",icon:"Search",onClick:J},{default:l(()=>u[12]||(u[12]=[h("搜索")])),_:1}),e(K,{icon:"Refresh",onClick:ee},{default:l(()=>u[13]||(u[13]=[h("重置")])),_:1})]),_:1})]),_:1},8,["model"]),[[se,t(w)]]),e(f,{gutter:10,class:"mb8"},{default:l(()=>[e(le,{span:1.5},{default:l(()=>[q((p(),D(K,{type:"primary",plain:"",icon:"Plus",onClick:X},{default:l(()=>u[14]||(u[14]=[h("新增 ")])),_:1})),[[de,["qtr:suite:add"]]]),q((p(),D(K,{type:"warning",icon:"CaretRight",onClick:o,title:"运行"},{default:l(()=>u[15]||(u[15]=[h("执行 ")])),_:1})),[[de,["hrm:case:run"]]])]),_:1}),e(fe,{showSearch:t(w),"onUpdate:showSearch":u[2]||(u[2]=r=>ne(w)?w.value=r:null),onQueryTable:c},null,8,["showSearch"])]),_:1}),t(M)?q((p(),D(_e,{key:0,border:"",data:t(O),"row-key":"suiteId","default-expand-all":t($),onSelectionChange:x},{default:l(()=>[e(B,{type:"selection",width:"55",align:"center"}),e(B,{prop:"suiteId",label:"ID",width:"160"}),e(B,{prop:"suiteName",label:"套件名称",width:"200"}),u[19]||(u[19]=h(" \\ ")),e(B,{prop:"orderNum",label:"排序",width:"200"}),e(B,{prop:"status",label:"状态",width:"100"},{default:l(r=>[e(ge,{options:t(b),value:r.row.status+""},null,8,["options","value"])]),_:1}),e(B,{label:"创建时间",align:"center",prop:"createTime","class-name":"small-padding fixed-width"},{default:l(r=>[G("span",null,W(a.parseTime(r.row.createTime)),1)]),_:1}),e(B,{label:"更新时间",align:"center",prop:"updateTime","class-name":"small-padding fixed-width"},{default:l(r=>[G("span",null,W(a.parseTime(r.row.updateTime)),1)]),_:1}),e(B,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:l(r=>[q((p(),D(K,{link:"",type:"primary",icon:"Edit",onClick:Ne=>H(r.row)},{default:l(()=>u[16]||(u[16]=[h(" 修改 ")])),_:2},1032,["onClick"])),[[de,["qtr:suite:edit"]]]),q((p(),D(K,{link:"",type:"primary",icon:"Tools",onClick:Ne=>te(r.row)},{default:l(()=>u[17]||(u[17]=[h(" 配置 ")])),_:2},1032,["onClick"])),[[de,["qtr:suite:edit"]]]),q((p(),D(K,{link:"",type:"primary",icon:"Delete",onClick:Ne=>I(r.row)},{default:l(()=>u[18]||(u[18]=[h(" 删除 ")])),_:2},1032,["onClick"])),[[de,["qtr:suite:remove"]]])]),_:1})]),_:1},8,["data","default-expand-all"])),[[Pe,t(U)]]):Ve("",!0),q(e(pe,{total:t(z),page:t(R).pageNum,"onUpdate:page":u[3]||(u[3]=r=>t(R).pageNum=r),limit:t(R).pageSize,"onUpdate:limit":u[4]||(u[4]=r=>t(R).pageSize=r),onPagination:c},null,8,["total","page","limit"]),[[se,t(z)>0]]),e(s,{title:t(P),modelValue:t(T),"onUpdate:modelValue":u[9]||(u[9]=r=>ne(T)?T.value=r:null),"append-to-body":""},{footer:l(()=>[G("div",pt,[e(K,{type:"primary",onClick:ue},{default:l(()=>u[20]||(u[20]=[h("确 定")])),_:1}),e(K,{onClick:v},{default:l(()=>u[21]||(u[21]=[h("取 消")])),_:1})])]),default:l(()=>[e(re,{ref:"suiteRef",model:t(m),rules:t(F),"label-width":"80px"},{default:l(()=>[e(f,null,{default:l(()=>[e(le,{span:12},{default:l(()=>[e(V,{label:"套件名称",prop:"suiteName"},{default:l(()=>[e(S,{modelValue:t(m).suiteName,"onUpdate:modelValue":u[5]||(u[5]=r=>t(m).suiteName=r),placeholder:"请输入套件名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(le,{span:12},{default:l(()=>[e(V,{label:"显示排序",prop:"orderNum"},{default:l(()=>[e(i,{modelValue:t(m).orderNum,"onUpdate:modelValue":u[6]||(u[6]=r=>t(m).orderNum=r),"controls-position":"right",min:0},null,8,["modelValue"])]),_:1})]),_:1}),e(le,{span:12},{default:l(()=>[e(V,{label:"套件描述",prop:"simpleDesc"},{default:l(()=>[e(S,{modelValue:t(m).simpleDesc,"onUpdate:modelValue":u[7]||(u[7]=r=>t(m).simpleDesc=r),placeholder:"请输入描述",maxlength:"400"},null,8,["modelValue"])]),_:1})]),_:1}),e(le,{span:12},{default:l(()=>[e(V,{label:"套件状态"},{default:l(()=>[e(be,{modelValue:t(m).status,"onUpdate:modelValue":u[8]||(u[8]=r=>t(m).status=r)},{default:l(()=>[(p(!0),A(ae,null,oe(t(b),r=>(p(),D(_,{key:r.value*1,value:r.value*1},{default:l(()=>[h(W(r.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"]),e(Le,{"dialog-visible":t(k),"onUpdate:dialogVisible":u[10]||(u[10]=r=>ne(k)?k.value=r:null),"run-type":t(Re).suite,"run-ids":t(Q)},null,8,["dialog-visible","run-type","run-ids"]),e(it,{"form-datas":t(m),"open-suite-detail-dialog":t(N),"onUpdate:openSuiteDetailDialog":u[11]||(u[11]=r=>ne(N)?N.value=r:null),title:t(y),suiteId:t(j),"show-close":"","destroy-on-close":!0},null,8,["form-datas","open-suite-detail-dialog","title","suiteId"])])}}});export{wt as default};
