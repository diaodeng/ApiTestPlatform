{"version":3,"file":"data.D6DzpA5z.js","sources":["../../../src/views/system/dict/data.vue"],"sourcesContent":["<template>\r\n   <div class=\"app-container\">\r\n      <el-form :model=\"queryParams\" ref=\"queryRef\" :inline=\"true\" v-show=\"showSearch\">\r\n         <el-form-item label=\"字典名称\" prop=\"dictType\">\r\n            <el-select v-model=\"queryParams.dictType\" style=\"width: 200px\">\r\n               <el-option\r\n                  v-for=\"item in typeOptions\"\r\n                  :key=\"item.dictId\"\r\n                  :label=\"item.dictName\"\r\n                  :value=\"item.dictType\"\r\n               />\r\n            </el-select>\r\n         </el-form-item>\r\n         <el-form-item label=\"字典标签\" prop=\"dictLabel\">\r\n            <el-input\r\n               v-model=\"queryParams.dictLabel\"\r\n               placeholder=\"请输入字典标签\"\r\n               clearable\r\n               style=\"width: 200px\"\r\n               @keyup.enter=\"handleQuery\"\r\n            />\r\n         </el-form-item>\r\n         <el-form-item label=\"状态\" prop=\"status\">\r\n            <el-select v-model=\"queryParams.status\" placeholder=\"数据状态\" clearable style=\"width: 200px\">\r\n               <el-option\r\n                  v-for=\"dict in sys_normal_disable\"\r\n                  :key=\"dict.value\"\r\n                  :label=\"dict.label\"\r\n                  :value=\"dict.value\"\r\n               />\r\n            </el-select>\r\n         </el-form-item>\r\n         <el-form-item>\r\n            <el-button type=\"primary\" icon=\"Search\" @click=\"handleQuery\">搜索</el-button>\r\n            <el-button icon=\"Refresh\" @click=\"resetQuery\">重置</el-button>\r\n         </el-form-item>\r\n      </el-form>\r\n\r\n      <el-row :gutter=\"10\" class=\"mb8\">\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"primary\"\r\n               plain\r\n               icon=\"Plus\"\r\n               @click=\"handleAdd\"\r\n               v-hasPermi=\"['system:dict:add']\"\r\n            >新增</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"success\"\r\n               plain\r\n               icon=\"Edit\"\r\n               :disabled=\"single\"\r\n               @click=\"handleUpdate\"\r\n               v-hasPermi=\"['system:dict:edit']\"\r\n            >修改</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"danger\"\r\n               plain\r\n               icon=\"Delete\"\r\n               :disabled=\"multiple\"\r\n               @click=\"handleDelete\"\r\n               v-hasPermi=\"['system:dict:remove']\"\r\n            >删除</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"warning\"\r\n               plain\r\n               icon=\"Download\"\r\n               @click=\"handleExport\"\r\n               v-hasPermi=\"['system:dict:export']\"\r\n            >导出</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"warning\"\r\n               plain\r\n               icon=\"Close\"\r\n               @click=\"handleClose\"\r\n            >关闭</el-button>\r\n         </el-col>\r\n         <right-toolbar v-model:showSearch=\"showSearch\" @queryTable=\"getList\"></right-toolbar>\r\n      </el-row>\r\n\r\n      <el-table v-loading=\"loading\" :data=\"dataList\" @selection-change=\"handleSelectionChange\">\r\n         <el-table-column type=\"selection\" width=\"55\" align=\"center\" />\r\n         <el-table-column label=\"字典编码\" align=\"center\" prop=\"dictCode\" />\r\n         <el-table-column label=\"字典标签\" align=\"center\" prop=\"dictLabel\">\r\n            <template #default=\"scope\">\r\n               <span v-if=\"(scope.row.listClass == '' || scope.row.listClass == 'default') && (scope.row.cssClass == '' || scope.row.cssClass == null)\">{{ scope.row.dictLabel }}</span>\r\n               <el-tag v-else :type=\"scope.row.listClass == 'primary' ? '' : scope.row.listClass\" :class=\"scope.row.cssClass\">{{ scope.row.dictLabel }}</el-tag>\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column label=\"字典键值\" align=\"center\" prop=\"dictValue\" />\r\n         <el-table-column label=\"字典排序\" align=\"center\" prop=\"dictSort\" />\r\n         <el-table-column label=\"状态\" align=\"center\" prop=\"status\">\r\n            <template #default=\"scope\">\r\n               <dict-tag :options=\"sys_normal_disable\" :value=\"scope.row.status\" />\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column label=\"备注\" align=\"center\" prop=\"remark\" :show-overflow-tooltip=\"true\" />\r\n         <el-table-column label=\"创建时间\" align=\"center\" prop=\"createTime\" width=\"180\">\r\n            <template #default=\"scope\">\r\n               <span>{{ parseTime(scope.row.createTime) }}</span>\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column label=\"操作\" align=\"center\" width=\"160\" class-name=\"small-padding fixed-width\">\r\n            <template #default=\"scope\">\r\n               <el-button link type=\"primary\" icon=\"Edit\" @click=\"handleUpdate(scope.row)\" v-hasPermi=\"['system:dict:edit']\">修改</el-button>\r\n               <el-button link type=\"primary\" icon=\"Delete\" @click=\"handleDelete(scope.row)\" v-hasPermi=\"['system:dict:remove']\">删除</el-button>\r\n            </template>\r\n         </el-table-column>\r\n      </el-table>\r\n\r\n      <pagination\r\n         v-show=\"total > 0\"\r\n         :total=\"total\"\r\n         v-model:page=\"queryParams.pageNum\"\r\n         v-model:limit=\"queryParams.pageSize\"\r\n         @pagination=\"getList\"\r\n      />\r\n\r\n      <!-- 添加或修改参数配置对话框 -->\r\n      <el-dialog :title=\"title\" v-model=\"open\" width=\"500px\" append-to-body>\r\n         <el-form ref=\"dataRef\" :model=\"form\" :rules=\"rules\" label-width=\"80px\">\r\n            <el-form-item label=\"字典类型\">\r\n               <el-input v-model=\"form.dictType\" :disabled=\"true\" />\r\n            </el-form-item>\r\n            <el-form-item label=\"数据标签\" prop=\"dictLabel\">\r\n               <el-input v-model=\"form.dictLabel\" placeholder=\"请输入数据标签\" />\r\n            </el-form-item>\r\n            <el-form-item label=\"数据键值\" prop=\"dictValue\">\r\n               <el-input v-model=\"form.dictValue\" placeholder=\"请输入数据键值\" />\r\n            </el-form-item>\r\n            <el-form-item label=\"样式属性\" prop=\"cssClass\">\r\n               <el-input v-model=\"form.cssClass\" placeholder=\"请输入样式属性\" />\r\n            </el-form-item>\r\n            <el-form-item label=\"显示排序\" prop=\"dictSort\">\r\n               <el-input-number v-model=\"form.dictSort\" controls-position=\"right\" :min=\"0\" />\r\n            </el-form-item>\r\n            <el-form-item label=\"回显样式\" prop=\"listClass\">\r\n               <el-select v-model=\"form.listClass\">\r\n                  <el-option\r\n                     v-for=\"item in listClassOptions\"\r\n                     :key=\"item.value\"\r\n                     :label=\"item.label + '(' + item.value + ')'\"\r\n                     :value=\"item.value\"\r\n                  ></el-option>\r\n               </el-select>\r\n            </el-form-item>\r\n            <el-form-item label=\"状态\" prop=\"status\">\r\n               <el-radio-group v-model=\"form.status\">\r\n                  <el-radio\r\n                     v-for=\"dict in sys_normal_disable\"\r\n                     :key=\"dict.value\"\r\n                     :label=\"dict.value\"\r\n                  >{{ dict.label }}</el-radio>\r\n               </el-radio-group>\r\n            </el-form-item>\r\n            <el-form-item label=\"备注\" prop=\"remark\">\r\n               <el-input v-model=\"form.remark\" type=\"textarea\" placeholder=\"请输入内容\"></el-input>\r\n            </el-form-item>\r\n         </el-form>\r\n         <template #footer>\r\n            <div class=\"dialog-footer\">\r\n               <el-button type=\"primary\" @click=\"submitForm\">确 定</el-button>\r\n               <el-button @click=\"cancel\">取 消</el-button>\r\n            </div>\r\n         </template>\r\n      </el-dialog>\r\n   </div>\r\n</template>\r\n\r\n<script setup name=\"Data\">\r\nimport useDictStore from '@/store/modules/dict'\r\nimport { optionselect as getDictOptionselect, getType } from \"@/api/system/dict/type\";\r\nimport { listData, getData, delData, addData, updateData } from \"@/api/system/dict/data\";\r\n\r\nconst { proxy } = getCurrentInstance();\r\nconst { sys_normal_disable } = proxy.useDict(\"sys_normal_disable\");\r\n\r\nconst dataList = ref([]);\r\nconst open = ref(false);\r\nconst loading = ref(true);\r\nconst showSearch = ref(true);\r\nconst ids = ref([]);\r\nconst single = ref(true);\r\nconst multiple = ref(true);\r\nconst total = ref(0);\r\nconst title = ref(\"\");\r\nconst defaultDictType = ref(\"\");\r\nconst typeOptions = ref([]);\r\nconst route = useRoute();\r\n// 数据标签回显样式\r\nconst listClassOptions = ref([\r\n  { value: \"default\", label: \"默认\" }, \r\n  { value: \"primary\", label: \"主要\" }, \r\n  { value: \"success\", label: \"成功\" },\r\n  { value: \"info\", label: \"信息\" },\r\n  { value: \"warning\", label: \"警告\" },\r\n  { value: \"danger\", label: \"危险\" }\r\n]);\r\n\r\nconst data = reactive({\r\n  form: {},\r\n  queryParams: {\r\n    pageNum: 1,\r\n    pageSize: 10,\r\n    dictType: undefined,\r\n    dictLabel: undefined,\r\n    status: undefined\r\n  },\r\n  rules: {\r\n    dictLabel: [{ required: true, message: \"数据标签不能为空\", trigger: \"blur\" }],\r\n    dictValue: [{ required: true, message: \"数据键值不能为空\", trigger: \"blur\" }],\r\n    dictSort: [{ required: true, message: \"数据顺序不能为空\", trigger: \"blur\" }]\r\n  }\r\n});\r\n\r\nconst { queryParams, form, rules } = toRefs(data);\r\n\r\n/** 查询字典类型详细 */\r\nfunction getTypes(dictId) {\r\n  getType(dictId).then(response => {\r\n    queryParams.value.dictType = response.data.dictType;\r\n    defaultDictType.value = response.data.dictType;\r\n    getList();\r\n  });\r\n}\r\n\r\n/** 查询字典类型列表 */\r\nfunction getTypeList() {\r\n  getDictOptionselect().then(response => {\r\n    typeOptions.value = response.data;\r\n  });\r\n}\r\n/** 查询字典数据列表 */\r\nfunction getList() {\r\n  loading.value = true;\r\n  listData(queryParams.value).then(response => {\r\n    dataList.value = response.rows;\r\n    total.value = response.total;\r\n    loading.value = false;\r\n  });\r\n}\r\n/** 取消按钮 */\r\nfunction cancel() {\r\n  open.value = false;\r\n  reset();\r\n}\r\n/** 表单重置 */\r\nfunction reset() {\r\n  form.value = {\r\n    dictCode: undefined,\r\n    dictLabel: undefined,\r\n    dictValue: undefined,\r\n    cssClass: undefined,\r\n    listClass: \"default\",\r\n    dictSort: 0,\r\n    status: \"0\",\r\n    remark: undefined\r\n  };\r\n  proxy.resetForm(\"dataRef\");\r\n}\r\n/** 搜索按钮操作 */\r\nfunction handleQuery() {\r\n  queryParams.value.pageNum = 1;\r\n  getList();\r\n}\r\n/** 返回按钮操作 */\r\nfunction handleClose() {\r\n  const obj = { path: \"/system/dict\" };\r\n  proxy.$tab.closeOpenPage(obj);\r\n}\r\n/** 重置按钮操作 */\r\nfunction resetQuery() {\r\n  proxy.resetForm(\"queryRef\");\r\n  queryParams.value.dictType = defaultDictType.value;\r\n  handleQuery();\r\n}\r\n/** 新增按钮操作 */\r\nfunction handleAdd() {\r\n  reset();\r\n  open.value = true;\r\n  title.value = \"添加字典数据\";\r\n  form.value.dictType = queryParams.value.dictType;\r\n}\r\n/** 多选框选中数据 */\r\nfunction handleSelectionChange(selection) {\r\n  ids.value = selection.map(item => item.dictCode);\r\n  single.value = selection.length != 1;\r\n  multiple.value = !selection.length;\r\n}\r\n/** 修改按钮操作 */\r\nfunction handleUpdate(row) {\r\n  reset();\r\n  const dictCode = row.dictCode || ids.value;\r\n  getData(dictCode).then(response => {\r\n    form.value = response.data;\r\n    open.value = true;\r\n    title.value = \"修改字典数据\";\r\n  });\r\n}\r\n/** 提交按钮 */\r\nfunction submitForm() {\r\n  proxy.$refs[\"dataRef\"].validate(valid => {\r\n    if (valid) {\r\n      if (form.value.dictCode != undefined) {\r\n        updateData(form.value).then(response => {\r\n          useDictStore().removeDict(queryParams.value.dictType);\r\n          proxy.$modal.msgSuccess(\"修改成功\");\r\n          open.value = false;\r\n          getList();\r\n        });\r\n      } else {\r\n        addData(form.value).then(response => {\r\n          useDictStore().removeDict(queryParams.value.dictType);\r\n          proxy.$modal.msgSuccess(\"新增成功\");\r\n          open.value = false;\r\n          getList();\r\n        });\r\n      }\r\n    }\r\n  });\r\n}\r\n/** 删除按钮操作 */\r\nfunction handleDelete(row) {\r\n  const dictCodes = row.dictCode || ids.value;\r\n  proxy.$modal.confirm('是否确认删除字典编码为\"' + dictCodes + '\"的数据项？').then(function() {\r\n    return delData(dictCodes);\r\n  }).then(() => {\r\n    getList();\r\n    proxy.$modal.msgSuccess(\"删除成功\");\r\n    useDictStore().removeDict(queryParams.value.dictType);\r\n  }).catch(() => {});\r\n}\r\n/** 导出按钮操作 */\r\nfunction handleExport() {\r\n  proxy.download(\"system/dict/data/export\", {\r\n    ...queryParams.value\r\n  }, `dict_data_${new Date().getTime()}.xlsx`);\r\n}\r\n\r\ngetTypes(route.params && route.params.dictId);\r\ngetTypeList();\r\n</script>\r\n"],"names":["proxy","getCurrentInstance","sys_normal_disable","dataList","ref","open","loading","showSearch","ids","single","multiple","total","title","defaultDictType","typeOptions","route","useRoute","listClassOptions","data","reactive","queryParams","form","rules","toRefs","getTypes","dictId","getType","response","getList","getTypeList","getDictOptionselect","listData","cancel","reset","handleQuery","handleClose","obj","resetQuery","handleAdd","handleSelectionChange","selection","item","handleUpdate","row","dictCode","getData","submitForm","valid","updateData","useDictStore","addData","handleDelete","dictCodes","delData","handleExport"],"mappings":"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"}