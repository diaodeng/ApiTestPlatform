{"version":3,"file":"importTable.CtDKsmsL.js","sources":["../../../src/views/tool/gen/importTable.vue"],"sourcesContent":["<template>\r\n  <!-- 导入表 -->\r\n  <el-dialog title=\"导入表\" v-model=\"visible\" width=\"800px\" top=\"5vh\" append-to-body>\r\n    <el-form :model=\"queryParams\" ref=\"queryRef\" :inline=\"true\">\r\n      <el-form-item label=\"表名称\" prop=\"tableName\">\r\n        <el-input\r\n          v-model=\"queryParams.tableName\"\r\n          placeholder=\"请输入表名称\"\r\n          clearable\r\n          @keyup.enter=\"handleQuery\"\r\n        />\r\n      </el-form-item>\r\n      <el-form-item label=\"表描述\" prop=\"tableComment\">\r\n        <el-input\r\n          v-model=\"queryParams.tableComment\"\r\n          placeholder=\"请输入表描述\"\r\n          clearable\r\n          @keyup.enter=\"handleQuery\"\r\n        />\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" icon=\"Search\" @click=\"handleQuery\">搜索</el-button>\r\n        <el-button icon=\"Refresh\" @click=\"resetQuery\">重置</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n    <el-row>\r\n      <el-table @row-click=\"clickRow\" ref=\"table\" :data=\"dbTableList\" @selection-change=\"handleSelectionChange\" height=\"260px\">\r\n        <el-table-column type=\"selection\" width=\"55\"></el-table-column>\r\n        <el-table-column prop=\"tableName\" label=\"表名称\" :show-overflow-tooltip=\"true\"></el-table-column>\r\n        <el-table-column prop=\"tableComment\" label=\"表描述\" :show-overflow-tooltip=\"true\"></el-table-column>\r\n        <el-table-column prop=\"createTime\" label=\"创建时间\"></el-table-column>\r\n        <el-table-column prop=\"updateTime\" label=\"更新时间\"></el-table-column>\r\n      </el-table>\r\n      <pagination\r\n        v-show=\"total>0\"\r\n        :total=\"total\"\r\n        v-model:page=\"queryParams.pageNum\"\r\n        v-model:limit=\"queryParams.pageSize\"\r\n        @pagination=\"getList\"\r\n      />\r\n    </el-row>\r\n    <template #footer>\r\n      <div class=\"dialog-footer\">\r\n        <el-button type=\"primary\" @click=\"handleImportTable\">确 定</el-button>\r\n        <el-button @click=\"visible = false\">取 消</el-button>\r\n      </div>\r\n    </template>\r\n  </el-dialog>\r\n</template>\r\n\r\n<script setup>\r\nimport { listDbTable, importTable } from \"@/api/tool/gen\";\r\n\r\nconst total = ref(0);\r\nconst visible = ref(false);\r\nconst tables = ref([]);\r\nconst dbTableList = ref([]);\r\nconst { proxy } = getCurrentInstance();\r\n\r\nconst queryParams = reactive({\r\n  pageNum: 1,\r\n  pageSize: 10,\r\n  tableName: undefined,\r\n  tableComment: undefined\r\n});\r\n\r\nconst emit = defineEmits([\"ok\"]);\r\n\r\n/** 查询参数列表 */\r\nfunction show() {\r\n  getList();\r\n  visible.value = true;\r\n}\r\n/** 单击选择行 */\r\nfunction clickRow(row) {\r\n  proxy.$refs.table.toggleRowSelection(row);\r\n}\r\n/** 多选框选中数据 */\r\nfunction handleSelectionChange(selection) {\r\n  tables.value = selection.map(item => item.tableName);\r\n}\r\n/** 查询表数据 */\r\nfunction getList() {\r\n  listDbTable(queryParams).then(res => {\r\n    dbTableList.value = res.rows;\r\n    total.value = res.total;\r\n  });\r\n}\r\n/** 搜索按钮操作 */\r\nfunction handleQuery() {\r\n  queryParams.pageNum = 1;\r\n  getList();\r\n}\r\n/** 重置按钮操作 */\r\nfunction resetQuery() {\r\n  proxy.resetForm(\"queryRef\");\r\n  handleQuery();\r\n}\r\n/** 导入按钮操作 */\r\nfunction handleImportTable() {\r\n  const tableNames = tables.value.join(\",\");\r\n  if (tableNames == \"\") {\r\n    proxy.$modal.msgError(\"请选择要导入的表\");\r\n    return;\r\n  }\r\n  importTable({ tables: tableNames }).then(res => {\r\n    proxy.$modal.msgSuccess(res.msg);\r\n    if (res.code === 200) {\r\n      visible.value = false;\r\n      emit(\"ok\");\r\n    }\r\n  });\r\n}\r\n\r\ndefineExpose({\r\n  show,\r\n});\r\n</script>\r\n"],"names":["total","ref","visible","tables","dbTableList","proxy","getCurrentInstance","queryParams","reactive","emit","__emit","show","getList","clickRow","row","handleSelectionChange","selection","item","listDbTable","res","handleQuery","resetQuery","handleImportTable","tableNames","importTable","__expose"],"mappings":"uRAqDA,MAAMA,EAAQC,EAAI,CAAC,EACbC,EAAUD,EAAI,EAAK,EACnBE,EAASF,EAAI,CAAA,CAAE,EACfG,EAAcH,EAAI,CAAA,CAAE,EACpB,CAAE,MAAAI,CAAK,EAAKC,IAEZC,EAAcC,EAAS,CAC3B,QAAS,EACT,SAAU,GACV,UAAW,OACX,aAAc,MAChB,CAAC,EAEKC,EAAOC,EAGb,SAASC,GAAO,CACdC,IACAV,EAAQ,MAAQ,EAClB,CAEA,SAASW,EAASC,EAAK,CACrBT,EAAM,MAAM,MAAM,mBAAmBS,CAAG,CAC1C,CAEA,SAASC,EAAsBC,EAAW,CACxCb,EAAO,MAAQa,EAAU,IAAIC,GAAQA,EAAK,SAAS,CACrD,CAEA,SAASL,GAAU,CACjBM,EAAYX,CAAW,EAAE,KAAKY,GAAO,CACnCf,EAAY,MAAQe,EAAI,KACxBnB,EAAM,MAAQmB,EAAI,KACtB,CAAG,CACH,CAEA,SAASC,GAAc,CACrBb,EAAY,QAAU,EACtBK,GACF,CAEA,SAASS,GAAa,CACpBhB,EAAM,UAAU,UAAU,EAC1Be,GACF,CAEA,SAASE,GAAoB,CAC3B,MAAMC,EAAapB,EAAO,MAAM,KAAK,GAAG,EACxC,GAAIoB,GAAc,GAAI,CACpBlB,EAAM,OAAO,SAAS,UAAU,EAChC,MACD,CACDmB,EAAY,CAAE,OAAQD,CAAY,CAAA,EAAE,KAAKJ,GAAO,CAC9Cd,EAAM,OAAO,WAAWc,EAAI,GAAG,EAC3BA,EAAI,OAAS,MACfjB,EAAQ,MAAQ,GAChBO,EAAK,IAAI,EAEf,CAAG,CACH,CAEA,OAAAgB,EAAa,CACX,KAAAd,CACF,CAAC"}